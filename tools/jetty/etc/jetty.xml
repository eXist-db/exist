<?xml version="1.0"?>
<!-- $Id$ -->
<!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" "http://jetty.mortbay.org/configure.dtd">
<Configure id="Server" class="org.mortbay.jetty.Server">

  <!-- Setup connector -->
  <New id="connector" class="org.mortbay.jetty.nio.SelectChannelConnector">
    <Set name="port">
      <SystemProperty name="jetty.port" default="8080"/>
    </Set>
  </New>

  <!-- Uncomment the following connector to enable SSL. You need to create
       a certificate. Check http://atomic.exist-db.org/HowTo/JettySSL
    -->
  <!--New id="ssl-connector" class="org.mortbay.jetty.security.SslSocketConnector">
    <Set name="Port">8443</Set>
    <Set name="maxIdleTime">30000</Set>
    <Set name="keystore"><SystemProperty name="jetty.home" default="." />/etc/demokeystore</Set>
    <Set name="password">secret</Set>
    <Set name="keyPassword">secret</Set>
    <Set name="truststore"><SystemProperty name="jetty.home" default="." />/etc/demokeystore</Set>
    <Set name="trustPassword">secret</Set>
  </New-->

  <!-- Setup connectors  -->
  <Set name="Connectors">
    <Array type="org.mortbay.jetty.Connector">
      <Item>
        <Ref id="connector"/>
      </Item>
      <!-- Uncomment to enable SSL -->
      <!--Item>
	<Ref id="ssl-connector"/>
      </Item-->
    </Array>
  </Set>

  <!-- Setup webapplication -->
  <New id="webapp" class="org.exist.http.WebAppContext">
    <!-- can either be '/exist' or '/' -->
    <Set name="contextPath">/exist</Set>
    <Set name="war"><SystemProperty name="jetty.home" default="."/>/../../webapp/</Set>
    <Set name="defaultsDescriptor"><SystemProperty name="jetty.home" default="."
      />/etc/webdefault.xml</Set>
  </New>

  <!-- Setup Handlers -->
  <Set name="handler">
    <New id="Handlers" class="org.mortbay.jetty.handler.HandlerCollection">
      <Set name="handlers">
        <Array type="org.mortbay.jetty.Handler">
          <Item>
            <!-- Reference to exist-db -->
            <Ref id="webapp"/>
          </Item>
          <Item>
            <!-- If not handler by existdb then do something -->
            <New id="DefaultHandler" class="org.mortbay.jetty.handler.DefaultHandler"/>
          </Item>
          <Item>
            <New id="RequestLog" class="org.mortbay.jetty.handler.RequestLogHandler"/>
          </Item>
        </Array>
      </Set>
    </New>
  </Set>

</Configure>
