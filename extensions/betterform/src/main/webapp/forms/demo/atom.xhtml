<?xml version="1.0" encoding="UTF-8"?>
<!--
    author: Fabian Otto <fabian.otto<AT>betterform.de>
    author: Tobi Krebs <tobias.krebs<AT>betterform.de>
    date:   2010-02-18
-->

<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:xf="http://www.w3.org/2002/xforms"
	  xmlns:ev="http://www.w3.org/2001/xml-events"
	  xmlns:xs="http://www.w3.org/2001/XMLSchema"
	  xmlns:atom="http://www.w3.org/2005/Atom"
	  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<head>
	<title>Feed Atom Reader</title>

	<link rel="stylesheet" type="text/css" href="../../styles/bf.css"/>
	<link rel="stylesheet" type="text/css" href="../../resources/styles/demo.css"/>
</head>

<body class="soria" style="margin:30px;">
	<div id="xforms">
		<div style="display:none">
			<xf:model id="m-atom">
				<xf:instance id="i-controller">
					<data xmlns="">
						<feedURL>http://rss.golem.de/rss.php?feed=ATOM1.0</feedURL>
					</data>
				</xf:instance>

				<xf:instance id="i-atom-entries">
					<feed xmlns=""/>
				</xf:instance>

				<xf:submission id="s-get-data"
							   ref="instance('i-controller')"
							   replace="instance"
							   validate="false"
							   method="get"
							   mediatype="application/atom+xml"
							   instance="i-atom-entries">
					<xf:resource value="instance('i-controller')/feedURL"/>
					<xf:message ev:event="xforms-submit-done" level="ephemeral">feed update successful</xf:message>
					<xf:message ev:event="xforms-submit-error" level="modal">feed update failed</xf:message>
				</xf:submission>

				<xf:action ev:event="xforms-ready">
					<xf:send submission="s-get-data"/>
				</xf:action>
			</xf:model>
		</div>
		<xf:group id="repeatOuter" appearance="full">
			<div class="Section">
				<div class="Headline">Atom Feed Reader</div>

                <div class="description">
				    Simple Display for ATOM Resources.<br/>
				    Shows Meta Data and lists all entries of an ATOM Resource.
                </div>                    
			</div>

			<div class="Section">
				<div class="Sample">
					<xf:select1 appearance="minimal" ref="feedURL">
						<xf:label>FeedURL:</xf:label>
						<xf:choices>
							<xf:item selected="True">
								<xf:label>Golem</xf:label>
								<xf:value>http://rss.golem.de/rss.php?feed=ATOM1.0</xf:value>
							</xf:item>
							<xf:item selected="False">
								<xf:label>heise Online</xf:label>
								<xf:value>http://www.heise.de/newsticker/heise-atom.xml</xf:value>
							</xf:item>
							<xf:item selected="False">
								<xf:label>heise Security</xf:label>
								<xf:value>http://www.heise.de/security/news/news-atom.xml</xf:value>
							</xf:item>
							<xf:item selected="False">
								<xf:label>heise mobil</xf:label>
								<xf:value>http://www.heise.de/mobil/newsticker/heise-atom.xml</xf:value>
							</xf:item>
							<xf:item selected="False">
								<xf:label>heise Open</xf:label>
								<xf:value>http://www.heise.de/open/news/news-atom.xml</xf:value>
							</xf:item>
							<xf:item selected="False">
								<xf:label>iX</xf:label>
								<xf:value>http://www.heise.de/ix/news/news-atom.xml</xf:value>
							</xf:item>
						</xf:choices>
						<xf:action ev:event="xforms-value-changed">
							<xf:send submission="s-get-data"/>
						</xf:action>
					</xf:select1>


					<xf:trigger class="atomReload">
						<xf:label></xf:label>
						<xf:hint>Click to reload this feed</xf:hint>
						<xf:action>
							<xf:send submission="s-get-data"/>
						</xf:action>
					</xf:trigger>
					<br/>

					<xf:group appearance="full" class="atomData">
						<xf:label></xf:label>
						<xf:output ref="instance('i-atom-entries')/atom:title" class="atomSubtitle">
							<xf:label>Feed:</xf:label>
						</xf:output>
						<br/>
						<xf:output ref="instance('i-atom-entries')/atom:subtitle" class="atomSubtitle">
							<xf:label>Subtitle:</xf:label>
						</xf:output>
						<br/>
						<xf:output ref="instance('i-atom-entries')/atom:updated" class="atomSubtitle">
							<xf:label>Last update:</xf:label>
						</xf:output>
					</xf:group>
					<!--Repeats the data-->
					<xf:group id="whatever">
						<xf:repeat nodeset="instance('i-atom-entries')/atom:entry" appearance="full">
							<xf:group appearance="full">
								<xf:output ref="atom:title" class="atomSubtitle">
									<xf:label/>
								</xf:output>
								<xf:group appearance="bf:horizontalTable">
									<xf:label/>
									<xf:output value="substring(atom:updated,1,10)" class="atomPadding">
										<xf:label/>
									</xf:output>
									<xf:output value="substring(atom:updated,12,8)" class="atomPadding">
										<xf:label/>
									</xf:output>
								</xf:group>
								<xf:output class="atomPadding" ref="atom:summary" mediatype="text/html">
									<xf:label/>
								</xf:output>
								<xf:trigger class="atomArticleLink" appearance="minimal">
									<xf:label>full article</xf:label>
									<xf:load show="new">
										<xf:resource value="atom:link/@href"/>
									</xf:load>
								</xf:trigger>
							</xf:group>
						</xf:repeat>
					</xf:group>
				</div>
			</div>
		</xf:group>
	</div>
</body>
</html>
