/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["betterform.ui.UIElementFactory"]){dojo._hasResource["betterform.ui.UIElementFactory"]=true;dojo.provide("betterform.ui.UIElementFactory");dojo.declare("betterform.ui.UIElementFactory",null,{createWidget:function $DA6A_(_1,_2){var _3=dojo.attr(_1,"controlType");var _4=dojo.attr(_1,"dataType");_4=betterform.ui.util.removeNamespace(_4);var _5="xfValue";if(dojo.attr(_1,"class")){var _6=dojo.attr(_1,"class");if(_6.indexOf("xfValue")==-1){_5=_5+" "+_6;}else{_5=_6;}}var _7=null;if(_3==undefined){console.warn("UIElementFactory.createWidget: undefined controlType, Node: ",_1);return _1;}var _8=dojo.attr(_1,"mediatype");switch(_3){case "input":var _9=_4;var _a=dojo.attr(_1,"appearance");if(_a!=undefined&&_a.indexOf("ca")!=-1){_9=_a;}switch(_9.toLowerCase()){case "casimiletimeline":dojo.require("betterform.ui.timeline.TimeLine");_7=new betterform.ui.timeline.TimeLine({name:_2+"-value",checked:_b,"class":_5,xfControlId:_2},_1);_7.startup();break;case "caopmltree":dojo.require("betterform.ui.tree.OPMLTree");_7=new betterform.ui.tree.OPMLTree({name:_2+"-value","class":_5,xfControlId:_2},_1);_7.startup();break;case "date":var _b=dojo.attr(_1,"schemaValue");if(_b!=undefined&&_b!=""){_b=dojo.date.stamp.fromISOString(_b);}else{_b="";}var _c;if(_a.indexOf("iso8601:")!=-1){_c=_a.substring(_a.indexOf("iso8601:")+8);if(_c.indexOf(" ")!=-1){_c=_c.substring(0,_c.indexOf(" ")).trim();}}dojo.require("betterform.ui.input.Date");if(_c!=undefined){try{_7=new betterform.ui.input.Date({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),constraints:{selector:"date",datePattern:_c},xfControlId:_2},_1);}catch(ex){alert(ex);}}else{_7=new betterform.ui.input.Date({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),constraints:{selector:"date"},xfControlId:_2},_1);}break;case "datetime":var _b=dojo.attr(_1,"schemaValue");var _d=false;if(_b!=undefined&&_b.indexOf(".")==19){_b=_b.substring(0,19);_d=true;}if(_b==undefined){_b="";}var _c;if(_a.indexOf("iso8601:")!=-1){_c=_a.substring(_a.indexOf("iso8601:")+8);if(_c.indexOf(" ")!=-1){_c=_c.substring(0,_c.indexOf(" ")).trim();}}dojo.require("betterform.ui.input.DateTime");if(_c!=undefined){try{_7=new betterform.ui.input.DateTime({name:_2+"-value",value:_b,miliseconds:_d,constraints:{datePattern:_c,timePattern:"HH:mm:ss"},title:dojo.attr(_1,"title"),xfControlId:_2},_1);}catch(ex){alert(ex);}}else{_7=new betterform.ui.input.DateTime({name:_2+"-value",value:_b,miliseconds:_d,constraints:{datePattern:"dd.MM.yyyy",timePattern:"HH:mm:ss"},title:dojo.attr(_1,"title"),xfControlId:_2},_1);}break;case "boolean":var _b=_1.innerHTML;if(_b=="false"){_b=undefined;}dojo.require("betterform.ui.input.Boolean");_7=new betterform.ui.input.Boolean({name:_2+"-value",checked:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;default:var _b=_1.innerHTML;dojo.require("betterform.ui.input.TextField");_7=new betterform.ui.input.TextField({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;}break;case "output":var _b=_1.innerHTML;var _e=_4;var _a=dojo.attr(_1,"appearance");if(_a!=undefined&&_a.indexOf("ca")!=-1){if(_a=="caLink"){_e="anyURI";}else{if(_a=="caSourceCode"){_e="sourcecode";}else{_e=_a;}}}switch(_e.toLowerCase()){case "anyuri":if(_8==undefined||_8=="controlValue"||_8=="text"){dojo.require("betterform.ui.output.Link");_7=new betterform.ui.output.Link({name:_2+"-value",href:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{if(_8.indexOf("image/")>-1){dojo.require("betterform.ui.output.Image");_7=new betterform.ui.output.Image({name:_2+"-value",src:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{if(_8=="text/html"){dojo.require("betterform.ui.output.Html");_7=new betterform.ui.output.Html({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{console.warn("UIElementFactory.createWidget(): output anyURI - unknown combination of attributes");}}}break;case "sourcecode":dojo.require("betterform.ui.output.SourceCode");_7=new betterform.ui.output.SourceCode({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;default:if(_8==undefined||_8=="controlValue"||_8=="text"){dojo.require("betterform.ui.output.Plain");_7=new betterform.ui.output.Plain({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{if(_8=="text/html"){dojo.require("betterform.ui.output.Html");_7=new betterform.ui.output.Html({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{if(_8.indexOf("image/")>-1){dojo.require("betterform.ui.output.Image");_7=new betterform.ui.output.Image({name:_2+"-value",src:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{console.warn("UIElementFactory.createWidget(): unknown mediatype '"+_8+"' for output, rendering default output");dojo.require("betterform.ui.output.Plain");_7=new betterform.ui.output.Plain({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}}}break;}break;case "range":var _b=dojo.attr(_1,"value");var _f=0;var end=10;var _11=1;if(dojo.attr(_1,"start")!=""){_f=eval(dojo.attr(_1,"start"));}if(dojo.attr(_1,"end")!=""){end=eval(dojo.attr(_1,"end"));}else{if(dojo.attr(_1,"end")==""&&dojo.attr(_1,"start")!=""){end=eval(dojo.attr(_1,"start"))+end;}}if(dojo.attr(_1,"step")!=""){_11=eval(dojo.attr(_1,"step"));}if(_b>end){_b=end;}if(_b<_f){_b=_f;}if(dojo.attr(_1,"appearance")=="bf:rating"){dojo.require("betterform.ui.range.Rating");_7=new betterform.ui.range.Rating({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2,numStars:end},_1);}else{var _12=((end-_f)/_11)+1;var _13=document.createElement("div");dojo.require("betterform.ui.range.Slider");_1.appendChild(_13);var _14=new dijit.form.HorizontalRule({count:_12,container:"topDecoration",style:"height:4px;"},_13);var _15=document.createElement("div");_1.appendChild(_15);var _16=new dijit.form.HorizontalRuleLabels({count:5,style:"height:1.2em;font-size:75%;color:gray;",labels:[_f,end]},_15);_7=new betterform.ui.range.Slider({value:_b,name:_2+"-value",slideDuration:0,minimum:_f,maximum:end,discreteValues:_12,intermediateChanges:"true",showButtons:"true","class":_5,xfControlId:_2,style:"width:200px;"},_1);_7.startup();_14.startup();}break;case "secret":var _b=_1.innerHTML;dojo.require("betterform.ui.secret.Secret");_7=new betterform.ui.secret.Secret({name:_2+"-value",value:_b,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;case "selectCheckBox":dojo.require("betterform.ui.select.CheckBoxGroup");_7=new betterform.ui.select.CheckBoxGroup({name:_2+"-value","class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;case "selectList":dojo.require("betterform.ui.select.MultiSelect");_7=new betterform.ui.select.MultiSelect({name:_2+"-value",size:dojo.attr(_1,"size"),multiple:true,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;case "select1":case "select1ComboBox":dojo.require("betterform.ui.select1.ComboBox");_7=new betterform.ui.select1.ComboBox({name:_2+"-value",value:"","class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;case "select1ComboBoxOpen":dojo.require("betterform.ui.select1.ComboBoxOpen");_7=new betterform.ui.select1.ComboBoxOpen({name:_2+"-value",size:dojo.attr(_1,"size"),multiple:true,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;case "select1List":dojo.require("betterform.ui.select1.Plain");_7=new betterform.ui.select1.Plain({name:_2+"-value",size:dojo.attr(_1,"size"),"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;case "select1RadioButton":dojo.require("betterform.ui.select1.RadioGroup");_7=new betterform.ui.select1.RadioGroup({name:_2+"-value","class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;case "textarea":if(dojo.attr(_1,"appearance")=="minimal"&&_8!="text/html"&&_8!="dojo"){dojo.require("betterform.ui.textarea.MinimalTextarea");_7=new betterform.ui.textarea.MinimalTextarea({name:_2+"-value",rows:5,cols:40,"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{if(_8=="text/html"){dojo.require("betterform.ui.textarea.HtmlEditor");_7=new betterform.ui.textarea.HtmlEditor({name:_2+"-value","class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{if(_8=="dojo"){dojo.require("betterform.ui.textarea.DojoEditor");_7=new betterform.ui.textarea.DojoEditor({name:_2+"-value","class":_5,rows:5,cols:30,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{dojo.require("betterform.ui.textarea.SimpleTextarea");_7=new betterform.ui.textarea.SimpleTextarea({name:_2+"-value","class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}}}break;case "minimalTrigger":case "trigger":if(dojo.attr(_1,"appearance")=="minimal"){dojo.require("betterform.ui.trigger.LinkButton");_7=new betterform.ui.trigger.LinkButton({id:dojo.attr(_1,"id"),name:dojo.attr(_1,"name")+"-value",label:dojo.attr(_1,"label"),"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{if(dojo.attr(_1,"appearance")=="imageTrigger"){dojo.require("betterform.ui.trigger.ImageButton");_7=new betterform.ui.trigger.ImageButton({id:dojo.attr(_1,"id"),name:dojo.attr(_1,"name")+"-value",label:dojo.attr(_1,"label"),title:dojo.attr(_1,"title"),xfControlId:_2},_1);}else{dojo.require("betterform.ui.trigger.Button");dojo.require("dijit.form.Button");_7=new betterform.ui.trigger.Button({id:dojo.attr(_1,"id"),name:dojo.attr(_1,"name")+"-value",label:dojo.attr(_1,"label"),title:dojo.attr(_1,"title"),xfControlId:_2},_1);}}break;case "submit":console.warn("TBD create Submit control: ",_1);break;case "upload":switch(_4){case "base64":case "base64Binary":case "hexBinary":case "anyURI":dojo.require("betterform.ui.upload.UploadPlain");_7=new betterform.ui.upload.UploadPlain({"class":_5,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;default:console.error("Upload ("+_2+"): unsupported datatype: ",_4);}break;case "radio":var _17=_1.name;var _18=_1.value;dojo.require("betterform.ui.select1.RadioButton");_7=new betterform.ui.select1.RadioButton({"class":_5,name:_17,value:_18,title:dojo.attr(_1,"title"),xfControlId:_2},_1);break;default:console.warn("UIElementFactory: Unknown controlValue: '"+_3+"' for Control "+_2+"! Properties: ",_1);break;}if(_7!=undefined){return _7;}}});}