<?xml version="1.0" encoding="UTF-8"?>

<!-- ======================================================================= -->
<!-- eXist build file : Setup default xar packages                           -->
<!-- ======================================================================= -->

<!-- $Id$ -->

<project basedir="../.." name="Setup" default="setup">

  <description>Package setup tasks</description>
  
  <!-- Additional task defs  -->
  <taskdef resource="net/sf/antcontrib/antcontrib.properties">
    <classpath>
      <pathelement location="tools/ant/lib/ant-contrib-1.0b3.jar"/>
    </classpath>
  </taskdef>
  
  <taskdef name="fetch" classname="nl.ow.dilemma.ant.fetch.FetchTask"/>
  
  <property file="build.properties"/>
  
  <property name="public-repo" value="http://demo.exist-db.org/exist/apps/public-repo/public/"/>
  <property name="autostart-dir" value="autodeploy"/>
  
  <!--  Automatically download standard xar packages from public repository
        if autostart directory is empty.
  -->
  <path id="autostart-files">
    <fileset dir="${autostart-dir}">
      <include name="*.xar"/>
    </fileset>
  </path>
  
  <property name="autostart-files" refid="autostart-files"/>
  
  <condition property="autostart-empty"> 
    <equals arg1="" arg2="${autostart-files}"/> 
  </condition>
  
  <!-- 
    Download jar files the author website. This is newest version of the library, 
    if the URL is updated in time. The download size is significantly larger.
  -->
  <target name="setup" description="Download standard xar packages." if="autostart-empty">

    <foreach list="${autodeploy}" target="download-xar" param="xar"></foreach>
  </target>
  
  <target name="download-xar">
    <fetch dest="${autostart-dir}" url="${public-repo}/${xar}"/>
  </target>
</project>
