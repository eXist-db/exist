<?xml version="1.0" encoding="UTF-8"?>
<!-- 
    Ant build file for repository packages.
-->
<project basedir="." default="xar" name="expathrepo">
    
    <property name="top.dir" value="../.."/>
    <property name="classes" value="${top.dir}/extensions/modules/classes"/>
    
    <target name="xar" depends="xar-math,xar-functx,xar-json,xar-myapp,xar-admin,xar-mobiledocs,xar-library"/>
    
    <target name="xar-math">
        <echo message="Creating math.xar example for package manager ..."/>
        <jar basedir="${classes}" jarfile="packages/math-example/math/math.jar"
            includes="org/exist/xquery/modules/math/**">
            <manifest>
                <attribute name="Project-Name" value="${project.name}"/>
                <attribute name="Project-Version" value="${project.version}"/>
                <attribute name="Class-Path" value="exist.jar xmldb.jar"/>
            </manifest>
        </jar>
        <zip destfile="packages/math-1.0.xar"
            basedir="packages/math-example"/>
    </target>
    
    <target name="xar-functx">
        <echo message="Creating functx-1.0.xar example for package manager ..."/>
        <zip destfile="packages/functx-1.0.xar"
            basedir="packages/functx-example"/>
    </target>
    
    <target name="xar-json">
        <echo message="Creating xquery-json-0.1.xar example for package manager ..."/>
        <zip destfile="packages/xquery-json-0.1.xar"
            basedir="packages/json-example"/>
    </target>
    
    <target name="xar-myapp">
        <echo message="Creating myapp-0.1.xar example for package manager ..."/>
        <zip destfile="packages/myapp-0.1.xar"
            basedir="packages/app-example"/>
    </target>
    
    <target name="xar-admin">
        <echo message="Creating admin-1.0.xar example for package manager ..."/>
        <zip basedir="../admin" destfile="packages/admin-1.0.xar" 
            excludes=".svn"/>
    </target>
    
    <target name="xar-mobiledocs">
        <echo message="Creating mobiledocs-0.1.xar example for package manager ..."/>
        <zip destfile="packages/mobiledocs-0.1.xar"
            basedir="packages/mobile-function-doc"/>
    </target>
    
    <target name="xar-library">
        <ant antfile="build.xml" dir="packages/library" inheritall="false"/>
    </target>
    
    <target name="clean">
        <delete dir="packages" includes="*.xar"/>
    </target>
</project>
