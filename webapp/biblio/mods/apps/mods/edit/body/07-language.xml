<?xml version="1.0" encoding="UTF-8"?>
<div xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xf="http://www.w3.org/2002/xforms" class="language">
    <!--language begins-->
    
    <!--
        DLF/Aquifer: 
        Required, if language is primary to resource.
        Required: at least one pair of languageTerm elements representing the primary language of the text wrapped in a single language element. 
        One of these languageTerm elements should carry the attribute type="text" and the other should have type="code".
    -->
    <!--Cluster:
        Allow coded input in iso639-2b code only. iso639-2b is the code used for @lang. language-3-type-code
    -->
    <!--Note:
        This element can be repeated because of @objectPart.
        DLF/Aquifer holds @objectPart to be an attribute on languageTerm, Guidelines on language.
    -->
    <fieldset>
        <legend>Language of Resource</legend>
        <xf:hint>
            A designation of the language in which the content of the described resource is expressed.<br/>
            Language may also be expressed in conjunction with each element by means of the lang attribute to designate the language used.<br/>
            Language Of Cataloging under Record Info is used to give the language of the metadata in the record as a whole. 
            This is not the language of the resource, but of the metadata describing it.<br/>
            At least one Language element is required for all resources in which language is primary to understanding the resource. 
            These resources include textual resources, as well as audio and video resources with spoken word components.<br/>
            Although Language is usually not required for non-textual resources such as images, it could be used effectively for such resources when language is a primary component. 
            Examples of the latter might include a photograph of a sign with text or a monument with an inscription.<br/>
            The Language element is optional for resources in which language is important to understanding the resource, but not primary. 
            For example, the caption of a photograph may in some instances be important to understanding the photograph, but not primary.
            If the content of the resource is in more than one language, Language is repeated for each language.        
        </xf:hint>
        
        <!--language repeat begins-->
        <xf:repeat nodeset="mods:language" id="language-repeat">
            
            <!--language input begins-->
            <xf:input ref="./@objectPart" class="text_50">
                <xf:label>Object Part: </xf:label>
                <xf:hint>
                    This attribute designates which part of the resource is in the language stated in Language Term. 
                    The values of the attribute are not controlled; values of Object Part may e.g. be "summary" and "caption".
                </xf:hint>
            </xf:input>
            
            <!--language input ends-->
            
            <!--languageTerm begins-->
            <fieldset>
                
                <!--languageTerm repeat begins-->
                <xf:repeat nodeset="./mods:languageTerm" id="language-term-repeat">
                    
                    <!--languageTerm input begins-->
                    <xf:select1 ref="./@type">
                        <xf:label>Type:</xf:label>
                        <xf:hint>
                            This attribute is used to express whether the Language Term value is in textual or coded form.
                        </xf:hint>
                        <xf:itemset nodeset="instance('code-tables')/code-table[code-table-name='code-text-code']/items/item">
                            <xf:label ref="label"/>
                            <xf:value ref="value"/>
                        </xf:itemset>
                    </xf:select1>
                    <xf:select1 ref=".[@type='code']/@authority">
                        <xf:label>Authority:</xf:label>
                        <xf:hint>Hint</xf:hint>
                        <xf:itemset nodeset="instance('code-tables')/code-table[code-table-name='language-authority-code']/items/item">
                            <xf:label ref="label"/>
                            <xf:value ref="value"/>
                        </xf:itemset>
                    </xf:select1>
                    <br/>
                    <xf:select1 ref=".[@type='code']">
                        <xf:label>Language Term (code):</xf:label>
                        <xf:hint>
                            Language Term specifies the language(s) of the content of the resource. 
                            It may be expressed in textual or coded form. 
                            If in coded form, the source of the code should be indicated in the value of the authority attribute. 
                            If no authority is given, it is assumed that the content is textual, i.e. that the Type is "text".  
                            If there is more than one representation of the same language, e.g. using different forms of the same language (code or text) or from different authorities, Language Term is repeated within the Language container. 
                        </xf:hint>
                        <xf:itemset nodeset="instance('code-tables')/code-table[code-table-name='language-3-type-code']/items/item">
                            <xf:label ref="label"/>
                            <xf:value ref="value"/>
                        </xf:itemset>
                    </xf:select1>
                    
                    <!--NB: how should different type values be handled?-->
                    <xf:input ref=".[not(@type='code')]" selection="open" class="text_50">
                        <xf:label>Language Term (text):</xf:label>
                        <xf:hint>
                            Language Term specifies the language(s) of the content of the resource. 
                            It may be expressed in textual or coded form. 
                            If in coded form, the source of the code should be indicated in the value of the authority attribute. 
                            If no authority is given, it is assumed that the content is textual, i.e. that the Type is "text".  
                            If there is more than one representation of the same language, e.g. using different forms of the same language (code or text) or from different authorities, Language Term is repeated within the Language container.
                        </xf:hint>
                    </xf:input>
                    <br/>
                    
                    <!--languageTerm input ends-->
                    
                    <!--languageTerm delete begins-->
                    <xf:trigger ref="self::node()[count(../mods:languageTerm) &gt; 1]">
                        <xf:label>Delete This Language Term</xf:label>
                        <xf:hint>Hint</xf:hint>
                        <xf:delete ev:event="DOMActivate" nodeset="instance('save-data')/mods:language/mods:languageTerm" at="index('language-term-repeat')"/>
                    </xf:trigger>
                    
                    <!--languageTerm delete ends-->
                    <div class="hr"/>
                </xf:repeat>
                
                <!--languageTerm repeat ends-->
                
                
                <!--languageTerm add begins-->
                <xf:trigger class="add">
                    <xf:label>Add Language Term</xf:label>
                    <xf:hint>Hint</xf:hint>
                    <xf:action ev:event="DOMActivate">
                        <xf:insert nodeset="mods:languageTerm" at="index('language-term-repeat')" position="after" origin="instance('insert-templates')/mods:language/mods:languageTerm"/>
                        <xf:setvalue ref="instance('save-data')/mods:languageTerm[last()]" value="''"/>
                    </xf:action>
                </xf:trigger>
                
                <!--languageTerm add ends-->
            </fieldset>
            
            <!--languageTerm ends-->
            <div class="hr"/>
            
            <!--language delete begins-->
            <xf:trigger ref="self::node()[count(../mods:language) &gt; 1]">
                <xf:label>Delete This Language of Resource</xf:label>
                <xf:hint>Hint</xf:hint>
                <xf:delete ev:event="DOMActivate" nodeset="instance('save-data')/mods:language" at="index('language-repeat')"/>
            </xf:trigger>
            
            <!--language delete ends-->
            <div class="hr"/>
        </xf:repeat>
        
        <!--language repeat ends-->
        
        <!--language add begins-->
        <xf:trigger class="add">
            <xf:label>Add Language of Resource</xf:label>
            <xf:hint>Hint</xf:hint>
            <xf:action ev:event="DOMActivate">
                <xf:insert nodeset="mods:language" at="index('language-repeat')" position="after" origin="instance('insert-templates')/mods:language"/>
                <xf:setvalue ref="instance('save-data')/mods:language[last()]" value="''"/>
            </xf:action>
        </xf:trigger>
        
        <!--language add ends-->
    </fieldset>
    
    <!--language ends-->
</div>