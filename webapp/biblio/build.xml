<project xmlns:xdb="http://exist-db.org/ant" default="load-mods" name="MODS Database Loader">

	<property file="local.properties"/>

	<property name="server.dir" value="../.."/>
	<property name="mods.dir" value="mods"/>
			
	<path id="classpath.core">
		<fileset dir="${server.dir}/lib/core">
			<include name="*.jar" />
		</fileset>
		<pathelement path="${server.dir}/exist.jar" />
		<pathelement path="${server.dir}/exist-optional.jar" />
	</path>

	<typedef resource="org/exist/ant/antlib.xml" uri="http://exist-db.org/ant">
		<classpath refid="classpath.core" />
	</typedef>

	<target name="load-mods" xmlns:xdb="http://exist-db.org/ant">
		<echo message="Removing old MODS application from eXist database"/>
		<xdb:remove user="${public.xmldb.username}" password="${public.xmldb.password}"
            uri="${server-uri}" collection="${mods-collection}"
            failonerror="false"/>
            	
		<echo message="Loading new MODS database into eXist database"/>
		<xdb:store user="${public.xmldb.username}" password="${public.xmldb.password}"
            uri="${server-uri}/${mods-collection}" 
            createcollection="true" createsubcollections="true" failonerror="false">
			<fileset dir="${mods.dir}" id="id">
				<include name="**/*.xq" />
				<include name="**/*.xsl" />
        <include name="**/*.xqm" />
        <include name="**/*.css" />
        <include name="**/*.js" />
        <include name="**/*.png" />
        <include name="**/*.gif" />
        <include name="**/*.properties" />
			</fileset>
		</xdb:store>

    <xdb:store user="${public.xmldb.username}" password="${public.xmldb.password}"
      uri="${server-uri}/xforms"
      createcollection="true" createsubcollections="true" failonerror="false">
      <fileset dir="${xslt-forms}"/>
    </xdb:store>
	</target>

</project>