<?xml version="1.0" encoding="iso-8859-1"?>
<?xml-stylesheet href="xsltforms/xsltforms.xsl" type="text/xsl"?>
<html xmlns="http://www.w3.org/1999/xhtml"
			xmlns:sample="http://www.agencexml.com/sample"
      xmlns:xf="http://www.w3.org/2002/xforms"
      xmlns:ev="http://www.w3.org/2001/xml-events">
    <head>
        <title>Calculator</title>
    	<meta name="description" content="XForms calculator."/>
    	<meta name="keywords" content="AJAX, Javascript, Web, XForms, XSLTForms, Exemples, Samples, Calculator"/>
        <style type="text/css">
             div.xforms-field div.xforms-control {
                 margin-left	     : 3em;
             }
        </style>
        <xf:model>
            <xf:instance>
                <sample:equation>
                    <sample:screen>0</sample:screen>
                    <sample:screenbuffer>0</sample:screenbuffer>
                    <sample:first>0</sample:first>
                    <sample:second>0</sample:second>
                    <sample:memory>0</sample:memory>
                    <sample:result>0</sample:result>
                </sample:equation>
            </xf:instance>
        </xf:model>
    </head>
    <body>
        <h3>Calculator</h3>
        <div id="xformControl">
            <span>
                <input type="checkbox" onclick="$('console').style.display = this.checked? 'block' : 'none';" checked="checked"/> Debug
            </span>
        </div>
        <table border="1">
            <tr>
                <td align="right" colspan="6"><xf:output ref="/sample:equation/sample:screen"/></td>
            </tr>
            <tr>
                <td>
                    <xf:output ref="/sample:equation/sample:memory"><xf:label>M:</xf:label></xf:output>
                </td>
                <td colspan="3"></td>
                <td colspan="2">
                    <xf:trigger>
                        <xf:label>Clear</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:first">0</xf:setvalue>
                            <xf:setvalue ref="/sample:equation/sample:second">0</xf:setvalue>
                            <xf:setvalue ref="/sample:equation/sample:result">0</xf:setvalue>
                            <xf:setvalue ref="/sample:equation/sample:screen">0</xf:setvalue>
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer">0</xf:setvalue>
                	        <xf:toggle case="add"/>
                        </xf:action>
                    </xf:trigger>
                </td>
            </tr>
            <tr>
                <td>
                    <xf:trigger>
                        <xf:label>MC</xf:label>
                        <xf:setvalue ref="/sample:equation/sample:memory" value="0" ev:event="DOMActivate"/>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>7</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10 + 7"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>8</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10 + 8"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>9</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10 + 9"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>/</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:first" value="/sample:equation/sample:screen"/>
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                            <xf:toggle case="divide"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td></td>
            </tr>
            <tr>
                <td>
                    <xf:trigger>
                        <xf:label>MR</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:memory"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:memory"/>
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>4</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10 + 4"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>5</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10 + 5"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
                </td>
            	<td>
                    <xf:trigger>
                        <xf:label>6</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10 + 6"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
                </td>
            	<td>
                    <xf:trigger>
                        <xf:label>*</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:first" value="/sample:equation/sample:screen"/>
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                            <xf:toggle case="multiply"/>
                        </xf:action>
                    </xf:trigger>
                </td>
            </tr>
            <tr>
                <td>
                    <xf:trigger>
                        <xf:label>MS</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:memory" value="/sample:equation/sample:screen"/>
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>1</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10 + 1"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>2</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10 + 2"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
               </td>
               <td>
                    <xf:trigger>
                        <xf:label>3</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10 + 3"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>-</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:first" value="/sample:equation/sample:screen"/>
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                	        <xf:toggle case="subtract"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>1/x</xf:label>
                        <xf:setvalue ref="/sample:equation/sample:screen" value="1 div /sample:equation/sample:screen" ev:event="DOMActivate"/>
                    </xf:trigger>
                </td>
            </tr>
            <tr>
                <td>
                    <xf:trigger>
                        <xf:label>M+</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:memory" value="/sample:equation/sample:memory + /sample:equation/sample:screen"/>
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>0</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="/sample:equation/sample:screenbuffer * 10"/>
                            <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screenbuffer"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td colspan="2">
                    <xf:trigger>
                        <xf:label>+/-</xf:label>
                        <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:screen * -1" ev:event="DOMActivate"/>
                    </xf:trigger>
                </td>
                <td>
                    <xf:trigger>
                        <xf:label>+</xf:label>
                        <xf:action ev:event="DOMActivate">
                            <xf:setvalue ref="/sample:equation/sample:first" value="/sample:equation/sample:screen"/>
                            <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                            <xf:toggle case="add"/>
                        </xf:action>
                    </xf:trigger>
                </td>
                <td>
                    <xf:switch>
                        <xf:case id="add" selected="true">
                            <xf:trigger>
                                <xf:label>=</xf:label>
                                <xf:action ev:event="DOMActivate">
                                    <xf:setvalue ref="/sample:equation/sample:second" value="/sample:equation/sample:screen"/>
                                    <xf:setvalue ref="/sample:equation/sample:result" value="/sample:equation/sample:first + /sample:equation/sample:second"/>
                                    <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:result"/>
                                    <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                                </xf:action>
                            </xf:trigger>
                    	</xf:case>
                        <xf:case id="subtract" selected="false">
                            <xf:trigger>
                                <xf:label>=</xf:label>
                                <xf:action ev:event="DOMActivate">
                                    <xf:setvalue ref="/sample:equation/sample:second" value="/sample:equation/sample:screen"/>
                                    <xf:setvalue ref="/sample:equation/sample:result" value="/sample:equation/sample:first - /sample:equation/sample:second"/>
                                    <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:result"/>
                                    <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                                </xf:action>
                            </xf:trigger>
                    	</xf:case>
                        <xf:case id="multiply" selected="false">
                            <xf:trigger>
                                <xf:label>=</xf:label>
                                <xf:action ev:event="DOMActivate">
                                    <xf:setvalue ref="/sample:equation/sample:second" value="/sample:equation/sample:screen"/>
                                    <xf:setvalue ref="/sample:equation/sample:result" value="/sample:equation/sample:first * /sample:equation/sample:second"/>
                                    <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:result"/>
                                    <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                                </xf:action>
                            </xf:trigger>
                    	</xf:case>
                        <xf:case id="divide" selected="false">
                            <xf:trigger>
                                <xf:label>=</xf:label>
                                <xf:action ev:event="DOMActivate">
                                    <xf:setvalue ref="/sample:equation/sample:second" value="/sample:equation/sample:screen"/>
                                    <xf:setvalue ref="/sample:equation/sample:result" value="/sample:equation/sample:first div /sample:equation/sample:second"/>
                                    <xf:setvalue ref="/sample:equation/sample:screen" value="/sample:equation/sample:result"/>
                                    <xf:setvalue ref="/sample:equation/sample:screenbuffer" value="0"/>
                                </xf:action>
                            </xf:trigger>
                    	</xf:case>
                    </xf:switch>
                </td>
            </tr>
        </table>
        <div id="console">
		</div>
    </body>
</html>
