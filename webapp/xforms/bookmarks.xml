<?xml version="1.0" encoding="iso-8859-1" ?>
<?xml-stylesheet href="xsltforms/xsltforms.xsl" type="text/xsl"?>
<html xmlns="http://www.w3.org/1999/xhtml"
		xmlns:sample="http://www.agencexml.com/sample"
    xmlns:xf="http://www.w3.org/2002/xforms"
    xmlns:ev="http://www.w3.org/2001/xml-events">
    <head>
        <title>Bookmarks</title>
    	<meta name="description" content="Bookmarks management sample."/>
    	<meta name="keywords" content="AJAX, Javascript, Web, XForms, XSLTForms, Exemples, Samples"/>
        <xf:model>
            <xf:instance>
                <sample:bookmarks>
                    <sample:section>
                        <sample:title>Seccion1</sample:title>
                        <sample:bookmark href="#link11">Link11</sample:bookmark>
                        <sample:bookmark href="#link12">Link12</sample:bookmark>
                    </sample:section>
                    <sample:section>
                        <sample:title>Seccion2</sample:title>
                        <sample:bookmark href="#link21">Link21</sample:bookmark>
                        <sample:bookmark href="#link22">Link22</sample:bookmark>
                    </sample:section>
                </sample:bookmarks>
            </xf:instance>
						<xf:submission id="s01" method="put" replace="all" action="/db/xforms/data/bookmarks.xml">
							<xf:message level="modeless" ev:event="xforms-submit-error">Submit error.</xf:message>
						</xf:submission>
        </xf:model>
    </head>
    <body>
        <h3>Bookmarks</h3>
        <div id="xformControl">
            <span>
                <input type="checkbox" onclick="$('console').style.display = this.checked? 'block' : 'none';"  checked="checked"/> Debug
            </span>
        </div>
        <xf:repeat id="repeatSections" nodeset="sample:section" appearance="full">
            <xf:input ref="sample:title">
                <xf:label>Sección</xf:label>
            </xf:input>
            <xf:repeat id="repeatBookmarks" nodeset="sample:bookmark" appearance="compact">
                <xf:input ref=".">
                    <xf:label>Title</xf:label>
                </xf:input>
                <xf:input ref="@href">
                    <xf:label>URL</xf:label>
                </xf:input>
                <xf:trigger>
                    <xf:label>X</xf:label>
                    <xf:delete nodeset="." at="1" ev:event="DOMActivate"
                        if="count(nodeindex('repeatSections')/sample:bookmark) > 1" />
                </xf:trigger>
            </xf:repeat>
            <xf:trigger>
                <xf:label>New link</xf:label>
                <xf:insert nodeset="sample:bookmark" at="index('repeatBookmarks')"
                    position="after" ev:event="DOMActivate" />
            </xf:trigger>
            <xf:trigger>
                <xf:label>Delete</xf:label>
                <xf:delete nodeset="." at="1" ev:event="DOMActivate"
                	if="count(//sample:section) > 1" />
            </xf:trigger>
        </xf:repeat>
        <xf:trigger>
            <xf:label>New section</xf:label>
            <xf:insert nodeset="sample:section" at="last()"
                position="after" ev:event="DOMActivate" />
        </xf:trigger>
				<xf:submit submission="s01">
						<xf:label>Save</xf:label>
				</xf:submit>
        <xf:trigger>
            <xf:label>Reset</xf:label>
            <xf:reset ev:event="DOMActivate" />
        </xf:trigger>
        <div id="console"></div>
    </body>
</html>