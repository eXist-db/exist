var Core={fileName:"xsltforms.js",fileVersion:"Rev. 498",fileVersionNumber:498,isOpera:navigator.userAgent.match(/\bOpera\b/)!=null,isIE:navigator.userAgent.match(/\bMSIE\b/)!=null&&navigator.userAgent.match(/\bOpera\b/)==null,isIE6:navigator.userAgent.match(/\bMSIE 6.0/)!=null,isMozilla:navigator.userAgent.match(/\bGecko\b/)!=null,isFF2:navigator.userAgent.match(/\bFirefox[\/\s]2.\b/)!=null,isXhtml:!1,setClass:function(a,b,f){assert(a&&b);if(f)this.hasClass(a,b)||(a.className+=" "+b);else if(a.className)a.className=
a.className.replace(b,"")},hasClass:function(a,b){var f=a.className;return inArray(b,f&&f.split(" ")||[])},initHover:function(a){XSLTFormsEvent.attach(a,"mouseover",function(a){Core.setClass(XSLTFormsEvent.getTarget(a),"hover",!0)});XSLTFormsEvent.attach(a,"mouseout",function(a){Core.setClass(XSLTFormsEvent.getTarget(a),"hover",!1)})},getEventPos:function(a){a=a||window.event;return{x:a.pageX||a.clientX+window.document.body.scrollLeft||0,y:a.pageY||a.clientY+window.document.body.scrollTop||0}},getAbsolutePos:function(a){var b=
Core.getPos(a);a.offsetParent&&(a=Core.getAbsolutePos(a.offsetParent),b.x+=a.x,b.y+=a.y);return b},getPos:function(a){var b=/^div$/i.test(a.tagName);return{x:a.offsetLeft-(b&&a.scrollLeft?a.scrollLeft:0),y:a.offsetTop-(b&&a.scrollTop?a.scrollTop:0)}},setPos:function(a,b,f){if(a.offsetParent){var g=Core.getAbsolutePos(a.offsetParent);b-=g.x;f-=g.y}a.style.top=f+"px";a.style.left=b+"px"},loadProperties:function(a){var a=this.ROOT+a,b=Core.openRequest("GET",a,!1);b.overrideMimeType&&b.overrideMimeType("application/xml");
try{b.send(null)}catch(f){alert("File not found: "+a)}if(b.status==200)Core.loadNode(Core.config,Core.selectSingleNode("//properties",b.responseXML)),a=document.getElementById("xf-instance-config").xfElement,Core.config=a.doc.documentElement,a.srcXML=Core.saveXML(Core.config),Core.setMeta(Core.config,"instance","xf-instance-config"),Core.setMeta(Core.config,"model","xf-model-config")},constructURI:function(a){if(a.match(/^[a-zA-Z0-9+.-]+:\/\//))return a;if(a.charAt(0)=="/")return document.location.href.substr(0,
document.location.href.replace(/:\/\//,":\\\\").indexOf("/"))+a;var b=document.location.href,f=b.indexOf("?"),b=f==-1?b:b.substr(0,f),f=b.replace(/:\/\//,":\\\\").lastIndexOf("/");if(b.length>f+1)return(f==-1?b:b.substr(0,f))+"/"+a;return b+a},createElement:function(a,b,f,g){a=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml",a):document.createElement(a);if(g)a.className=g;b&&b.appendChild(a);f&&a.appendChild(document.createTextNode(f));return a},getWindowSize:function(){var a=
0,b=0,f=0,g=0,h=0,i=0;if(typeof window.innerWidth=="number")a=document.documentElement.clientWidth,b=document.documentElement.clientHeight,f=document.body?Math.max(document.documentElement.clientWidth,document.body.clientWidth):document.documentElement.clientWidth,g=document.body?Math.max(document.documentElement.clientHeight,document.body.clientHeight):document.documentElement.clientHeight,h=window.scrollX,i=window.scrollY;else if(document.documentElement&&(document.documentElement.clientWidth||
document.documentElement.clientHeight))a=document.documentElement.clientWidth,b=document.documentElement.clientHeight,f=Math.max(document.documentElement.clientWidth,document.body.clientWidth),g=Math.max(document.documentElement.clientHeight,document.body.clientHeight),h=document.body.parentNode.scrollLeft,i=document.body.parentNode.scrollTop;return{height:b,width:a,offsetX:f,offsetY:g,scrollX:h,scrollY:i}}};
if(window.XMLHttpRequest)Core.openRequest=function(a,b,f){var g=new XMLHttpRequest;try{g.open(a,Core.constructURI(b),f)}catch(h){try{g=new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(i){try{g=new ActiveXObject("Msxml2.XMLHTTP")}catch(j){throw Error("This browser does not support XHRs(Ajax)! \n Cause: "+(j.message||j.description||j)+" \n Enable Javascript or ActiveX controls (on IE) or lower security restrictions.");}}g.open(a,Core.constructURI(b),f)}Core.isMozilla&&g.overrideMimeType("text/xml");return g};
else if(window.ActiveXObject)Core.openRequest=function(a,b,f){try{req=new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(g){try{req=new ActiveXObject("Msxml2.XMLHTTP")}catch(h){throw Error("This browser does not support XHRs(Ajax)! \n Cause: "+(h.message||h.description||h)+" \n Enable Javascript or ActiveX controls (on IE) or lower security restrictions.");}}req.open(a,Core.constructURI(b),f);return req};else throw Error("This browser does not support XHRs(Ajax)! \n Enable Javascript or ActiveX controls (on IE) or lower security restrictions.");
Core.transformText=Core.isIE?function(a,b,f){var g=new ActiveXObject("MSXML2.DOMDocument.6.0");g.loadXML(a);var h=new ActiveXObject("MSXML2.FreeThreadedDOMDocument.6.0");f?h.loadXML(a):(h.async=!1,h.load(b));var i=new ActiveXObject("MSXML2.XSLTemplate.6.0");i.stylesheet=h;h=i.createProcessor();h.input=g;g=3;for(i=arguments.length-1;g<i;g+=2)h.addParameter(arguments[g],arguments[g+1],"");h.transform();return h.output}:function(a,b,f){var g=new DOMParser,h=new XMLSerializer,a=g.parseFromString(a,"text/xml");
f?f=g.parseFromString(b,"text/xml"):(f=document.implementation.createDocument("","",null),f.load?(f.async=!1,f.load(b)):(f=new XMLHttpRequest,f.open("GET",b,!1),f.send(""),b=f.responseText,f=g.parseFromString(b,"text/xml")));b=new XSLTProcessor;Core.isMozilla||b.setParameter(null,"xsltforms_caller","true");b.setParameter(null,"xsltforms_config",document.getElementById("xf-instance-config").xfElement.srcXML);b.setParameter(null,"xsltforms_debug",xforms.debugMode+"");b.setParameter(null,"xsltforms_lang",
Language);b.importStylesheet(f);b=b.transformToDocument(a);return h.serializeToString(b)};for(var __scripts=Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","script"):document.getElementsByTagName("script"),__i=0,__len=__scripts.length;__i<__len;__i++){var __src=__scripts[__i].src;if(__src.indexOf(Core.fileName)!=-1){Core.ROOT=__src.replace(Core.fileName,"");break}}
Core.loadapplet=function(){appelt=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","applet"):document.createElement("applet");appelt.setAttribute("style","position:absolute;left:-1px");appelt.setAttribute("name","xsltforms");appelt.setAttribute("code","xsltforms.class");appelt.setAttribute("archive",Core.ROOT+"xsltforms.jar");appelt.setAttribute("width","1");appelt.setAttribute("height","1");body=Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body")[0]:
document.getElementsByTagName("body")[0];body.insertBefore(appelt,body.firstChild)};Core.javaReadFile=function(a,b,f,g){if(document.applets.xsltforms||(Core.loadapplet(),document.applets.xsltforms))return document.applets.xsltforms.readFile(a,b,f,g)||"";return""};Core.javaWriteFile=function(a,b,f,g,h){if(document.applets.xsltforms||(Core.loadapplet(),document.applets.xsltforms)){if(a=="")a=document.applets.xsltforms.lastChosenFileName;return document.applets.xsltforms.writeFile(a,b,f,g,h)==1}return!1};
Core.readFile=function(a,b,f,g){return Core.javaReadFile(a,b,f,g)};Core.writeFile=function(a,b,f,g,h){return Core.javaWriteFile(a,b,f,g,h)};Core.xsltsrc='<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">\t<xsl:output method="xml" omit-xml-declaration="yes"/>\t<xsl:template match="@*[starts-with(name(),\'xsltforms_\')]" priority="1"/>\t<xsl:template match="@*|node()" priority="0">\t  <xsl:copy>\t    <xsl:apply-templates select="@*|node()"/>\t  </xsl:copy>\t</xsl:template></xsl:stylesheet>';
Core.isIE?(Core.createXMLDocument=function(a){var b=new ActiveXObject("MSXML2.DOMDocument.3.0");b.setProperty("SelectionLanguage","XPath");b.loadXML(a);return b},Core.setAttributeNS=function(a,b,f,g){a.setAttributeNode(a.ownerDocument.createNode(NodeType.ATTRIBUTE,f,b));a.setAttribute(f,g)},Core.selectSingleNode=function(a,b){try{return b.selectSingleNode(a)}catch(f){return null}},Core.selectSingleNodeText=function(a,b){try{return b.selectSingleNode(a).text}catch(f){return""}},Core.selectNodesLength=
function(a,b){try{return b.selectNodes(a).length}catch(f){return 0}},Core.xsltDoc=new ActiveXObject("MSXML2.DOMDocument.3.0"),Core.xsltDoc.loadXML(Core.xsltsrc),Core.loadNode=function(a,b){var f=b.cloneNode(!0);a.parentNode.replaceChild(f,a)},Core.loadXML=function(a,b){var f=new ActiveXObject("MSXML2.DOMDocument.3.0");f.setProperty("SelectionLanguage","XPath");f.loadXML(b);f=f.documentElement.cloneNode(!0);a.parentNode.replaceChild(f,a)},Core.saveXML=function(a){var b=new ActiveXObject("MSXML2.DOMDocument.3.0");
b.setProperty("SelectionLanguage","XPath");b.appendChild(a.documentElement?a.documentElement.cloneNode(!0):a.cloneNode(!0));return b.transformNode(Core.xsltDoc)}):(Core.createXMLDocument=function(a){return Core.parser.parseFromString(a,"text/xml")},Core.setAttributeNS=function(a,b,f,g){a.setAttributeNS(b,f,g)},Core.selectSingleNode=function(a,b){try{return b.evaluate?b.evaluate(a,b,null,XPathResult.ANY_TYPE,null).iterateNext():b.ownerDocument.evaluate(a,b,null,XPathResult.ANY_TYPE,null).iterateNext()}catch(f){return null}},
Core.selectSingleNodeText=function(a,b){try{return b.evaluate?b.evaluate(a,b,null,XPathResult.ANY_TYPE,null).iterateNext().textContent:b.ownerDocument.evaluate(a,b,null,XPathResult.ANY_TYPE,null).iterateNext().textContent}catch(f){return""}},Core.selectNodesLength=function(a,b){try{return b.evaluate?b.evaluate(a,b,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength:b.ownerDocument.evaluate(a,b,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength}catch(f){return 0}},Core.parser=
new DOMParser,Core.xsltDoc=Core.parser.parseFromString(Core.xsltsrc,"text/xml"),Core.xsltProcessor=new XSLTProcessor,Core.xsltProcessor.importStylesheet(Core.xsltDoc),Core.serializer=new XMLSerializer,Core.loadNode=function(a,b){var f=b.cloneNode(!0);a.parentNode.replaceChild(f,a)},Core.loadXML=function(a,b){var f=Core.parser.parseFromString(b,"text/xml").documentElement.cloneNode(!0);a.parentNode.replaceChild(f,a)},Core.saveXML=function(a){a=Core.xsltProcessor.transformToDocument(a);return Core.serializer.serializeToString(a)});
Core.unescape=function(a){if(a==null)return"";a.match(/^\s*</)||(a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&amp;/g,"&"));return a};Core.escape=function(a){if(a==null)return"";typeof a=="string"&&(a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"));return a};
Core.getMeta=function(a,b){return a.nodeType==NodeType.ELEMENT?a.getAttribute("xsltforms_"+b):a.ownerElement?a.ownerElement.getAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b):a.selectSingleNode("..").getAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b)};
Core.getBoolMeta=function(a,b){return Boolean(a.nodeType==NodeType.ELEMENT?a.getAttribute("xsltforms_"+b):a.nodeType==NodeType.ATTRIBUTE?a.ownerElement?a.ownerElement.getAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b):a.selectSingleNode("..").getAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b):!1)};
Core.getType=function(a){if(a.nodeType==NodeType.ELEMENT){var b=a.getAttribute("xsltforms_type");if(b&&b!="")return b;return a.getAttributeNS?a.getAttributeNS("http://www.w3.org/2001/XMLSchema-instance","type"):(a=a.selectSingleNode("@*[local-name()='type' and namespace-uri()='http://www.w3.org/2001/XMLSchema-instance']"))&&a.value!=""?a.value:null}else return a.nodeType==NodeType.DOCUMENT?null:a.ownerElement?a.ownerElement.getAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_type"):a.selectSingleNode("..").getAttribute("xsltforms_"+
(a.localName?a.localName:a.baseName)+"_type")};Core.setMeta=function(a,b,f){a&&(a.nodeType==NodeType.ELEMENT?a.setAttribute("xsltforms_"+b,f):a.ownerElement?a.ownerElement.setAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b,f):a.selectSingleNode("..").setAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b,f))};
Core.setBoolMeta=function(a,b,f){a&&(f?a.nodeType==NodeType.ELEMENT?a.setAttribute("xsltforms_"+b,f):a.ownerElement?a.ownerElement.setAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b,f):a.selectSingleNode("..").setAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b,f):a.nodeType==NodeType.ELEMENT?a.removeAttribute("xsltforms_"+b):a.ownerElement?a.ownerElement.removeAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b):a.selectSingleNode("..").removeAttribute("xsltforms_"+
(a.localName?a.localName:a.baseName)+"_"+b))};Core.setTrueBoolMeta=function(a,b){a&&(a.nodeType==NodeType.ELEMENT?a.setAttribute("xsltforms_"+b,!0):a.ownerElement?a.ownerElement.setAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b,!0):a.selectSingleNode("..").setAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b,!0))};
Core.setFalseBoolMeta=function(a,b){a&&(a.nodeType==NodeType.ELEMENT?a.removeAttribute("xsltforms_"+b):a.ownerElement?a.ownerElement.removeAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b):a.selectSingleNode("..").removeAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_"+b))};
Core.setType=function(a,b){a&&(a.nodeType==NodeType.ELEMENT?a.setAttribute("xsltforms_type",b):a.ownerElement?a.ownerElement.setAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_type",b):a.selectSingleNode("..").setAttribute("xsltforms_"+(a.localName?a.localName:a.baseName)+"_type",b))};
if(!Core.isIE)typeof XMLDocument=="undefined"&&(XMLDocument=Document),XMLDocument.prototype.selectNodes=function(a,b,f){a=this.evaluate(a,f?f:this,this.createNSResolver(this.documentElement),b?XPathResult.FIRST_ORDERED_NODE_TYPE:XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(b)return a.singleNodeValue?a.singleNodeValue:null;for(var b=0,f=a.snapshotLength,g=[];b<f;b++)g.push(a.snapshotItem(b));return g},XMLDocument.prototype.selectSingleNode=function(a){return this.selectNodes(a,!0)},XMLDocument.prototype.createNode=
function(a,b,f){switch(a){case NodeType.ELEMENT:return this.createElementNS(f,b);case NodeType.ATTRIBUTE:return this.createAttributeNS(f,b);default:return null}},Element.prototype.selectNodes=function(a){return this.ownerDocument.selectNodes(a,!1,this)},Element.prototype.selectSingleNode=function(a){return this.ownerDocument.selectNodes(a,!0,this)};
var DebugConsole={element_:null,isInit_:!1,time_:0,init_:function(){this.element_=document.getElementById("xsltforms_console");this.isInit_=!0;this.time_=(new Date).getTime()},write:function(a){try{if(this.isOpen()){var b=(new Date).getTime();this.element_.appendChild(document.createTextNode(b-this.time_+" -> "+a));Core.createElement("br",this.element_);this.time_=b}}catch(f){}},clear:function(){if(this.isOpen()){for(;this.element_.firstChild;)this.element_.removeChild(this.element_.firstChild);this.time_=
(new Date).getTime()}},isOpen:function(){this.isInit_||this.init_();return this.element_!=null}},Dialog={openPosition:{},dialogs:[],init:!1,initzindex:50,zindex:0,selectstack:[],dialogDiv:function(a){var b=null;typeof a!="string"?(b=a.getAttribute("id"),b=b!=null&&b!=""?IdManager.find(b):a):b=IdManager.find(a);b||DebugConsole.write("Unknown dialog("+a+")!");return b},show:function(a,b,f){if((a=this.dialogDiv(a))&&this.dialogs[this.dialogs.length-1]!==a){this.dialogs=removeArrayItem(this.dialogs,a);
this.dialogs.push(a);if(f){var g=document.getElementById("xforms-dialog-surround");g.style.display="block";g.style.zIndex=(this.zindex+this.initzindex)*2;this.zindex++;var h=Core.getWindowSize();g.style.height=h.height+"px";g.style.width=h.width+"px";g.style.top=h.scrollY+"px";g.style.left=h.scrollX+"px";h=function(){var a=document.getElementById("xforms-dialog-surround"),b=Core.getWindowSize();a.style.height=b.height+"px";a.style.width=b.width+"px";a.style.top=b.scrollY+"px";a.style.left=b.scrollX+
"px"};window.onscroll=h;window.onresize=h}a.style.display="block";a.style.zIndex=(this.zindex+this.initzindex)*2-1;this.showSelects(a,!1,f);b?(f=Core.getAbsolutePos(b),Core.setPos(a,f.x,f.y+b.offsetHeight)):(h=Core.getWindowSize(),b=h.scrollY+(h.height-a.offsetHeight)/2,Core.setPos(a,(h.width-a.offsetWidth)/2,b>0?b:100))}},hide:function(a,b){if(a=this.dialogDiv(a)){var f=this.dialogs.length;this.dialogs=removeArrayItem(this.dialogs,a);if(this.dialogs.length!=f&&(this.showSelects(a,!0,b),a.style.display=
"none",b))if(this.dialogs.length){if(this.zindex--,document.getElementById("xforms-dialog-surround").style.zIndex=(this.zindex+this.initzindex)*2-2,this.dialogs.length)this.dialogs[this.dialogs.length-1].style.zIndex=(this.zindex+this.initzindex)*2-1}else this.zindex=0,document.getElementById("xforms-dialog-surround").style.display="none",window.onscroll=null,window.onresize=null}},knownSelect:function(a){if(Core.isIE6)for(var b=0,f=this.zindex;b<f;b++)for(var g=0,h=this.selectstack[b].length;g<h;g++)if(this.selectstack[b][g].select==
a)return!0;return!1},showSelects:function(a,b,f){if(Core.isIE6){for(var g=Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","select"):document.getElementsByTagName("select"),h=Core.getAbsolutePos(a),i=a.offsetWidth,j=a.offsetHeight,k=[],l=0,q=g.length;l<q;l++){for(var n=g[l],m=n.parentNode;m&&m!=a;)m=m.parentNode;if(m!=a){var m=Core.getAbsolutePos(n),r=n.offsetHeight,m=m.x+n.offsetWidth>h.x&&m.x<h.x+i&&m.y+r>h.y&&m.y<h.y+j;if(f)if(b){k=this.selectstack[this.zindex];m=0;for(r=
k.length;m<r;m++)if(k[m].select==n){n.disabled=k[m].disabled;n.style.visibility=k[m].visibility;break}}else k[k.length]={select:n,disabled:n.disabled,visibility:n.style.visibility},m?n.style.visibility="hidden":n.disabled=!0;else if(m)n.style.visibility=b?"":"hidden"}}f&&!b&&(this.selectstack[this.zindex-1]=k)}}},XSLTFormsEvent={cache:null,add_:function(){if(!XSLTFormsEvent.cache)XSLTFormsEvent.cache=[],XSLTFormsEvent.attach(window,"unload",XSLTFormsEvent.flush_);XSLTFormsEvent.cache.push(arguments)},
flush_:function(){if(XSLTFormsEvent.cache){for(var a=XSLTFormsEvent.cache.length-1;a>=0;a--){var b=XSLTFormsEvent.cache[a];XSLTFormsEvent.detach(b[0],b[1],b[2],b[3])}if(XSLTFormsEvent.onunload)XSLTFormsEvent.onunload();XSLTFormsEvent.onunload=null}},onunload:null};
Core.isIE?(XSLTFormsEvent.attach=function(a,b,f,g){var h=function(a){f.call(window.event.srcElement,a)};a.attachEvent("on"+b,h);this.add_(a,b,h,g)},XSLTFormsEvent.detach=function(a,b,f){a.detachEvent("on"+b,f)},XSLTFormsEvent.getTarget=function(){return window.event.srcElement},XSLTFormsEvent.dispatch=function(a,b){a.fireEvent("on"+b,document.createEventObject())}):(XSLTFormsEvent.attach=function(a,b,f,g){a==window&&!window.addEventListener&&(a=document);a.addEventListener(b,f,g);this.add_(a,b,f,
g)},XSLTFormsEvent.detach=function(a,b,f,g){a==window&&!window.addEventListener&&(a=document);a.removeEventListener(b,f,g)},XSLTFormsEvent.getTarget=function(a){return a.target},XSLTFormsEvent.dispatch=function(a,b){var f=document.createEvent("Event");f.initEvent(b,!0,!0);a.dispatchEvent(f)});
var I8N={messages:null,lang:null,langs:["cz","de","el","en","en_us","es","fr","gl","ko","it","ja","nb_no","nl","nn_no","pt","ro","ru","si","sk","zh","zh_cn","zh_tw"],get:function(a){if(!Core.config)return"Initializing";if(Language=="navigator"||Language!=Core.selectSingleNodeText("language",Core.config)){var b=Language=="navigator"?navigator.language||navigator.userLanguage:Core.selectSingleNodeText("language",Core.config),b=b.replace("-","_").toLowerCase(),f=inArray(b,I8N.langs);f||(ind=b.indexOf("_"),
ind!=-1&&(b=b.substring(0,ind)),f=inArray(b,I8N.langs));f?(Core.loadProperties("config_"+b+".xsl"),Language=Core.selectSingleNodeText("language",Core.config)):Language="default"}return Core.selectSingleNodeText(a,Core.config)},parse:function(a,b){if(a==null||a.match("^\\s*$"))return null;b||(b=I8N.get("format.datetime"));var f=new Date;I8N._parse(f,"Year",a,b,"yyyy");I8N._parse(f,"Month",a,b,"MM");I8N._parse(f,"Date",a,b,"dd");I8N._parse(f,"Hours",a,b,"hh");I8N._parse(f,"Minutes",a,b,"mm");I8N._parse(f,
"Seconds",a,b,"ss");return f},format:function(a,b,f){if(!a)return"";b||(b=I8N.get("format.datetime"));b=I8N._format(b,f?a.getDate():a.getUTCDate(),"dd");b=I8N._format(b,(f?a.getMonth():a.getUTCMonth())+1,"MM");y=f?a.getFullYear():a.getUTCFullYear();b=I8N._format(b,y<1E3?1900+y:y,"yyyy");b=I8N._format(b,f?a.getSeconds():a.getUTCSeconds(),"ss");b=I8N._format(b,f?a.getMinutes():a.getUTCMinutes(),"mm");b=I8N._format(b,f?a.getHours():a.getUTCHours(),"hh");o=a.getTimezoneOffset();return b=I8N._format(b,
f?(o<0?"+":"-")+zeros(Math.floor(Math.abs(o)/60),2)+":"+zeros(Math.abs(o)%60,2):"Z","z")},parseDate:function(a){return I8N.parse(a,I8N.get("format.date"))},formatDate:function(a){return I8N.format(a,I8N.get("format.date"),!0)},formatNumber:function(a,b){if(isNaN(a))return a;var f=""+a,g=f.indexOf("."),h=parseInt(g!=-1?f.substring(0,g):f,10),f=g!=-1?f.substring(g+1):"",g=I8N.get("format.decimal");return h+(b>0?g+zeros(f,b,!0):f?g+f:"")},parseNumber:function(a){var b=I8N.get("format.decimal");if(!a.match("^[\\-+]?([0-9]+(\\"+
b+"[0-9]*)?|\\"+b+"[0-9]+)$"))throw"Invalid number "+a;var f=a.indexOf(b),b=parseInt(f!=-1?a.substring(0,f):a,10),a=f!=-1?a.substring(f+1):null;return b+(a?"."+a:"")},_format:function(a,b,f){return a.replace(f,zeros(b,f.length))},_parse:function(a,b,f,g,h){if(g.indexOf(h)!=-1){g=g.replace(RegExp("\\.","g"),"\\.");g=g.replace(RegExp("\\(","g"),"\\(");g=g.replace(RegExp("\\)","g"),"\\)");g=g.replace(RegExp(h),"(.*)");g=g.replace(/yyyy/,".*");g=g.replace(/MM/,".*");g=g.replace(/dd/,".*");g=g.replace(/hh/,
".*");g=g.replace(/mm/,".*");g=g.replace(/ss/,".*");h=f.replace(RegExp(g),"$1");h.charAt(0)==="0"&&(h=h.substring(1));h=parseInt(h,10);if(isNaN(h))throw"Error parsing date "+f+" with pattern "+g;f=new Date;f=f.getFullYear()-2E3;a["set"+b](b=="Month"?h-1:b=="Year"&&h<=f+10?h+2E3:h)}}},NumberList=function(a,b,f,g,h,i){this.element=Core.createElement("ul",a,null,b);this.move=0;this.input=f;this.min=g;this.max=h;this.minlength=i||1;var j=this;this.createChild("+",function(){j.start(1)},function(){j.stop()});
for(a=0;a<7;a++)this.createChild(" ",function(a){j.input.value=XSLTFormsEvent.getTarget(a).childNodes[0].nodeValue;j.close();XSLTFormsEvent.dispatch(j.input,"change")});this.createChild("-",function(){j.start(-1)},function(){j.stop()})};NumberList.prototype.show=function(){var a=this.input;this.current=parseInt(a.value,10);this.refresh();Dialog.show(this.element,a,!1)};NumberList.prototype.close=function(){Dialog.hide(this.element,!1)};
NumberList.prototype.createChild=function(a,b,f){a=Core.createElement("li",this.element,a);Core.initHover(a);f?(XSLTFormsEvent.attach(a,"mousedown",b),XSLTFormsEvent.attach(a,"mouseup",f)):XSLTFormsEvent.attach(a,"click",b)};NumberList.prototype.refresh=function(){var a=this.element.childNodes,b=this.current;b>=this.max-3?b=this.max-3:b<=this.min+3&&(b=this.min+3);b+=4;for(var f=1;f<8;f++){Core.setClass(a[f],"hover",!1);for(var g=b-f+"";g.length<this.minlength;g="0"+g);a[f].firstChild.nodeValue=g}};
NumberList.prototype.start=function(a){this.move=a;NumberList.current=this;this.run()};NumberList.prototype.stop=function(){this.move=0};NumberList.prototype.run=function(){if(this.move>0&&this.current+3<this.max||this.move<0&&this.current-3>this.min)this.current+=this.move,this.refresh(),setTimeout("NumberList.current.run()",60)};NumberList.current=null;
function forEach(a,b){for(var f=[],g=0,h=arguments.length-2;g<h;g++)f[g]=arguments[g+2];if(a)if(typeof a.length=="number")for(var i=0,g=a.length;i<g;i++)h=a[i],(typeof b=="string"?h[b]:b).apply(h,f);else for(i in a)g=a[i],(typeof b=="string"?g[b]:b).apply(g,f)}
function assert(a,b){if(!a&&DebugConsole.isOpen()){DebugConsole.write("Assertion failed: "+b);if(arguments.caller){this.callstack=[];for(var f=arguments.caller;f!=null;f=f.caller)this.callstack.push(f.name?f.name:"<anonymous>")}if(this.callstack)for(var f=0,g=this.callstack.length;f<g;f++)DebugConsole.write("> "+this.callstack[f]);throw b;}}function inArray(a,b){for(var f=0,g=b.length;f<g;f++)if(a==b[f])return!0;return!1}function zeros(a,b,f){for(a=""+a;a.length<b;a=f?a+"0":"0"+a);return a}
function getValue(a,b,f){assert(a);if(f)return a.nodeType==NodeType.ATTRIBUTE?a.nodeValue:Core.saveXML(a);if((f=a.text!=void 0?a.text:a.textContent)&&b)if(a=Schema.getType(Core.getType(a)||"xsd_:string"),a.format)try{f=a.format(f)}catch(g){}return f}
function setValue(a,b){assert(a);if(a.nodeType==NodeType.ATTRIBUTE)a.nodeValue=b;else if(Core.isIE&&a.innerHTML)a.innerHTML=b;else{for(;a.firstChild;)a.removeChild(a.firstChild);if(b!=null)for(var f=0,g=b.length;f<g;f+=4096)a.appendChild(a.ownerDocument.createTextNode(b.substr(f,4096)))}}
function run(a,b,f,g,h){g?(Dialog.show("statusPanel",null,!1),setTimeout(function(){xforms.openAction();a.execute(IdManager.find(b),null,f);Dialog.hide("statusPanel",!1);h||f.stopPropagation();xforms.closeAction()},1)):(xforms.openAction(),a.execute(IdManager.find(b),null,f),h||f.stopPropagation(),xforms.closeAction())}function getId(a){return a.id?a.id:a.parentNode.parentNode.parentNode.parentNode.id}function show(a,b,f){a.parentNode.lastChild.style.display=f?"inline":"none"}
String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")};String.prototype.addslashes=function(){return this.replace(/\\/g,"\\\\").replace(/\'/g,"\\'").replace(/\"/g,'\\"')};function copyArray(a,b){if(b)for(var f=0,g=a.length;f<g;f++)b[f]=a[f]}function removeArrayItem(a,b){for(var f=[],g=0,h=a.length;g<h;g++)a[g]!=b&&f.push(a[g]);return f}
var xforms={cont:0,ready:!1,body:null,models:[],defaultModel:null,changes:[],newChanges:[],building:!1,posibleBlur:!1,bindErrMsgs:[],loadingtime:0,refreshtime:0,refreshcount:0,debugMode:!1,debugButtons:[{label:"Profiler",action:"xforms.profiling();"}],debugging:function(){var a=Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body")[0]:document.getElementsByTagName("body")[0];if(this.debugMode){var b=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml",
"div"):document.createElement("div");b.setAttribute("style","border-bottom: thin solid #888888;");b.setAttribute("id","xsltforms_debug");var f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","img"):document.createElement("img");f.setAttribute("src",Core.ROOT+"magnify.png");f.setAttribute("style","vertical-align:middle;border:0;");b.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","span"):document.createElement("span");f.setAttribute("style",
"font-size:16pt");var g=document.createTextNode(" Debug Mode");f.appendChild(g);b.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","span"):document.createElement("span");f.setAttribute("style","font-size:11pt");g=document.createTextNode(" ("+Core.fileVersion+") \u00a0\u00a0\u00a0");f.appendChild(g);b.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","a"):document.createElement("a");f.setAttribute("href","http://www.w3.org/TR/xforms11/");
f.setAttribute("style","text-decoration:none;");g=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","img"):document.createElement("img");g.setAttribute("src",Core.ROOT+"valid-xforms11.png");g.setAttribute("style","vertical-align:middle;border:0;");f.appendChild(g);b.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","a"):document.createElement("a");f.setAttribute("href","http://www.agencexml.com/xsltforms");f.setAttribute("style","text-decoration:none;");
g=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","img"):document.createElement("img");g.setAttribute("src",Core.ROOT+"poweredbyXSLTForms.png");g.setAttribute("style","vertical-align:middle;border:0;");f.appendChild(g);b.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","span"):document.createElement("span");f.setAttribute("style","font-size:11pt");g=document.createTextNode(" Press ");f.appendChild(g);b.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml",
"a"):document.createElement("a");f.setAttribute("onClick","xforms.debugMode=false;xforms.debugging();return false;");f.setAttribute("style","text-decoration:none;");f.setAttribute("href","#");g=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","img"):document.createElement("img");g.setAttribute("src",Core.ROOT+"F1.png");g.setAttribute("style","vertical-align:middle;border:0;");f.appendChild(g);b.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml",
"span"):document.createElement("span");f.setAttribute("style","font-size:11pt");g=document.createTextNode(" to toggle mode ");f.appendChild(g);b.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","br"):document.createElement("br");b.appendChild(f);f=document.createTextNode(" \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0");b.appendChild(f);f=0;for(g=xforms.debugButtons.length;f<g;f++)if(xforms.debugButtons[f].action){var h=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml",
"button"):document.createElement("button");h.setAttribute("onClick",xforms.debugButtons[f].action);var i=document.createTextNode(" "+xforms.debugButtons[f].label+" ");h.appendChild(i);b.appendChild(h)}else{f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","a"):document.createElement("a");f.setAttribute("href","http://www.agencexml.com/xsltforms");g=document.createTextNode(" Debugging extensions can be downloaded! ");f.appendChild(g);b.appendChild(f);break}f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml",
"br"):document.createElement("br");b.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","iframe"):document.createElement("iframe");f.setAttribute("src","http://www.agencexml.com/direct/banner.htm");f.setAttribute("style","width:100%;height:90px;border:none;margin:0;");f.setAttribute("frameborder","0");b.appendChild(f);a.insertBefore(b,a.firstChild);document.getElementById("xsltforms_console").style.display="block"}else a.removeChild(document.getElementById("xsltforms_debug")),
document.getElementById("xsltforms_console").style.display="none"},profiling:function(){var a="XSLTForms Profiler:\n";a+="\nLoading Time: "+this.loadingtime+"ms";a+="\nRefresh Counter: "+this.refreshcount;a+="\nCumulative Refresh Time: "+this.refreshtime+"ms";var b=[],f;for(f in XPath.expressions)b[b.length]={expr:f,evaltime:XPath.expressions[f].evaltime};b.sort(function(a,b){return b.evaltime-a.evaltime});f=0;if(b.length>0){a+="\nXPath Evaluation:";for(var g=0;g<b.length&&g<20;g++)a+='\n   "'+(b[g].expr.length>
60?b[g].expr.substring(0,60)+"...":b[g].expr)+'": '+b[g].evaltime+"ms",f+=b[g].evaltime;if(b.length>20){for(var h=0,g=20;g<b.length;g++)h+=b[g].evaltime;a+="\n   Others ("+(b.length-20)+" expr.): "+h+"ms";f+=h;a+="\n   Total: "+f+"ms"}}alert(a)},init:function(){setValue(document.getElementById("statusPanel"),I8N.get("status"));var a=Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body")[0]:document.getElementsByTagName("body")[0];this.body=a;document.onhelp=new Function("return false;");
window.onhelp=new Function("return false;");XSLTFormsEvent.attach(document,"keydown",function(a){if(a.keyCode==112)return xforms.debugMode=!xforms.debugMode,xforms.debugging(),a.stopPropagation?(a.stopPropagation(),a.preventDefault()):a.cancelBubble=!0,!1});XSLTFormsEvent.attach(a,"click",function(a){for(var f=a=XSLTFormsEvent.getTarget(a);f&&f.nodeType==NodeType.ELEMENT;)Core.hasClass(f,"xforms-repeat-item")&&XFRepeat.selectItem(f),f=f.parentNode;for(f=a;f&&f.nodeType==NodeType.ELEMENT;){var g=f.xfElement;
if(g){if(typeof f.node!="undefined"&&f.node!=null&&g.focus&&!Core.getBoolMeta(f.node,"readonly")){var h=a.nodeName.toLowerCase();g.focus(h=="input"||h=="textarea")}if(g.click){g.click(a);break}}f=f.parentNode}});XSLTFormsEvent.onunload=function(){xforms.close()};this.openAction();XMLEvents.dispatchList(this.models,"xforms-model-construct");this.refresh();this.closeAction();this.ready=!0;Dialog.hide("statusPanel",!1)},close:function(){if(xforms.body){xforms.openAction();for(var a=0,b=Listener.destructs.length;a<
b;a++)Listener.destructs[a].callback({target:Listener.destructs[a].observer});xforms.closeAction();IdManager.clear();xforms.defaultModel=null;xforms.changes=[];xforms.models=[];xforms.body=null;xforms.cont=0;xforms.dispose(document.documentElement);if(XSLTFormsEvent.cache)for(a=XSLTFormsEvent.cache.length-1;a>=0;a--)b=XSLTFormsEvent.cache[a],XSLTFormsEvent.detach(b[0],b[1],b[2],b[3]);Listener.destructs=[];Schema.all={};TypeDefs.initAll();xforms.ready=!1;xforms.building=!1;xforms.posibleBlur=!1}},
openAction:function(){this.cont++==0&&DebugConsole.clear()},closeAction:function(){this.cont==1&&this.closeChanges();this.cont--},closeChanges:function(){for(var a=this.changes,b=0,f=a.length;b<f;b++){var g=a[b];g.instances&&(g.rebuilded?XMLEvents.dispatch(g,"xforms-rebuild"):XMLEvents.dispatch(g,"xforms-recalculate"))}a.length>0&&(this.refresh(),this.changes.length>0&&this.closeChanges())},error:function(a,b,f,g){Dialog.hide("statusPanel",!1);setValue(document.getElementById("statusPanel"),f);Dialog.show("statusPanel",
null,!1);a!=null&&XMLEvents.dispatch(a,b);g&&(f+=" : "+g);DebugConsole.write("Error: "+f);throw b;},refresh:function(){var a=new Date;this.building=!0;this.build(this.body,this.defaultModel.getInstanceDocument()?this.defaultModel.getInstanceDocument().documentElement:null,!0);this.newChanges.length>0?(this.changes=this.newChanges,this.newChanges=[]):this.changes.length=0;for(var b=0,f=this.models.length;b<f;b++){var g=this.models[b];g.newNodesChanged.length>0||g.newRebuilded?(g.nodesChanged=g.newNodesChanged,
g.newNodesChanged=[],g.rebuilded=g.newRebuilded,g.newRebuilded=!1):(g.nodesChanged.length=0,g.rebuilded=!1)}this.building=!1;if(this.bindErrMsgs.length)this.error(this.defaultModel,"xforms-binding-exception","Binding Errors: \n"+this.bindErrMsgs.join("\n  ")),this.bindErrMsgs=[];this.refreshtime+=new Date-a;this.refreshcount++},build:function(a,b,f){if(!(a.nodeType!=NodeType.ELEMENT||a.id=="xsltforms_console"||a.hasXFElement==!1)){var g=a.xfElement,h=!!g;if(a.getAttribute("mixedrepeat")=="true")b=
a.node||b,f=a.selected;g&&(g.build(b),g.isRepeat&&g.refresh(f));var b=a.node||b,i=a.childNodes,j=a.selected;typeof j!="undefined"&&(f=j);if(!g||!g.isRepeat||g.nodes.length>0)for(j=0;j<i.length&&this.building;j++)h=(i[j].nodeType==NodeType.ELEMENT&&!i[j].getAttribute("cloned")?this.build(i[j],b,f):!1)||h;if(this.building){if(g&&g.changed)g.refresh(f),g.changed=!1;if(a.hasXFElement==null)a.hasXFElement=h}return h}},addChange:function(a){var b=this.building?this.newChanges:this.changes;inArray(a,b)||
b.push(a)},dispose:function(a){if(!(a.nodeType!=NodeType.ELEMENT||a.id=="xsltforms_console")){a.listeners=null;a.node=null;var b=a.xfElement;b&&b.dispose();a=a.childNodes;for(b=0;b<a.length;b++)this.dispose(a[b])}},blur:function(a){if((a||this.posibleBlur)&&this.focus)this.focus.element&&(this.openAction(),XMLEvents.dispatch(this.focus,"DOMFocusOut"),Core.setClass(this.focus.element,"xforms-focus",!1),this.focus.blur(),this.closeAction()),this.posibleBlur=!1,this.focus=null}};
function Binding(a,b,f,g){this.isvalue=a;this.bind=g?g:null;this.xpath=b?XPath.get(b):null;a=f;typeof f=="string"&&(a=document.getElementById(f));this.model=f?a!=null?a.xfElement:f:null}
Binding.prototype.evaluate=function(a,b,f,g){var h=null;if(this.bind){if(typeof this.bind=="string"){a=document.getElementById(this.bind);if(!a)return DebugConsole.write("Binding evaluation returned null for bind: "+this.bind),null;this.bind=a.xfElement}h=this.bind.nodes;copyArray(this.bind.depsNodes,b);copyArray(this.bind.depsElements,g)}else h=this.xpath.evaluate(new ExprContext(!a||this.model&&this.model!=document.getElementById(Core.getMeta(a.ownerDocument.documentElement,"model")).xfElement?
this.model?this.model.getInstanceDocument().documentElement:xforms.defaultModel.getInstanceDocument():a,null,null,null,null,a,b,f,g));return this.isvalue?stringValue(h):h};
var IdManager={cloneId:function(a){assert(a&&a.id);var b=a.getAttribute("oldid")||a.id,f=this.data[b];f||(f=[],this.data[b]=f);var g="clonedId"+this.index++;f.push(g);a.setAttribute("oldid",b);a.id=g},find:function(a){var b=this.data[a];if(b)for(var f=0,g=b.length;f<g;f++){var h=document.getElementById(b[f]);if(h)for(var i=h.parentNode;i.nodeType==NodeType.ELEMENT;){if(Core.hasClass(i,"xforms-repeat-item"))if(Core.hasClass(i,"xforms-repeat-item-selected"))return h;else break;i=i.parentNode}}return document.getElementById(a)},
clear:function(){for(var a=0,b=this.data.length;a<b;a++)this.data[a]=null;this.data=[];index=0},data:[],index:0};function XFCoreElement(){}XFCoreElement.prototype.init=function(a,b,f){b=b?b.element:Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","head")[0]:document.getElementsByTagName("head")[0];this.element=Core.createElement("span",b,null,f);this.element.id=a;this.element.xfElement=this};
XFCoreElement.prototype.dispose=function(){this.element.xfElement=null;this.element.parentNode.removeChild(this.element);this.model=this.element=null};
function XFModel(a,b){this.init(a,null,"xforms-model");this.instances={};this.binds=[];this.nodesChanged=[];this.newNodesChanged=[];this.schemas=[];this.defaultSubmission=this.defaultInstance=null;xforms.models.push(this);xforms.defaultModel=xforms.defaultModel||this;if(document.getElementById(a))document.getElementById(a).getInstanceDocument=function(a){return this.xfElement.getInstanceDocument(a)},document.getElementById(a).rebuild=function(){return this.xfElement.rebuild()},document.getElementById(a).recalculate=
function(){return this.xfElement.recalculate()},document.getElementById(a).revalidate=function(){return this.xfElement.revalidate()},document.getElementById(a).refresh=function(){return this.xfElement.refresh()},document.getElementById(a).reset=function(){return this.xfElement.reset()};if(b)for(var b=b.split(" "),f=0,g=b.length;f<g;f++){var h=!1,i;for(i in Schema.all){var j=Schema.all[i];if(j.name==b[f]){this.schemas.push(j);h=!0;break}}h||xforms.error(this,"xforms-link-exception","Schema "+b[f]+
" not found")}}XFModel.prototype=new XFCoreElement;XFModel.prototype.addInstance=function(a){this.instances[a.element.id]=a;this.defaultInstance=this.defaultInstance||a};XFModel.prototype.addBind=function(a){this.binds.push(a)};XFModel.prototype.dispose=function(){this.defaultInstance=this.binds=this.instances=null;XFCoreElement.prototype.dispose.call(this)};XFModel.prototype.getInstance=function(a){return a?this.instances[a]:this.defaultInstance};
XFModel.prototype.getInstanceDocument=function(a){return(a=this.getInstance(a))?a.doc:null};XFModel.prototype.findInstance=function(a){var a=a.nodeType==NodeType.DOCUMENT?a:a.ownerDocument,b;for(b in this.instances){var f=this.instances[b];if(a==f.doc)return f}return null};
XFModel.prototype.construct=function(){xforms.ready||forEach(this.instances,"construct");XMLEvents.dispatch(this,"xforms-rebuild");XMLEvents.dispatch(this,"xforms-model-construct-done");this==xforms.models[xforms.models.length-1]&&window.setTimeout('XMLEvents.dispatchList(xforms.models, "xforms-ready")',1)};XFModel.prototype.reset=function(){forEach(this.instances,"reset");this.setRebuilded(!0);xforms.addChange(this)};
XFModel.prototype.rebuild=function(){xforms.ready&&this.setRebuilded(!0);forEach(this.binds,"refresh");XMLEvents.dispatch(this,"xforms-recalculate")};XFModel.prototype.recalculate=function(){forEach(this.binds,"recalculate");XMLEvents.dispatch(this,"xforms-revalidate")};XFModel.prototype.revalidate=function(){forEach(this.instances,"revalidate");xforms.ready&&XMLEvents.dispatch(this,"xforms-refresh")};XFModel.prototype.refresh=function(){};
XFModel.prototype.addChange=function(a){var b=xforms.building?this.newNodesChanged:this.nodesChanged;inArray(a,b)||xforms.addChange(this);a.nodeType==NodeType.ATTRIBUTE&&!inArray(a,b)&&(b.push(a),a=a.ownerElement?a.ownerElement:a.selectSingleNode(".."));for(;a.nodeType==NodeType.ELEMENT&&!inArray(a,b);)b.push(a),a=a.parentNode};XFModel.prototype.setRebuilded=function(a){xforms.building?this.newRebuilded=a:this.rebuilded=a};
function XFInstance(a,b,f,g,h,i){this.init(a,b,"xforms-instance");this.readonly=f;this.mediatype=g;this.src=Core.unescape(h);switch(g){case "application/xml":this.srcXML=Core.unescape(i);break;case "application/json":eval("json = "+Core.unescape(i));this.srcXML=json2xml("",void 0,!0,!1);break;default:alert("Unsupported mediatype '"+g+"' for instance #"+a);return}this.model=b;this.doc=Core.createXMLDocument("<dummy/>");Core.setMeta(this.doc.documentElement,"instance",a);Core.setMeta(this.doc.documentElement,
"model",b.element.id);b.addInstance(this)}XFInstance.prototype=new XFCoreElement;XFInstance.prototype.dispose=function(){XFCoreElement.prototype.dispose.call(this)};
XFInstance.prototype.construct=function(){if(!xforms.ready)if(this.src){var a=!1;if(this.src.match(/^[a-zA-Z0-9+.-]+:\/\//))var b=/^([a-zA-Z0-9+.-]+:\/\/[^\/]*)/,a=b.exec(this.src),b=b.exec(document.location.href),a=a[0]!=b[0];if(a){this.setDoc('<dummy xmlns=""/>');jsoninstobj=this;var f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","script"):document.createElement("script");f.setAttribute("src",this.src+(this.src.indexOf("?")==-1?"?":"&")+"callback=jsoninst");f.setAttribute("id",
"jsoninst");f.setAttribute("type","text/javascript");a=Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body")[0]:document.getElementsByTagName("body")[0];a.insertBefore(f,a.firstChild)}else try{f=Core.openRequest("GET",this.src,!1);DebugConsole.write("Loading "+this.src);f.send(null);if(f.status!=0&&(f.status<200||f.status>=300))throw"Request error: "+f.status;this.setDoc(f.responseText)}catch(g){xforms.error(this.element,"xforms-link-exception","Fatal error loading "+
this.src,g.toString())}}else this.setDoc(this.srcXML)};XFInstance.prototype.reset=function(){this.setDoc(this.oldXML,!0)};XFInstance.prototype.store=function(a){if(this.oldXML&&!a)this.oldXML=null;this.oldXML=Core.saveXML(this.doc.documentElement)};
XFInstance.prototype.setDoc=function(a,b,f){var g=Core.getMeta(this.doc.documentElement,"instance"),h=Core.getMeta(this.doc.documentElement,"model");Core.loadXML(this.doc.documentElement,a);Core.setMeta(this.doc.documentElement,"instance",g);Core.setMeta(this.doc.documentElement,"model",h);f||this.store(b);if(g=="xf-instance-config")Core.config=this.doc.documentElement};XFInstance.prototype.revalidate=function(){this.readonly||this.validation_(this.doc.documentElement)};
XFInstance.prototype.validation_=function(a,b,f){b==null&&(b=!1);f==null&&(f=!1);this.validate_(a,b,f);for(var b=Core.getBoolMeta(a,"readonly"),f=Core.getBoolMeta(a,"notrelevant"),g=a.attributes||[],h=[],i=0,j=g.length;i<j;i++)g[i].nodeName.substr(0,10)!="xsltforms_"&&(h[h.length]=g[i]);i=0;for(j=h.length;i<j;i++)this.validation_(h[i],b,f);g=0;for(h=a.childNodes.length;g<h;g++)i=a.childNodes[g],i.nodeType==NodeType.ELEMENT&&this.validation_(i,b,f)};
XFInstance.prototype.validate_=function(a,b,f){var g=Core.getMeta(a,"bind"),h=xmlValue(a),i=Schema.getType(Core.getType(a)||"xsd_:string");if(g)for(var g=g.split(" "),j=!1,k=!1,l=0,q=g.length;l<q;l++){for(var n=document.getElementById(g[l]).xfElement,m=n.nodes,r=0,v=m.length;r<v;r++)if(m[r]==a)break;for(var x=0,v=n.depsNodes.length;x<v;x++)Core.setFalseBoolMeta(n.depsNodes[x],"depfor_"+n.depsId);n.depsNodes.length=0;m=new ExprContext(a,r,m,null,null,null,[],n.depsId);n.required&&this.setProperty_(a,
"required",booleanValue(n.required.evaluate(m)));if(f||!j||n.relevant!=void 0)this.setProperty_(a,"notrelevant",f||!(n.relevant?booleanValue(n.relevant.evaluate(m)):1)),j=j||n.relevant!=void 0;if(b||!k||n.readonly!=void 0)this.setProperty_(a,"readonly",b||(n.readonly?booleanValue(n.readonly.evaluate(m)):n.calculate?!0:!1)),k=k||n.readonly!=void 0;this.setProperty_(a,"notvalid",!Core.getBoolMeta(a,"notrelevant")&&!((!Core.getBoolMeta(a,"required")||h&&h!="")&&(!i||i.validate(h))&&(!n.constraint||booleanValue(n.constraint.evaluate(m)))));
copyArray(m.depsNodes,n.depsNodes)}else this.setProperty_(a,"notrelevant",f),this.setProperty_(a,"readonly",b),this.setProperty_(a,"notvalid",i&&!i.validate(h))};XFInstance.prototype.setProperty_=function(a,b,f){Core.getBoolMeta(a,b)!=f&&(Core.setBoolMeta(a,b,f),this.model.addChange(a))};
function json2xml(a,b,f,g){var h="";a=="________"&&(h=' exml:fullname="'+Core.escape(a)+'"',a="________");var i=f?'<exml:anonymous xmlns:exml="http://www.agencexml.com/exml" xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance" xmlns:exsi="http://www.agencexml.com/exi" xmlns="">':"";if(b instanceof Array){g&&(i+='<exml:anonymous exsi:maxOccurs="unbounded">');if(b.length==0)i+="<"+(a==""?"exml:anonymous":a)+h+' exsi:maxOccurs="unbounded" xsi:nil="true"/>';else for(var h=0,j=b.length;h<j;h++)i+=json2xml(a==
""?"exml:anonymous":a,b[h],!1,!0);g&&(i+="</exml:anonymous>")}else{j="";switch(typeof b){case "number":j=' xsi:type="xsd:double"';break;case "boolean":j=' xsi:type="xsd:boolean"';break;case "object":b instanceof Date&&(j=' xsi:type="xsd:dateTime"')}i+=a==""?"":"<"+a+h+(g?' exsi:maxOccurs="unbounded"':"")+j+">";if(typeof b=="object"&&!(b instanceof Date))for(var k in b)i+=json2xml(k,b[k],!1,!1);else b instanceof Date?(i+=b.getFullYear()+"-",i+=(b.getMonth()<9?"0":"")+(b.getMonth()+1)+"-",i+=(b.getDate()<
10?"0":"")+b.getDate()+"T",i+=(b.getHours()<10?"0":"")+b.getHours()+":",i+=(b.getMinutes()<10?"0":"")+b.getMinutes()+":",i+=(b.getSeconds()<10?"0":"")+b.getSeconds()+"Z"):i+=Core.escape(b);i+=a==""?"":"</"+a+">"}i+=f?"</exml:anonymous>":"";return i}var jsoninstobj;function jsoninst(a){jsoninstobj.setDoc(json2xml("",a,!0,!1));xforms.addChange(jsoninstobj.model);XMLEvents.dispatch(jsoninstobj.model,"xforms-rebuild");xforms.refresh();document.body.removeChild(document.getElementById("jsoninst"))}
function XFBind(a,b,f,g,h,i,j,k,l){this.init(a,b,"xforms-bind");this.model=b.model||b;this.type=g?Schema.getType(g):null;this.nodeset=f;this.readonly=XPath.get(h);this.required=XPath.get(i);this.relevant=XPath.get(j);this.calculate=XPath.get(k);this.constraint=XPath.get(l);this.depsNodes=[];this.depsElements=[];this.nodes=[];this.binding=new Binding(!1,this.nodeset);b.addBind(this);this.depsId=XFElement.depsId++}XFBind.prototype=new XFCoreElement;XFBind.prototype.addBind=function(){};
XFBind.prototype.refresh=function(a,b){if(!b){for(var f=0,g=this.depsNodes.length;f<g;f++)Core.setFalseBoolMeta(this.depsNodes[f],"depfor_"+this.depsId);this.depsNodes.length=0;this.depsElements.length=0;this.nodes.length=0}a=a||(this.model?this.model.getInstanceDocument()?this.model.getInstanceDocument().documentElement:null:null);copyArray(this.binding.evaluate(a,this.depsNodes,this.depsId,this.depsElements),this.nodes);for(var h=this.element,f=0,g=this.nodes.length;f<g;f++){var i=this.nodes[f],
j=Core.getMeta(i,"bind");j?j.indexOf(" "+this.element.id+" ")==-1&&Core.setMeta(i,"bind",j+" "+this.element.id):Core.setMeta(i,"bind",this.element.id);if(this.type)if(Core.getMeta(i,"schemaType"))XFProcessor.error(h,"xforms-binding-exception","Type especified in xsi:type attribute");else{var j=this.type.name,k=this.type.nsuri,l;for(l in Schema.prefixes)if(Schema.prefixes[l]==k){j=l+":"+j;break}Core.setType(i,j)}j=0;for(k=h.childNodes.length;j<k;j++)h.childNodes[j].xfElement.refresh(i,f)}};
XFBind.prototype.recalculate=function(){var a=this.element;if(this.calculate)for(var b=0,f=this.nodes.length;b<f;b++){var g=this.nodes[b],h=new ExprContext(g,b+1,this.nodes),h=stringValue(this.calculate.evaluate(h)),h=Schema.getType(Core.getType(g)||"xsd_:string").normalize(h);setValue(g,h);this.model.addChange(g);DebugConsole.write("Calculate "+g.nodeName+" "+h)}b=0;for(f=a.childNodes.length;b<f;b++)a.childNodes[b].xfElement.recalculate()};
function XFSubmission(a,b,f,g,h,i,j,k,l,q,n,m,r,v,x,A,C,u,z,s){this.init(a,b,"xforms-submission");this.model=b;if(b.defaultSubmission==null)b.defaultSubmission=this;this.action=h;h.substr&&h.substr(0,7)=="file://"&&!document.applets.xsltforms&&Core.loadapplet();this.method=i;this.replace=r;this.version=j;this.indent=k;this.validate=C;this.synchr=u;this.show=z;this.serialization=s;if(l!=null){a=l.split(";");this.mediatype=a[0];h=1;for(i=a.length;h<i;h++)switch(j=a[h].split("="),j[0]){case "action":this.soapAction=
j[1];break;case "charset":this.charset=j[1]}}this.encoding=q||"UTF-8";this.omitXmlDeclaration=n;this.cdataSectionElements=m;this.instance=v;this.separator=x=="&amp;"?"&":x;this.includenamespaceprefixes=A;this.headers=[];f||g?(this.binding=new Binding(!1,f,b.element,g),this.eval_=function(){return this.binding.evaluate()[0]}):this.eval_=function(){return this.model.getInstanceDocument()}}XFSubmission.prototype=new XFCoreElement;
XFSubmission.prototype.header=function(a,b,f,g){this.headers.push({nodeset:a,combine:b,name:f,values:g});return this};
XFSubmission.prototype.submit=function(){xforms.openAction();var a=this.eval_(),b="error",b=this.action.evaluate?stringValue(this.action.evaluate()):this.action,f="post",f=this.method.evaluate?stringValue(this.method.evaluate()):this.method,g={method:f,"resource-uri":b};if(a){if(this.validate&&!validate_(a)){g["error-type"]="validation-error";this.issueSubmitException_(g,null,null);xforms.closeAction();return}if((f=="get"||f=="delete")&&this.serialization!="none"){var h=XFSubmission.toUrl_(a,this.separator);
b+=(b.indexOf("?")==-1?"?":this.separator)+h.substr(0,h.length-this.separator.length)}}XMLEvents.dispatch(this,"xforms-submit-serialize");h=a?Core.saveXML(a):"";if(b.substr(0,7)=="file://"){var i=this;f=="put"?(Core.writeFile(b.substr(7),i.encoding,"string","XSLTForms Java Saver",h)||XMLEvents.dispatch(i,"xforms-submit-error"),XMLEvents.dispatch(i,"xforms-submit-done")):f=="get"&&(h=Core.readFile(b.substr(7),i.encoding,"string","XSLTForms Java Loader"),h!=""&&i.replace=="instance"?((k==null?a?document.getElementById(Core.getMeta(a.documentElement?
a.documentElement:a.ownerDocument.documentElement,"instance")).xfElement:i.model.getInstance():document.getElementById(k).xfElement).setDoc(h,!1,!0),xforms.addChange(i.model),XMLEvents.dispatch(i.model,"xforms-rebuild"),xforms.refresh(),XMLEvents.dispatch(i,"xforms-submit-done")):XMLEvents.dispatch(i,"xforms-submit-error"));xforms.closeAction()}else{var j=this.synchr,k=this.instance;if(f=="xml-urlencoded-post"){if(f=document.getElementById("xsltforms_form"))f.firstChild.value=h;else{f=Core.isXhtml?
document.createElementNS("http://www.w3.org/1999/xhtml","form"):document.createElement("form");f.setAttribute("method","post");f.setAttribute("action",b);f.setAttribute("id","xsltforms_form");var l=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","input"):document.createElement("input");l.setAttribute("type","hidden");l.setAttribute("name","postdata");l.setAttribute("value",h);f.appendChild(l);l=Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body")[0]:
document.getElementsByTagName("body")[0];l.insertBefore(f,l.firstChild)}f.submit();xforms.closeAction()}else{var q=!1;if(b.match(/^[a-zA-Z0-9+.-]+:\/\//))var n=/^([a-zA-Z0-9+.-]+:\/\/[^\/]*)/,q=n.exec(b),n=n.exec(document.location.href),q=q[0]!=n[0];if(q)jsoninstobj=k==null?a?document.getElementById(Core.getMeta(a.documentElement?a.documentElement:a.ownerDocument.documentElement,"instance")).xfElement:this.model.getInstance():document.getElementById(k).xfElement,h=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml",
"script"):document.createElement("script"),h.setAttribute("src",b.replace(/&amp;/g,"&")+(b.indexOf("?")==-1?"?":"&")+"callback=jsoninst"),h.setAttribute("id","jsoninst"),h.setAttribute("type","text/javascript"),l=Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body")[0]:document.getElementsByTagName("body")[0],l.insertBefore(h,l.firstChild),XMLEvents.dispatch(this,"xforms-submit-done"),xforms.closeAction();else if(!a&&(f!="get"||f!="delete"))g["error-type"]="no-data",
this.issueSubmitException_(g,null,null);else{var m=null,i=this;try{m=Core.openRequest(f,b,!j);q=function(){if(j||m.readyState==4)try{if(m.status!=0&&(m.status<200||m.status>=300))g["error-type"]="resource-error",i.issueSubmitException_(g,m,null),xforms.closeAction();else if(i.replace=="instance"&&((k==null?a?document.getElementById(Core.getMeta(a.documentElement?a.documentElement:a.ownerDocument.documentElement,"instance")).xfElement:i.model.getInstance():document.getElementById(k).xfElement).setDoc(m.responseText,
!1,!0),xforms.addChange(i.model),XMLEvents.dispatch(i.model,"xforms-rebuild"),xforms.refresh()),i.requesteventlog(g,m),XMLEvents.dispatch(i,"xforms-submit-done",null,null,null,null,g),xforms.closeAction(),i.replace=="all"){for(var b=m.responseText,f=b.indexOf("<?xml-stylesheet",0);f!=-1;)var h=b.substr(f,b.substr(f).indexOf("?>")).replace(/^.*href=\"([^\"]*)\".*$/,"$1"),b=Core.transformText(b,h,!1),f=b.indexOf("<?xml-stylesheet",0);i.show=="new"?(w=window.open("about:blank","_blank"),w.document.write(b),
w.document.close()):(Dialog.hide("statusPanel",!1),xforms.close(),document.write?(document.write(b),document.close()):(b.indexOf("<?",0)===0&&(b=b.substr(b.indexOf("?>")+2)),document.documentElement.innerHTML=b))}}catch(l){DebugConsole.write(l||l.message),g["error-type"]="parse-error",i.issueSubmitException_(g,m,l),xforms.closeAction()}};if(!j)m.onreadystatechange=q;var l=this.mediatype,r=(l||"application/xml")+(this.charset?";charset="+this.charset:"");DebugConsole.write("Submit "+this.method+" - "+
r+" - "+b+" - "+j);var v=this.headers.length;if(v!=0){b=[];n=0;for(v=this.headers.length;n<v;n++)for(var x=[],x=this.headers[n].nodeset?this.headers[n].nodeset.evaluate():[i.model.getInstanceDocument().documentElement],A,C=0,u=x.length;C<u;C++)if(A=this.headers[n].name.evaluate?stringValue(this.headers[n].name.evaluate(x[C])):this.headers[n].name,A!=""){var z="",s;s=0;for(len2=this.headers[n].values.length;s<len2;s++){var t=this.headers[n].values[s],B;B=t.evaluate?stringValue(t.evaluate(x[C])):t;
z+=B;s<len2-1&&(z+=",")}var E=b.length;for(s=0;s<E;s++)if(b[s].name==A){switch(this.headers[n].combine){case "prepend":b[s].value=z+","+b[s].value;break;case "replace":b[s].value=z;break;default:b[s].value+=","+z}break}s==E&&b.push({name:A,value:z})}n=0;for(v=b.length;n<v;n++)m.setRequestHeader(b[n].name,b[n].value)}f=="get"||f=="delete"?(l==XFSubmission.SOAP_?m.setRequestHeader("Accept",r):i.replace=="instance"&&m.setRequestHeader("Accept","application/xml,text/xml"),m.send(null)):(m.setRequestHeader("Content-Type",
r),l==XFSubmission.SOAP_?m.setRequestHeader("SOAPAction",this.soapAction):i.replace=="instance"&&m.setRequestHeader("Accept","application/xml,text/xml"),m.send(h));j&&q()}catch(D){DebugConsole.write(D.message||D),g["error-type"]="resource-error",i.issueSubmitException_(g,m,D),xforms.closeAction()}}}}};XFSubmission.SOAP_="application/soap+xml";
XFSubmission.prototype.requesteventlog=function(a,b){a["response-status-code"]=b.status;a["response-reason-phrase"]=b.statusText;var f=b.getAllResponseHeaders().replace(/\r/,""),g="";if(f)for(var f=f.split("\n"),h=0,i=f.length;h<i;h++){var j=f[h].indexOf(":");if(j!=-1){var k=f[h].substring(0,j).replace(/^\s+|\s+$/,""),j=f[h].substring(j+1).replace(/^\s+|\s+$/,"");g+="<header><name>"+Core.escape(k)+"</name><value>"+Core.escape(j)+"</value></header>"}}a.rheadsdoc=Core.createXMLDocument("<data>"+g+"</data>");
if(a.rheadsdoc.documentElement.firstChild){f=a.rheadsdoc.documentElement.firstChild;for(a["response-headers"]=[f];f.nextSibling;)f=f.nextSibling,a["response-headers"].push(f)}a["response-body"]=b.responseXML?[Core.createXMLDocument(b.responseText)]:b.responseText||""};XFSubmission.prototype.issueSubmitException_=function(a,b,f){if(f)a.message=f.message||f,a["stack-trace"]=f.stack;b&&this.requesteventlog(a,b);XMLEvents.dispatch(this,"xforms-submit-error",null,null,null,null,a)};
XFSubmission.toUrl_=function(a,b){for(var f="",g="",h=!1,i=0,j=a.childNodes.length;i<j;i++){var k=a.childNodes[i];switch(k.nodeType){case NodeType.ELEMENT:h=!0;f+=this.toUrl_(k,b);break;case NodeType.TEXT:g+=k.nodeValue}}!h&&g.length>0&&(f+=a.nodeName+"="+encodeURIComponent(g)+b);return f};var XFProcessor={error:function(a,b,f){alert(b+": "+f)}};function AJXTimer(a,b){this.init(a,null,"xforms-timer");this.running=!1;this.time=b}AJXTimer.prototype=new XFCoreElement;
AJXTimer.prototype.start=function(){this.running=!0;var a=this;setTimeout(function(){a.run()},this.time)};AJXTimer.prototype.stop=function(){this.running=!1};AJXTimer.prototype.run=function(){if(this.running){var a=this;xforms.openAction();XMLEvents.dispatch(a.element,"ajx-time");xforms.closeAction();setTimeout(function(){a.run()},this.time)}};function AJXConfirm(a,b,f,g){this.id=a;this.binding=b;this.init(f,g)}AJXConfirm.prototype=new XFAbstractAction;
AJXConfirm.prototype.run=function(a,b,f){var g;this.binding?(b=this.binding.evaluate(b)[0])&&(g=getValue(b)):(g=IdManager.find(this.id),xforms.build(g,b),g=g.textContent||g.innerText);if(g&&!confirm(g.trim()))f.stopPropagation(),f.stopped=!0};function AJXSetproperty(a,b,f,g,h){this.name=a;this.value=b;this.literal=f;this.init(g,h)}AJXSetproperty.prototype=new XFAbstractAction;
AJXSetproperty.prototype.run=function(){var a=this.literal;this.value&&(a=this.value.evaluate(node),typeof a!="string"&&typeof a.length!="undefined"&&(a=a.length>0?getValue(a[0]):""));if(a)I8N.lang=a,DebugConsole.write("setproperty "+name+" = "+a)};function XFAbstractAction(){}XFAbstractAction.prototype.init=function(a,b){this.ifexpr=XPath.get(a);this.whileexpr=XPath.get(b)};
XFAbstractAction.prototype.execute=function(a,b,f){if(!f.stopped)if(b||(b=a.node||(xforms.defaultModel.getInstanceDocument()?xforms.defaultModel.getInstanceDocument().documentElement:null)),this.whileexpr)for(;booleanValue(this.whileexpr.evaluate(b));){if(!this.exec_(a,b,f))break}else this.exec_(a,b,f)};XFAbstractAction.prototype.exec_=function(a,b,f){if(this.ifexpr)if(booleanValue(this.ifexpr.evaluate(b)))this.run(a,b,f);else return!1;else this.run(a,b,f);return!0};
XFAbstractAction.prototype.run=function(){};function XFAction(a,b){this.init(a,b);this.childs=[]}XFAction.prototype=new XFAbstractAction;XFAction.prototype.add=function(a){this.childs.push(a);return this};XFAction.prototype.run=function(a,b,f){forEach(this.childs,"execute",a,b,f)};function XFDelete(a,b,f,g,h,i,j){this.binding=new Binding(!1,a,b,f);this.at=XPath.get(g);this.context=XPath.get(h);this.init(i,j)}XFDelete.prototype=new XFAbstractAction;
XFDelete.prototype.run=function(a,b){this.context&&(b=this.context.evaluate(b)[0]);if(b){var f=this.binding.evaluate(b);if(this.at){var g=numberValue(this.at.evaluate(new ExprContext(b,1,f)));if(!f[g-1])return;f=[f[g-1]]}var h,i;if(f.length>0)h=document.getElementById(Core.getMeta(f[0].documentElement?f[0].documentElement:f[0].ownerDocument.documentElement,"model")).xfElement,i=h.findInstance(f[0]);for(var g=0,j=f.length;g<j;g++){var k=f[g],l=Core.getMeta(k,"repeat");k.nodeType==NodeType.ATTRIBUTE?
k.ownerElement?k.ownerElement.removeAttributeNS(k.namespaceURI,k.nodeName):k.selectSingleNode("..").removeAttributeNS(k.namespaceURI,k.nodeName):k.parentNode.removeChild(k);l&&document.getElementById(l).xfElement.deleteNode(k)}f.length>0&&(xforms.addChange(h),h.setRebuilded(!0),XMLEvents.dispatch(i,"xforms-delete"))}};function XFDispatch(a,b,f,g,h){this.name=a;this.target=b;this.init(f,g);this.delay=h}XFDispatch.prototype=new XFAbstractAction;
XFDispatch.prototype.run=function(a,b){var f;if(this.target==null)switch(this.name){case "xforms-submit":f=document.getElementById(Core.getMeta(b.ownerDocument.documentElement,"model")).xfElement.defaultSubmission;break;case "xforms-reset":f=document.getElementById(Core.getMeta(b.ownerDocument.documentElement,"model")).xfElement}else f=typeof this.target=="string"?document.getElementById(this.target):this.target;var g=0;this.delay&&(g=this.delay.evaluate?numberValue(this.delay.evaluate()):numberValue(this.delay));
g>0?window.setTimeout("XMLEvents.dispatch(document.getElementById('"+f.id+"'),'"+this.name+"')",g):XMLEvents.dispatch(f,this.name)};function XFInsert(a,b,f,g,h,i,j,k,l){this.binding=new Binding(!1,a,b,f);this.origin=XPath.get(i);this.context=XPath.get(j);this.at=XPath.get(g);this.position=h;this.init(k,l)}XFInsert.prototype=new XFAbstractAction;
XFInsert.prototype.run=function(a,b){this.context&&(b=this.context.evaluate(b)[0]);if(b){var f=[];if(this.binding.bind||this.binding.xpath)f=this.binding.evaluate(b);var g=0,h=null,i=[],j=null,k=this.position=="after"?1:0,l=0;this.origin&&(i=this.origin.evaluate(b));if(i.length===0){if(f.length===0)return;i.push(f[f.length-1])}for(var q=0,n=i.length;q<n;q+=1)if(h=i[q],f.length===0?j=b:(j=f[0].nodeType==NodeType.DOCUMENT?f[0]:f[0].nodeType==NodeType.ATTRIBUTE?f[0].ownerDocument?f[0].ownerDocument:
f[0].selectSingleNode(".."):f[0].parentNode,j.nodeType!=NodeType.DOCUMENT&&h.nodeType!=NodeType.ATTRIBUTE&&(l=this.at?Math.round(numberValue(this.at.evaluate(new ExprContext(b,1,f))))+q-1:f.length-1,g=isNaN(l)?f.length:l+k)),DebugConsole.write("insert "+h.nodeName+" in "+j.nodeName+" at "+g+" - "+b.nodeName),h.nodeType==NodeType.ATTRIBUTE)Core.setAttributeNS(j,h.namespaceURI,(h.prefix?h.prefix+":":"")+h.nodeName,h.nodeValue);else if(h=h.cloneNode(!0),j.nodeType==NodeType.DOCUMENT){var l=j.documentElement,
m=Core.getMeta(l,"model"),r=Core.getMeta(l,"instance");j.removeChild(l);Core.setMeta(h,"instance",r);Core.setMeta(h,"model",m);j.appendChild(h)}else(l=g>=f.length&&f.length!=0?f[f.length-1].nextSibling:f[g])?l.parentNode.insertBefore(h,l):j.appendChild(h),m=f.length>0?Core.getMeta(f[0],"repeat"):null,f.push(h),m&&document.getElementById(m).xfElement.insertNode(h,l);f=document.getElementById(Core.getMeta(j.documentElement?j.documentElement:j.ownerDocument.documentElement,"model")).xfElement;xforms.addChange(f);
f.setRebuilded(!0);XMLEvents.dispatch(f.findInstance(j),"xforms-insert")}};function XFLoad(a,b,f,g,h){this.binding=a;this.resource=b;this.show=f;this.init(g,h)}XFLoad.prototype=new XFAbstractAction;
XFLoad.prototype.run=function(a,b){var f=this.resource;if(this.binding){var g=this.binding.evaluate(b)[0];g&&(f=getValue(g))}else typeof f=="object"?f=stringValue(this.resource.xpath.evaluate(b)):typeof f=="string"&&(f=Core.unescape(f));if(f)if(f.substr(0,11)=="javascript:")try{eval('{XSLTFormsContext={elementId:"'+a.getAttribute("id")+'"};'+f.substr(11)+"}")}catch(h){alert("XSLTForms Exception\n--------------------------\n\nError evaluating the following Javascript expression :\n\n"+f.substr(11)+
"\n\n"+h)}else this.show=="new"?window.open(f):location.href=f};function XFMessage(a,b,f,g,h){this.binding=b;this.id=a;this.level=f;this.init(g,h)}XFMessage.prototype=new XFAbstractAction;XFMessage.prototype.run=function(a,b){var f;if(this.binding){var g=this.binding.evaluate(b)[0];g&&(f=getValue(g))}else f=IdManager.find(this.id),g=xforms.building,xforms.building=!0,xforms.build(f,b),xforms.building=g,f=f.textContent||f.innerText;f&&alert(f.trim())};
function XFScript(a,b,f,g,h){this.binding=a;this.stype=b;this.script=f;this.init(g,h)}XFScript.prototype=new XFAbstractAction;
XFScript.prototype.run=function(a,b){var f=this.script;switch(this.stype){case "text/javascript":if(this.binding){var g=this.binding.evaluate(b)[0];g&&(f=getValue(g))}else typeof f=="object"?f=stringValue(this.script.xpath.evaluate(b)):typeof f=="string"&&(f=Core.unescape(f));if(f)try{eval('{XSLTFormsContext={elementId:"'+a.getAttribute("id")+'"};'+f+"}")}catch(h){alert("XSLTForms Exception\n--------------------------\n\nError evaluating the following Javascript expression :\n\n"+f+"\n\n"+h)}break;
case "application/xquery":this.script.xpath.evaluate(b)}};function XFSetindex(a,b,f,g){this.repeat=a;this.index=XPath.get(b);this.init(f,g)}XFSetindex.prototype=new XFAbstractAction;XFSetindex.prototype.run=function(a,b){var f=IdManager.find(this.repeat),g=numberValue(this.index.evaluate(b));DebugConsole.write("setIndex "+g);isNaN(g)||f.xfElement.setIndex(g)};function XFSetvalue(a,b,f,g,h){this.binding=a;this.value=b?XPath.get(b):null;this.literal=f;this.init(g,h)}XFSetvalue.prototype=new XFAbstractAction;
XFSetvalue.prototype.run=function(a,b){var f=this.binding.evaluate(b)[0];if(f){var g=this.value?stringValue(this.value.evaluate(f,b)):this.literal;xforms.openAction();setValue(f,g||"");document.getElementById(Core.getMeta(f.ownerDocument.documentElement,"model")).xfElement.addChange(f);DebugConsole.write("Setvalue "+f.nodeName+" = "+g);xforms.closeAction()}};function XFToggle(a,b,f){this.caseId=a;this.init(b,f)}XFToggle.prototype=new XFAbstractAction;
XFToggle.prototype.run=function(a,b){XFToggle.toggle(this.caseId,b)};
XFToggle.toggle=function(a,b){xforms.openAction();typeof a=="object"&&(b||(b=xforms.defaultModel.getInstanceDocument()?xforms.defaultModel.getInstanceDocument().documentElement:null),a=stringValue(a.xpath.evaluate(b)));var f=IdManager.find(a),g=f.parentNode.childNodes,h,i=-1;g.length>0&&g[0].nodeName.toLowerCase()=="ul"&&(h=g[0]);for(var j=h!=null?1:0,k=g.length;j<k;j++){var l=g[j];if(l==f)i=j-1;else{if(l.style&&l.style.display!="none")l.style.display="none",h!=null&&Core.setClass(h.childNodes[j-
1],"ajx-tab-selected",!1);XMLEvents.dispatch(l,"xforms-deselect")}}if(f.style.display=="none")f.style.display="block",h!=null&&Core.setClass(h.childNodes[i],"ajx-tab-selected",!0);XMLEvents.dispatch(f,"xforms-select");xforms.closeAction()};function AJXTree(a,b){this.init(a);this.binding=b;this.hasBinding=!0;this.root=Core.isXhtml?this.element.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","ul")[0]:this.element.getElementsByTagName("ul")[0];this.label=this.root.firstChild.cloneNode(!0)}
AJXTree.prototype=new XFElement;AJXTree.prototype.dispose=function(){this.selected=this.root=null;XFElement.prototype.dispose.call(this)};AJXTree.prototype.build_=function(a){if(a=this.evaluateBinding(this.binding,a)[0]){var b=[];this.buildTree(this.root,0,a,b);(!this.selected||!inArray(this.selected,b))&&this.select(this.root.firstChild)}};
AJXTree.prototype.select=function(a){var b=!0;this.selected&&(this.selected==a?b=!1:(Core.setClass(this.selected,"xforms-tree-item-selected",!1),Core.setClass(this.selected.childNodes[1],"xforms-tree-item-label-selected",!1)));if(b)this.element.node=a.node,this.selected=a,Core.setClass(a,"xforms-tree-item-selected",!0),Core.setClass(a.childNodes[1],"xforms-tree-item-label-selected",!0),xforms.openAction(),xforms.addChange(this),xforms.addChange(document.getElementById(Core.getMeta(a.node.ownerDocument.documentElement,
"model")).xfElement),xforms.closeAction()};AJXTree.prototype.click=function(a){if(a.className=="xforms-tree-item-button"){if(a=a.nextSibling.nextSibling,a!=null)a.style.display=a.style.display!="none"?"none":"block"}else Core.hasClass(a,"xforms-tree-item-label")&&this.select(a.parentNode)};
AJXTree.prototype.buildTree=function(a,b,f,g){var h=null,i=null,j=f.childNodes,k=j.length===0;g.push(f);a.childNodes.length<b+1?(h=this.label.cloneNode(!0),a.appendChild(h),XFRepeat.initClone(h)):(h=a.childNodes[b],a=h.lastChild,a.nodeName.toLowerCase()=="ul"&&(i=a,k&&(xforms.dispose(i),h.removeChild(i))));h.node=f;Core.setClass(h,"xforms-tree-item-fork",!k);Core.setClass(h,"xforms-tree-item-leaf",k);f=0;for(k=j.length;f<k;f++)a=j[f],a.nodeType==NodeType.ELEMENT&&(i||(i=Core.createElement("ul",h)),
this.buildTree(i,f,a,g));if(i){g=i.childNodes.length;for(j=j.length;g>j;g--)xforms.dispose(i.lastChild),i.removeChild(i.lastChild)}};AJXTree.prototype.refresh=function(){};function XFAVT(a,b){this.init(a);this.attrs=b;this.bindings=[];for(var f=0,g=b.length;f<g;f++);this.isOutput=this.hasBinding=!0}XFAVT.prototype=new XFControl;XFAVT.prototype.clone=function(a){return new XFAVT(a,this.attrs)};XFAVT.prototype.dispose=function(){this.attrs=null;XFControl.prototype.dispose.call(this)};
XFAVT.prototype.setValue=function(a){var b=this.valueElement;if(b.nodeName.toLowerCase()=="span")if(this.mediatype=="application/xhtml+xml"){for(;b.firstChild;)b.removeChild(b.firstChild);XDocument.parse(a,b)}else setValue(b,a);else b.src=a};function XFElement(){}XFElement.depsId=0;
XFElement.prototype.init=function(a){this.element=document.getElementById(a);this.element.xfElement=this;this.depsElements=[];this.depsNodesBuild=[];this.depsNodesRefresh=[];this.depsIdB=XFElement.depsId++;this.depsIdR=XFElement.depsId++};
XFElement.prototype.dispose=function(){if(this.element)this.element=this.element.xfElement=null;this.depsElements=null;if(this.depsNodesBuild)for(var a=0,b=this.depsNodesBuild.length;a<b;a++)Core.setFalseBoolMeta(this.depsNodesBuild[a],"depfor_"+this.depsIdB);this.depsNodesBuild=null;if(this.depsNodesRefresh){a=0;for(b=this.depsNodesRefresh.length;a<b;a++)Core.setFalseBoolMeta(this.depsNodesRefresh[a],"depfor_"+this.depsIdR)}this.depsNodesRefresh=null};
XFElement.prototype.build=function(a){if(this.hasBinding){for(var b=this.depsElements,f=this.depsNodesBuild,g=this.depsNodesRefresh,h=!xforms.ready||b.length===0||a!=this.ctx,i=!1,j=xforms.changes,k=0,l=f.length;!h&&k<l;k++)h=f[k].nodeName=="";k=0;for(l=b.length;!h&&k<l;k++)for(var q=b[k],n=0,m=j.length;!h&&n<m;n++)if(q==j[n])if(q.instances)if(q.rebuilded||q.newRebuilded)h=!0;else{for(var r=0,v=f.length;!h&&r<v;r++)h=inArray(f[r],q.nodesChanged);if(!h){r=0;for(v=g.length;r<v;r++)i=inArray(g[r],q.nodesChanged)}}else h=
!0;this.changed=h||i;if(h){k=0;for(l=f.length;k<l;k++)Core.setFalseBoolMeta(f[k],"depfor_"+this.depsIdB);k=f.length=0;for(l=g.length;k<l;k++)Core.setFalseBoolMeta(g[k],"depfor_"+this.depsIdR);g.length=0;b.length=0;this.ctx=a;this.build_(a)}}else this.element.node=a};
XFElement.prototype.evaluateBinding=function(a,b){var f=null,g=null;if(a){f=a.evaluate(b,this.depsNodesBuild,this.depsIdB,this.depsElements);if(f!=null)return f;g="non-existent bind-ID("+a.bind+") on element("+this.element.id+")!"}else g="no binding defined for element("+this.element.id+")!";assert(g);xforms.building&&xforms.debugMode?(xforms.bindErrMsgs.push(g),XMLEvents.dispatch(this.element,"xforms-binding-exception"),f=[]):xforms.error(this.element,"xforms-binding-exception",g);return f};
function XFControl(){this.isControl=!0}XFControl.prototype=new XFElement;XFControl.prototype.initFocus=function(a,b){if(b)this.focusControl=a;XSLTFormsEvent.attach(a,"focus",XFControl.focusHandler);XSLTFormsEvent.attach(a,"blur",XFControl.blurHandler)};XFControl.prototype.dispose=function(){this.focusControl=null;XFElement.prototype.dispose.call(this)};
XFControl.prototype.focus=function(a){if(!this.isOutput){if(xforms.focus!=this){xforms.openAction();xforms.blur(!0);xforms.focus=this;Core.setClass(this.element,"xforms-focus",!0);Core.setClass(this.element,"xforms-disabled",!1);for(var b=this.element.parentNode;b.nodeType==NodeType.ELEMENT;)typeof b.node!="undefined"&&Core.hasClass(b,"xforms-repeat-item")&&XFRepeat.selectItem(b),b=b.parentNode;XMLEvents.dispatch(xforms.focus,"DOMFocusIn");xforms.closeAction();this.full&&!a&&this.focusFirst()}b=this.focusControl;
xforms.posibleBlur=!1;if(b&&!a)a=this.focusControl,b=a.nodeName.toLowerCase(),a.focus(),a.focus(),(b=="input"||b=="textarea")&&a.select()}};XFControl.prototype.build_=function(a){a=this.evaluateBinding(this.binding,a);if(typeof a=="object"){var a=a[0],b=this.element;if(b.node!=a||!xforms.ready)b.node=a,this.nodeChanged=!0;a&&this.depsNodesRefresh.push(a)}else this.outputValue=a};
XFControl.prototype.refresh=function(){var a=this.element,b=a.node;if(b){var f=getValue(b,!0,this.complex);xforms.openAction();var g=f!=this.currentValue||this.nodeChanged;this.relevant&&Core.setClass(a,"xforms-disabled",!1);this.changeProp(b,"required","xforms-required","xforms-optional",g,f);this.changeProp(b,"notrelevant","xforms-disabled","xforms-enabled",g,f);this.changeProp(b,"readonly","xforms-readonly","xforms-readwrite",g,f);this.changeProp(b,"notvalid","xforms-invalid","xforms-valid",g,
f);if(g)this.currentValue=f,this.setValue(f),!this.nodeChanged&&!this.isTrigger&&XMLEvents.dispatch(a,"xforms-value-changed");xforms.closeAction()}else this.outputValue!=null?(this.setValue(this.outputValue),Core.setClass(a,"xforms-disabled",!1)):Core.setClass(a,"xforms-disabled",!this.hasValue);this.nodeChanged=!1};
XFControl.prototype.changeProp=function(a,b,f,g,h,i){a=Core.getMeta(a,b);if(h||a!=this[b])!this.nodeChanged&&!this.isTrigger&&XMLEvents.dispatch(this.element,a?f:g),this[b]=a,b=="notvalid"&&i==""&&(a=!1),Core.setClass(this.element,f,a),Core.setClass(this.element,g,!a),b=="readonly"&&this.changeReadonly&&this.changeReadonly()};
XFControl.prototype.valueChanged=function(a){var b=this.element.node,f=document.getElementById(Core.getMeta(b.ownerDocument.documentElement,"model")).xfElement,g=Schema.getType(Core.getType(b)||"xsd_:string");if(a!=null&&a.length>0&&g.parse)try{a=g.parse(a)}catch(h){}a!=getValue(b)&&(xforms.openAction(),setValue(b,a),f.addChange(b),xforms.closeAction())};XFControl.getXFElement=function(a){for(var b=null;!b&&a;)(b=a.xfElement)&&!b.isControl&&(b=null),a=a.parentNode;return b};
XFControl.focusHandler=function(){var a=XFControl.getXFElement(this);xforms.focus!=a?a.focus(!0):xforms.posibleBlur=!1};XFControl.blurHandler=function(){if(XFControl.getXFElement(this)==xforms.focus)xforms.posibleBlur=!0,setTimeout("xforms.blur()",200)};function XFGroup(a,b){this.init(a);b?(this.hasBinding=!0,this.binding=b):Core.setClass(this.element,"xforms-disabled",!1)}XFGroup.prototype=new XFElement;XFGroup.prototype.clone=function(a){return new XFGroup(a,this.binding)};
XFGroup.prototype.build_=function(a){a=this.evaluateBinding(this.binding,a);this.element.node=a[0];this.depsNodesRefresh.push(a[0])};XFGroup.prototype.refresh=function(){var a=this.element,b=!a.node||Core.getBoolMeta(a.node,"notrelevant");Core.setClass(a,"xforms-disabled",b);var f=a.parentNode.firstChild;if(f.nodeName.toLowerCase()=="ul"){for(var g=a.parentNode.childNodes,h,i=1,j=g.length;i<j;i++)g[i]==a&&(h=f.childNodes[i-1]);Core.setClass(h,"xforms-disabled",b)}};
function XFInput(a,b,f,g,h,i,j,k){this.init(a);this.binding=f;this.inputmode=typeof g=="string"?XFInput.InputMode[g]:g;this.incremental=h;this.delay=i;this.timer=null;a=this.element.firstChild.firstChild.childNodes;this.cell=a[a.length-2];this.isClone=k;this.hasBinding=!0;this.itype=b;for(this.bolAidButton=j;this.cell.firstChild.nodeType==NodeType.TEXT;this.cell.removeChild(this.cell.firstChild));this.initFocus(this.cell.firstChild,!0);if(j)this.aidButton=a[a.length-1].firstChild,this.initFocus(this.aidButton)}
XFInput.prototype=new XFControl;XFInput.prototype.clone=function(a){return new XFInput(a,this.itype,this.binding,this.inputmode,this.incremental,this.delay,this.bolAidButton,!0)};XFInput.prototype.dispose=function(){this.calendarButton=this.cell=null;XFControl.prototype.dispose.call(this)};
XFInput.prototype.initInput=function(a){var b=this.cell,f=b.firstChild,g=a["class"];if(f.type=="password")this.type=Schema.getType("xsd_:string"),this.initEvents(f,!0);else if(f.nodeName.toLowerCase()=="textarea")this.type=Schema.getType("xsd_:string"),this.initEvents(f,!1);else if(a!=this.type){this.type=a;if(g=="boolean"||this.itype!=f.type)for(;b.firstChild;b.removeChild(b.firstChild));else for(var h=b.childNodes.length-1;h>=1;h--)b.removeChild(b.childNodes[h]);if(g=="boolean")f=Core.createElement("input"),
f.type="checkbox",b.appendChild(f);else{this.itype!=f.type&&(f=Core.createElement("input",b,null,"xforms-value"));this.initEvents(f,this.itype=="text");if(g=="date"||g=="datetime")this.calendarButton=Core.createElement("button",b,"...","aid-button"),this.initFocus(this.calendarButton);else if(g=="number")f.style.textAlign="right";(b=a.getMaxLength())?f.maxLength=b:f.removeAttribute("maxLength");(a=a.getDisplayLength())?f.size=a:f.removeAttribute("size")}}this.initFocus(f,!0);this.input=f};
XFInput.prototype.setValue=function(a){var b=this.element.node,b=b?Schema.getType(Core.getType(b)||"xsd_:string"):Schema.getType("xsd_:string");if(!this.input||b!=this.type)this.initInput(b),this.changeReadonly();if(b["class"]=="boolean")this.input.checked=a=="true";else if(this.input.value!=a)this.input.value=a||""};XFInput.prototype.changeReadonly=function(){if(this.input&&(this.input.readOnly=this.readonly,this.calendarButton))this.calendarButton.style.display=this.readonly?"none":""};
XFInput.prototype.initEvents=function(a,b){this.inputmode&&XSLTFormsEvent.attach(a,"keyup",XFInput.keyUpInputMode);b?this.incremental?XSLTFormsEvent.attach(a,"keyup",XFInput.keyUpIncrementalActivate):XSLTFormsEvent.attach(a,"keyup",XFInput.keyUpActivate):this.incremental&&XSLTFormsEvent.attach(a,"keyup",XFInput.keyUpIncremental)};
XFInput.prototype.blur=function(){xforms.focus=null;var a=this.input;if(this.incremental){var b=this.element.node,f=a.value;if(f!=null&&f.length>0&&Schema.getType(Core.getType(b)||"xsd_:string").format)try{a.value=getValue(b,!0)}catch(g){}if(this.timer)window.clearTimeout(this.timer),this.timer=null}else{assert(a,this.element.id);var f=a.type=="checkbox"?a.checked?"true":"false":a.value;this.valueChanged(f)}};
XFInput.prototype.click=function(a){a==this.aidButton?(xforms.openAction(),XMLEvents.dispatch(this,"ajx-aid"),xforms.closeAction()):a==this.input&&this.type["class"]=="boolean"?(xforms.openAction(),this.valueChanged(a.checked?"true":"false"),XMLEvents.dispatch(this,"DOMActivate"),xforms.closeAction()):a==this.calendarButton&&Calendar.show(a.previousSibling,this.type["class"]=="datetime"?Calendar.SECONDS:Calendar.ONLY_DATE)};XFInput.keyUpInputMode=function(){this.value=XFControl.getXFElement(this).inputmode(this.value)};
XFInput.keyUpActivate=function(a){var b=XFControl.getXFElement(this);a.keyCode==13&&(xforms.openAction(),b.valueChanged(this.value||""),XMLEvents.dispatch(b,"DOMActivate"),xforms.closeAction())};
XFInput.keyUpIncrementalActivate=function(a){var b=XFControl.getXFElement(this);a.keyCode==13?(xforms.openAction(),b.valueChanged(this.value||""),XMLEvents.dispatch(b,"DOMActivate"),xforms.closeAction()):b.delay&&b.delay>0?(b.timer&&window.clearTimeout(b.timer),b.timer=window.setTimeout("xforms.openAction();document.getElementById('"+b.element.id+"').xfElement.valueChanged('"+(this.value.addslashes()||"")+"');xforms.closeAction();",b.delay)):(xforms.openAction(),b.valueChanged(this.value||""),xforms.closeAction())};
XFInput.keyUpIncremental=function(){var a=XFControl.getXFElement(this);a.delay&&a.delay>0?(a.timer&&window.clearTimeout(a.timer),a.timer=window.setTimeout("xforms.openAction();document.getElementById('"+a.element.id+"').xfElement.valueChanged('"+(this.value.addslashes()||"")+"');xforms.closeAction();",a.delay)):(xforms.openAction(),a.valueChanged(this.value||""),xforms.closeAction())};
XFInput.InputMode={lowerCase:function(a){return a.toLowerCase()},upperCase:function(a){return a.toUpperCase()},titleCase:function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()},digits:function(a){if(/^[0-9]*$/.exec(a)!=null)return a;else{alert("Character not valid");for(var b="",f=0,g=a.length;f<g;f++)"1234567890".indexOf(a.charAt(f))!=-1&&(b+=a.charAt(f));return b}}};
function XFItem(a,b,f){this.init(a);b||f?(this.hasBinding=!0,this.bindingL=b,this.bindingV=f):Core.setClass(this.element,"xforms-disabled",!1);a=this.element;if(a.nodeName.toLowerCase()!="option")this.input=Core.isXhtml?a.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","input")[0]:a.getElementsByTagName("input")[0],this.input.name=XFControl.getXFElement(this.element).element.id,XSLTFormsEvent.attach(this.input,"focus",XFControl.focusHandler),XSLTFormsEvent.attach(this.input,"blur",XFControl.blurHandler),
this.label=Core.isXhtml?a.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","span")[0]:a.getElementsByTagName("span")[0]}XFItem.prototype=new XFElement;XFItem.prototype.clone=function(a){return new XFItem(a,this.bindingL,this.bindingV)};XFItem.prototype.dispose=function(){this.label=this.input=null;XFElement.prototype.dispose.call(this)};
XFItem.prototype.build_=function(a){var b=this.element,f=b.parentNode.xfElement;f&&f.isRepeat?a=b.node:b.node=a;if(this.bindingL)b.nodeL=this.evaluateBinding(this.bindingL,a)[0],this.depsNodesRefresh.push(b.nodeL);if(this.bindingV)b.nodeV=this.evaluateBinding(this.bindingV,a)[0],this.depsNodesRefresh.push(b.nodeV)};
XFItem.prototype.refresh=function(){var a=this.element;if(a.nodeName.toLowerCase()=="option"){if(a.nodeL)try{a.text=getValue(a.nodeL,!0)}catch(b){}if(a.nodeV)try{a.value=getValue(a.nodeV)}catch(f){}}else if(a.nodeL&&setValue(this.label,getValue(a.nodeL,!0)),a.nodeV)this.input.value=getValue(a.nodeV)};XFItem.prototype.click=function(a){var b=this.input;if(b){var f=XFControl.getXFElement(this.element);!f.element.node.readonly&&a==b&&f.itemClick(b.value)}};
function XFItemset(a,b,f,g){this.init(a);this.nodesetBinding=b;this.labelBinding=f;this.valueBinding=g;this.hasBinding=!0}XFItemset.prototype=new XFElement;
XFItemset.prototype.build_=function(a){if(!this.element.getAttribute("cloned")){this.nodes=this.evaluateBinding(this.nodesetBinding,a);for(var b=this.element,a=b.parentNode,f=this.nodes.length,g=b,h=b.listeners,i=1;;)if((b=b.nextSibling)&&b.getAttribute("cloned"))i>=f?(b.listeners=null,a.removeChild(b),b=g):(b.node=this.nodes[i],this.refresh_(b,i++),g=b);else{for(b=i;b<f;b++)if(g=this.element.cloneNode(!0),g.setAttribute("cloned","true"),IdManager.cloneId(g),g.node=this.nodes[b],a.appendChild(g),
this.refresh_(g,b),h&&!Core.isIE)for(var i=0,j=h.length;i<j;i++)h[i].clone(g);break}f>0?(this.element.node=this.nodes[0],this.refresh_(this.element,0)):(this.element.value="\u00a0",this.element.text="\u00a0")}};XFItemset.prototype.refresh=function(){var a=this.element.parentNode,b;for(b=0;a.childNodes[b]!=this.element;b++);for(var f=0,g=this.nodes.length;f<g||f==0;f++)Core.setClass(a.childNodes[b+f],"xforms-disabled",this.nodes.length===0)};
XFItemset.prototype.clone=function(a){return new XFItemset(a,this.nodesetBinding,this.labelBinding,this.valueBinding)};XFItemset.prototype.refresh_=function(a,b){var f=this.nodes[b],g=this.evaluateBinding(this.labelBinding,f)[0],f=this.evaluateBinding(this.valueBinding,f)[0];if(g){this.depsNodesRefresh.push(g);try{a.text=getValue(g,!0)}catch(h){}}if(f){this.depsNodesRefresh.push(f);try{a.value=getValue(f)}catch(i){}}};function XFLabel(a,b){this.init(a);if(b)this.hasBinding=!0,this.binding=b}
XFLabel.prototype=new XFElement;XFLabel.prototype.clone=function(a){return new XFLabel(a,this.binding)};XFLabel.prototype.build_=function(a){a=this.evaluateBinding(this.binding,a);this.element.node=a[0];this.depsNodesRefresh.push(a[0])};XFLabel.prototype.refresh=function(){var a=this.element.node,a=a?getValue(a,!0):"";setValue(this.element,a)};
function XFOutput(a,b,f){this.init(a);this.element.firstChild.firstChild?(a=this.element.firstChild.firstChild.childNodes,this.valueElement=a[a.length-2]):this.valueElement=this.element;for(var a=0,g=this.valueElement.childNodes.length;a<g;a++)if(this.valueElement.childNodes[a].nodeType!=NodeType.TEXT){this.valueElement=this.valueElement.childNodes[a];break}this.hasBinding=!0;this.binding=b;this.mediatype=f;this.complex=f=="application/xhtml+xml";this.isOutput=!0;this.binding&&this.binding.isvalue&&
Core.setClass(this.element,"xforms-disabled",!1)}XFOutput.prototype=new XFControl;XFOutput.prototype.clone=function(a){return new XFOutput(a,this.binding,this.mediatype)};XFOutput.prototype.dispose=function(){this.valueElement=null;XFControl.prototype.dispose.call(this)};
XFOutput.prototype.setValue=function(a){var b=this.valueElement;if(b.nodeName.toLowerCase()=="span")if(this.mediatype=="application/xhtml+xml"){for(;b.firstChild;)b.removeChild(b.firstChild);if(a!=null)b.innerHTML=a}else if(this.mediatype=="image/svg+xml"){for(;b.firstChild;)b.removeChild(b.firstChild);if(Core.isIE){var f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","script"):document.createElement("script");f.setAttribute("type","text/xaml");f.setAttribute("id",this.element.id+
"-xaml");f.text=Core.transformText(a,Core.ROOT+"svg2xaml.xsl",!1,"width",b.currentStyle.width,"height",b.currentStyle.height);b.appendChild(f);a=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","object"):document.createElement("object");a.setAttribute("width",b.currentStyle.width+"px");a.setAttribute("height",b.currentStyle.height+"px");a.setAttribute("type","application/x-silverlight");a.setAttribute("style","min-width: "+b.currentStyle.width+"px");f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml",
"param"):document.createElement("param");f.setAttribute("name","source");f.setAttribute("value","#"+this.element.id+"-xaml");a.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","param"):document.createElement("param");f.setAttribute("name","onload");f.setAttribute("value","onLoaded");a.appendChild(f);f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","param"):document.createElement("param");f.setAttribute("name","iswindowless");f.setAttribute("value",
"true");a.appendChild(f);b.appendChild(a)}else Core.isXhtml?(f=window.getComputedStyle(b,null),XDocument.parse(a,b),b.firstChild.setAttribute("width",f.getPropertyValue("min-width")),b.firstChild.setAttribute("height",f.getPropertyValue("min-height"))):(f=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","object"):document.createElement("object"),f.setAttribute("type","image/svg+xml"),f.setAttribute("data","data:image/svg+xml,"+a),b.appendChild(f))}else setValue(b,a);else b.src=
a};XFOutput.prototype.getValue=function(a){var b=this.valueElement;if(b.nodeName.toLowerCase()=="span")return getValue(b,a);else{if((value=b.src)&&a&&b.type.format)try{value=b.type.format(value)}catch(f){}return value}};function XFRepeat(a,b){this.init(a);this.binding=b;this.index=1;var f=this.element;this.hasBinding=this.isRepeat=!0;this.root=Core.hasClass(f,"xforms-control")?f.lastChild:f;this.isItemset=Core.hasClass(f,"xforms-itemset")}XFRepeat.prototype=new XFElement;
XFRepeat.prototype.dispose=function(){this.root=null;XFElement.prototype.dispose.call(this)};XFRepeat.prototype.setIndex=function(a){if(this.index!=a){var b=this.nodes[a-1];if(b)xforms.openAction(),this.index=a,this.element.node=b,xforms.addChange(this),xforms.addChange(document.getElementById(Core.getMeta(b.ownerDocument.documentElement,"model")).xfElement),xforms.closeAction()}};
XFRepeat.prototype.deleteNode=function(a){for(var b=[],f=this.nodes,g=0,h=f.length;g<h;g++)a!=f[g]&&b.push(f[g]);this.nodes=b;this.setIndex(this.index==f.length?this.index-1:this.index)};XFRepeat.prototype.insertNode=function(a,b){var f=this.nodes;if(b){for(var g=[],h=1,i=0,j=f.length;i<j;i++)b==f[i]&&(g.push(a),h=i+1),g.push(f[i]);this.nodes=g;this.setIndex(h)}else f.push(a),this.setIndex(f.length)};
XFRepeat.prototype.build_=function(a){var a=this.evaluateBinding(this.binding,a),b=this.root,f=b.childNodes.length;this.nodes=a;var g=a.length;XFRepeat.forceOldId(b.firstChild);for(var h=f;h<g;h++){var i=b.firstChild.cloneNode(!0);b.appendChild(i);XFRepeat.initClone(i)}for(h=g;h<f&&b.childNodes.length>1;h++)xforms.dispose(b.lastChild),b.removeChild(b.lastChild);for(f=0;f<g;f++)Core.setMeta(a[f],"repeat",this.element.id),b.childNodes[f].node=a[f];if(this.index>g)this.index=1;this.element.node=a[this.index-
1]};XFRepeat.prototype.refresh=function(a){var b=this.nodes.length===0;Core.setClass(this.element,"xforms-disabled",b);if(!b&&!this.isItemset)for(var b=this.root.childNodes,f=0,g=b.length;f<g;f++){var h=a&&this.index==f+1;b[f].selected=h;Core.setClass(b[f],"xforms-repeat-item-selected",h)}};XFRepeat.prototype.clone=function(a){return new XFRepeat(a,this.binding,!0)};
XFRepeat.initClone=function(a){if(a.id){IdManager.cloneId(a);var b=a.getAttribute("oldid"),b=document.getElementById(b),f=b.xfElement;f&&f.clone(a.id);if((b=b.listeners)&&!Core.isIE)for(var f=0,g=b.length;f<g;f++)b[f].clone(a)}for(b=a.firstChild;b;)f=b,b=b.nextSibling,f.id&&f.getAttribute("cloned")?a.removeChild(f):XFRepeat.initClone(f)};XFRepeat.forceOldId=function(a){var b=a.id;if(b){if(b.substr(0,8)=="clonedId")return;a.setAttribute("oldid",b)}for(a=a.firstChild;a;)b=a,a=a.nextSibling,XFRepeat.forceOldId(b)};
XFRepeat.selectItem=function(a){var b=a.parentNode;if(b){var f=b.xfElement?b:b.parentNode,b=b.childNodes;assert(f.xfElement,a.nodeName+" - "+f.nodeName);for(var g=0,h=b.length;g<h;g++)if(b[g]==a){f.xfElement.setIndex(g+1);break}}};
function XFSelect(a,b,f,g,h,i){this.init(a);this.binding=g;this.multiple=b;this.full=f;this.incremental=h;this.isClone=i;this.hasBinding=!0;if(!this.full)this.select=Core.isXhtml?this.element.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","select")[0]:this.element.getElementsByTagName("select")[0],this.initFocus(this.select),XSLTFormsEvent.attach(this.select,"change",h?XFSelect.incrementalChange:XFSelect.normalChange)}XFSelect.prototype=new XFControl;
XFSelect.prototype.clone=function(a){return new XFSelect(a,this.multiple,this.full,this.binding,this.incremental,!0)};XFSelect.prototype.dispose=function(){this.selectedOptions=this.select=null;XFControl.prototype.dispose.call(this)};XFSelect.prototype.focusFirst=function(){var a=Core.isXhtml?this.element.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","input")[0]:this.element.getElementsByTagName("input")[0];a.focus();Core.isOpera&&a.focus()};
XFSelect.prototype.setValue=function(a){if(!this.full&&(!a||a=="")){if(this.selectedOptions=[],this.select.firstChild.value!="\u00a0"){var b=this.select.options[0].cloneNode(!0);b.value="\u00a0";b.text="\u00a0";b.id="";this.select.insertBefore(b,this.select.options[0]);this.select.selectedIndex=0}}else{!this.full&&this.select.firstChild.value=="\u00a0"&&this.select.removeChild(this.select.firstChild);for(var b=a?this.multiple?a.split(" "):[a]:[""],f=this.full?Core.isXhtml?this.element.getElementsByTagNameNS("http://www.w3.org/1999/xhtml",
"input"):this.element.getElementsByTagName("input"):this.select.options,g=!0,h=0,i=b.length;g&&h<i;h++){for(var g=b[h],j=!1,k=0,l=f.length;!j&&k<l;k++)f[k].value==g&&(j=!0);g=j}if(g||this.multiple&&!a){if(this.outRange)this.outRange=!1,XMLEvents.dispatch(this,"xforms-in-range")}else if((!this.multiple||a)&&!this.outRange)this.outRange=!0,XMLEvents.dispatch(this,"xforms-out-of-range");b=this.multiple?b:[b[0]];if(this.full){h=0;for(i=f.length;h<i;h++)a=f[h],a.checked=inArray(a.value,b)}else{this.selectedOptions=
[];h=0;for(i=f.length;h<i;h++){a=f[h];(g=inArray(a.value,b))&&this.selectedOptions.push(a);try{a.selected=g}catch(q){}}}}};XFSelect.prototype.changeReadonly=function(){if(this.full)for(var a=Core.isXhtml?this.element.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","input"):this.element.getElementsByTagName("input"),b=0,f=a.length;b<f;b++)a[b].disabled=this.readonly;else if(!Dialog.knownSelect(this.select))this.select.disabled=this.readonly};
XFSelect.prototype.itemClick=function(a){var b=Core.isXhtml?this.element.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","input"):this.element.getElementsByTagName("input");xforms.openAction();if(this.multiple){for(var f=null,g=0,h=b.length;g<h;g++){var i=b[g];i.value==a&&XMLEvents.dispatch(i.parentNode,i.checked?"xforms-select":"xforms-deselect");i.checked&&(f=(f?f+" ":"")+i.value)}a=f}else{f=this.value||getValue(this.element.node);g=null;if(f==a){xforms.closeAction();return}for(var h=0,j=
b.length;h<j;h++)i=b[h],i.checked=i.value==a,i.value==f?XMLEvents.dispatch(i.parentNode,"xforms-deselect"):i.value==a&&(g=i);XMLEvents.dispatch(g.parentNode,"xforms-select")}this.incremental?this.valueChanged(a||""):this.value=a||"";xforms.closeAction()};XFSelect.prototype.blur=function(){if(this.value!=null)xforms.openAction(),this.valueChanged(this.value),xforms.closeAction(),this.value=null};
XFSelect.normalChange=function(){var a=XFControl.getXFElement(this),b=[],f="",g=a.getSelected(),h=this.options;xforms.openAction();for(var i=0,j=g.length;i<j;i++)g[i].selected?b.push(g[i]):XMLEvents.dispatch(g[i],"xforms-deselect");g=0;for(i=h.length;g<i;g++)j=h[g],j.selected&&(f=f?f+" "+j.value:j.value);g=0;for(i=h.length;g<i;g++)j=h[g],j.selected&&!inArray(j,b)&&(b.push(j),XMLEvents.dispatch(j,"xforms-select"));a.value=f;a.selectedOptions=b;xforms.closeAction()};
XFSelect.incrementalChange=function(a){var b=XFControl.getXFElement(this);xforms.openAction();XFSelect.normalChange.call(this,a);b.valueChanged(b.value);xforms.closeAction()};XFSelect.prototype.getSelected=function(){var a=this.selectedOptions;if(!a)for(var a=[],b=this.select.options,f=0,g=b.length;f<g;f++)b[f].selected&&a.push(b[f]);return a};
function XFTrigger(a,b){this.init(a);this.binding=b;(this.hasBinding=!!b)||Core.setClass(this.element,"xforms-disabled",!1);this.isTrigger=!0;this.initFocus(Core.isXhtml?this.element.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","a")[0]||this.element.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","button")[0]:this.element.getElementsByTagName("a")[0]||this.element.getElementsByTagName("button")[0])}XFTrigger.prototype=new XFControl;XFTrigger.prototype.setValue=function(){};
XFTrigger.prototype.clone=function(a){return new XFTrigger(a,this.binding,!0)};XFTrigger.prototype.click=function(){xforms.openAction();XMLEvents.dispatch(this,"DOMActivate");xforms.closeAction()};XFTrigger.prototype.blur=function(){};
function Calendar(){var a=Core.isXhtml?document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body")[0]:document.getElementsByTagName("body")[0];this.element=Core.createElement("table",a,null,"calendar");var b=Core.createElement("thead",this.element),a=Core.createElement("tr",b),a=Core.createElement("td",a,null,"title");a.colSpan=7;this.selectMonth=Core.createElement("select",a);XSLTFormsEvent.attach(this.selectMonth,"change",function(){Calendar.INSTANCE.refresh()});for(var f=0;f<12;f++)Core.createElement("option",
this.selectMonth,I8N.get("calendar.month"+f)).setAttribute("value",f);this.inputYear=Core.createElement("input",a);this.inputYear.readOnly=!0;XSLTFormsEvent.attach(this.inputYear,"mouseup",function(){Calendar.INSTANCE.yearList.show()});XSLTFormsEvent.attach(this.inputYear,"change",function(){Calendar.INSTANCE.refresh()});f=Core.createElement("button",a,"X");f.setAttribute("title","Close");XSLTFormsEvent.attach(f,"click",function(){Calendar.close()});for(var b=Core.createElement("tr",b,null,"names"),
f=parseInt(I8N.get("calendar.initDay"),10),g=0;g<7;g++)this.createElement(b,"name",I8N.get("calendar.day"+(g+f)%7));this.tBody=Core.createElement("tbody",this.element);b=function(a){var b=XSLTFormsEvent.getTarget(a).childNodes[0].nodeValue,a=Calendar.INSTANCE;if(b!="")a.day=b,b=new Date,b.setYear(a.inputYear.value),b.setMonth(a.selectMonth.value),b.setDate(a.day),a.isTimestamp?(b.setSeconds(a.inputSec.value),b.setMinutes(a.inputMin.value),b.setHours(a.inputHour.value),a.input.value=I8N.format(b,null,
!0)):a.input.value=I8N.formatDate(b),Calendar.close(),XSLTFormsEvent.dispatch(a.input,"keyup"),a.input.focus()};for(f=0;f<6;f++)for(var g=Core.createElement("tr",this.tBody),h=0;h<7;h++)this.createElement(g,"day"," ",1,b);b=Core.createElement("tfoot",this.element);b=Core.createElement("tr",b);b=Core.createElement("td",b);b.colSpan=7;this.inputHour=Core.createElement("input",b);this.inputHour.readOnly=!0;XSLTFormsEvent.attach(this.inputHour,"mouseup",function(){Calendar.INSTANCE.hourList.show()});
b.appendChild(document.createTextNode(":"));this.inputMin=Core.createElement("input",b);this.inputMin.readOnly=!0;XSLTFormsEvent.attach(this.inputMin,"mouseup",function(){Calendar.INSTANCE.minList.show()});b.appendChild(document.createTextNode(":"));this.inputSec=Core.createElement("input",b);this.inputSec.readOnly=!0;XSLTFormsEvent.attach(this.inputSec,"mouseup",function(){Calendar.INSTANCE.type>=Calendar.SECONDS&&Calendar.INSTANCE.secList.show()});this.yearList=new NumberList(a,"calendarList",this.inputYear,
1900,2050);this.hourList=new NumberList(b,"calendarList",this.inputHour,0,23,2);this.minList=new NumberList(b,"calendarList",this.inputMin,0,59,2);this.secList=new NumberList(b,"calendarList",this.inputSec,0,59,2)}Calendar.prototype.today=function(){this.refreshControls(new Date)};
Calendar.prototype.refreshControls=function(a){this.day=a.getDate();this.selectMonth.value=a.getMonth();this.inputYear.value=a.getYear()<1E3?1900+a.getYear():a.getYear();if(this.isTimestamp)this.inputHour.value=zeros(a.getHours(),2),this.inputMin.value=this.type>=Calendar.MINUTES?zeros(a.getMinutes(),2):"00",this.inputSec.value=this.type>=Calendar.SECONDS?zeros(a.getSeconds(),2):"00";this.refresh()};
Calendar.prototype.refresh=function(){for(var a=this.getFirstDay(),b=this.getDaysOfMonth(),f=parseInt(I8N.get("calendar.initDay"),10),g=0,h=1,i=this.selectMonth.value==this.currentMonth&&this.inputYear.value==this.currentYear,j=0;j<6;j++)for(var k=this.tBody.childNodes[j],l=0;l<7;l++,g++){var q=k.childNodes[l],n=g>=a&&g<a+b;Core.setClass(q,"hover",!1);Core.setClass(q,"today",i&&h==this.currentDay);Core.setClass(q,"selected",n&&h==this.day);Core.setClass(q,"weekend",(l+f)%7>4);q.firstChild.nodeValue=
n?h++:""}};Calendar.prototype.getFirstDay=function(){var a=new Date;a.setDate(1);a.setMonth(this.selectMonth.value);a.setYear(this.inputYear.value);var b=parseInt(I8N.get("calendar.initDay"),10);return(a.getDay()+(6-b))%7};Calendar.prototype.getDaysOfMonth=function(){var a=this.inputYear.value;if(this.selectMonth.value==1&&0===a%4&&(0!==a%100||0===a%400))return 29;return Calendar.daysOfMonth[this.selectMonth.value]};
Calendar.prototype.createElement=function(a,b,f,g,h){a=Core.createElement("td",a,f,b);if(g>1)a.colSpan=g;h&&(XSLTFormsEvent.attach(a,"click",h),Core.initHover(a));return a};Calendar.daysOfMonth=[31,28,31,30,31,30,31,31,30,31,30,31];Calendar.ONLY_DATE=0;Calendar.HOURS=1;Calendar.MINUTES=2;Calendar.SECONDS=3;
Calendar.show=function(a,b){var f=Calendar.INSTANCE;if(!f)f=new Calendar,Calendar.INSTANCE=f;if(!b)b=Calendar.ONLY_DATE;f.input=a;f.type=b;f.isTimestamp=b!=Calendar.ONLY_DATE;Core.setClass(f.element,"date",!f.isTimestamp);var g;try{g=f.isTimestamp?I8N.parse(a.value):I8N.parseDate(a.value)}catch(h){g=new Date}g!=null?f.refreshControls(g):f.today();Dialog.show(f.element,a,!1)};Calendar.close=function(){var a=Calendar.INSTANCE;a.yearList.close();Dialog.hide(a.element,!1)};function Type(){}
Type.prototype.setSchema=function(a){this.schema=a;return this};Type.prototype.setName=function(a){this.name=a;this.nsuri=this.schema.ns;this.schema.types[a]=this;return this};Type.prototype.canonicalValue=function(a){a=a.toString();switch(this.whiteSpace){case "replace":a=a.replace(/[\t\r\n]/g," ");break;case "collapse":a=a.replace(/[\t\r\n ]+/g," ").replace(/^\s+|\s+$/g,"")}return a};
Type.prototype.getMaxLength=function(){return this.maxLength!=null?this.maxLength:this.length!=null?this.length:this.totalDigits!=null?this.totalDigits+1:null};Type.prototype.getDisplayLength=function(){return this.displayLength};
function Schema(a,b,f){assert(a&&!Schema.all[a],"Needed schema name or exists one schema with that namespace");Schema.all[a]?xforms.error(this,"xforms-link-exception","More than one schema with the same namespace declaration"):(this.name=b,this.ns=a,this.types={},this.prefixes=f||{},Schema.all[a]=this)}Schema.all={};
Schema.prototype.getType=function(a){if(a.indexOf(":")!=-1){var b=a.split(":"),f=this.prefixes[b[0]];if(f)return Schema.getTypeNS(f,b[1]);return Schema.getType(a)}b=this.types[a];if(!b)throw alert("Type "+a+" not defined"),"Error";return b};Schema.getType=function(a){a=a.split(":");return typeof a[1]=="undefined"?Schema.getTypeNS(Schema.prefixes.xforms,a[0]):Schema.getTypeNS(Schema.prefixes[a[0]],a[1])};
Schema.getTypeNS=function(a,b){var f=Schema.all[a];if(!f)throw alert("Schema for namespace "+a+" not defined for type "+b),"Error";f=f.types[b];if(!f)throw alert("Type "+b+" not defined in namespace "+a),"Error";return f};Schema.get=function(a){var b=Schema.all[a];b||(b=new Schema(a));return b};Schema.prefixes={xsd_:"http://www.w3.org/2001/XMLSchema",xsd:"http://www.w3.org/2001/XMLSchema",xforms:"http://www.w3.org/2002/xforms",xsltforms:"http://www.agencexml.com/xsltforms"};
Schema.registerPrefix=function(a,b){this.prefixes[a]=b};function AtomicType(){this.patterns=[]}AtomicType.prototype=new Type;AtomicType.prototype.setBase=function(a){var a=typeof a=="string"?this.schema.getType(a):a,b;for(b in a){var f=a[b];b=="patterns"?copyArray(f,this.patterns):b!="name"&&b!="nsuri"&&(this[b]=f)}return this};AtomicType.prototype.put=function(a,b){a=="base"?this.setBase(b):a=="pattern"?copyArray([b],this.patterns):this[a]=b;return this};
AtomicType.prototype.validate=function(a){for(var a=this.canonicalValue(a),b=0,f=this.patterns.length;b<f;b++)if(!a.match(this.patterns[b]))return!1;if(this.enumeration!=null){for(var b=!1,f=0,g=this.enumeration.length;f<g;f++)if(a==this.canonicalValue(this.enumeration[f])){b=!0;break}if(!b)return!1}b=a.length;f=parseInt(a,10);if(this.length!=null&&this.length!=b||this.minLength!=null&&b<this.minLength||this.maxLength!=null&&b>this.maxLength||this.maxInclusive!=null&&f>this.maxInclusive||this.maxExclusive!=
null&&f>=this.maxExclusive||this.minInclusive!=null&&f<this.minInclusive||this.minExclusive!=null&&f<=this.minExclusive)return!1;if(this.totalDigits!=null||this.fractionDigits!=null){f=a.indexOf(".");b=parseInt(f!=-1?a.substring(0,f):a,10);a=f!=-1?a.substring(f+1):"";if(f!=-1){if(this.fractionDigits==0)return!1;for(f=a.length-1;f>=0&&a.charAt(f)==0;f--);a=a.substring(0,f+1)}if(this.totalDigits!=null&&b.length+a.length>this.totalDigits||this.fractionDigits!=null&&a.length>this.fractionDigits)return!1}return!0};
AtomicType.prototype.normalize=function(a){if(this.fractionDigits!=null){a=parseFloat(a);if(isNaN(a))return"NaN";if(a==0)a=zeros(0,this.fractionDigits+1,!0);else var b=zeros(1,this.fractionDigits+1,!0),a=""+Math.round(a*b);if(this.fractionDigits!=0)return b=a.length-this.fractionDigits,(b==0?"0":a.substring(0,b))+"."+a.substring(b)}return a};function ListType(){this.whiteSpace="collapse"}ListType.prototype=new Type;
ListType.prototype.setItemType=function(a){this.itemType=typeof a=="string"?this.schema.getType(a):a;return this};ListType.prototype.validate=function(a){var b=this.baseType.canonicalValue.call(this,a).split(" "),a="";b.length==1&&b[0]==""&&(b=[]);for(var f=0,g=b.length;f<g;f++){var h=itemType.validate(b[f]);if(!h)break;a+=a.length===0?h:" "+h}return null};
ListType.prototype.canonicalValue=function(a){for(var a=this.baseType.canonicalValue(a).split(" "),b="",f=0,g=a.length;f<g;f++){var h=this.itemType.canonicalValue(a[f]);b+=(b.length===0?"":" ")+h}return b};function UnionType(){this.baseTypes=[]}UnionType.prototype=new Type;UnionType.prototype.addType=function(a){this.baseTypes.push(typeof a=="string"?this.schema.getType(a):a);return this};
UnionType.prototype.validate=function(a){for(var b=0,f=this.baseTypes.length;b<f;++b)if(this.baseTypes[b].validate(a))return!0;return!1};
var TypeDefs={initAll:function(){this.init("http://www.w3.org/2001/XMLSchema",this.Default);this.init("http://www.w3.org/2002/xforms",this.XForms);this.init("http://www.agencexml.com/xsltforms",this.XSLTForms)},init:function(a,b){var f=Schema.get(a),g;for(g in b){var h=new AtomicType;h.setSchema(f);h.setName(g);var i=b[g],j=i.base;j&&h.setBase(j);for(var k in i)k!="base"&&(h[k]=i[k])}},ctes:{i:"A-Za-z_\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF",c:"A-Za-z_\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\xFF\\-\\.0-9\\xB7"}};
TypeDefs.Default={string:{nsuri:"http://www.w3.org/2001/XMLSchema",whiteSpace:"preserve"},"boolean":{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^(true|false|0|1)$"],"class":"boolean"},decimal:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^[\\-+]?([0-9]+(\\.[0-9]*)?|\\.[0-9]+)$"],"class":"number",format:function(a){return I8N.formatNumber(a,this.fractionDigits)},parse:function(a){return I8N.parseNumber(a)}},"float":{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^(([-+]?([0-9]+(\\.[0-9]*)?)|(\\.[0-9]+))([eE][-+]?[0-9]+)?|-?INF|NaN)$"],
"class":"number"},"double":{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^(([-+]?([0-9]+(\\.[0-9]*)?)|(\\.[0-9]+))([eE][-+]?[0-9]+)?|-?INF|NaN)$"],"class":"number"},dateTime:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^([12][0-9]{3})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\\.[0-9]+)?(Z|[+-]([01][0-9]|2[0-3]):[0-5][0-9])?$"],"class":"datetime",displayLength:20,format:function(a){return I8N.format(I8N.parse(a,"yyyy-MM-ddThh:mm:ss"),null,!0)},
parse:function(a){return I8N.format(I8N.parse(a),"yyyy-MM-ddThh:mm:ss",!0)}},date:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^([12][0-9]{3})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])(Z|[+-]([01][0-9]|2[0-3]):[0-5][0-9])?$"],"class":"date",displayLength:10,format:function(a){return I8N.formatDate(I8N.parse(a,"yyyy-MM-dd"),null,!0)},parse:function(a){return I8N.format(I8N.parseDate(a),"yyyy-MM-dd",!0)}},time:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\\.[0-9]+)?(Z|[+-]([01][0-9]|2[0-3]):[0-5][0-9])?$"],
displayLength:8},duration:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^-?P(?!$)([0-9]+Y)?([0-9]+M)?([0-9]+D)?(T(?!$)([0-9]+H)?([0-9]+M)?([0-9]+(\\.[0-9]+)?S)?)?$"]},gDay:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^---(0[1-9]|[12][0-9]|3[01])$"]},gMonth:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^--(0[1-9]|1[012])$"]},gMonthDay:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^--(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$"]},gYear:{nsuri:"http://www.w3.org/2001/XMLSchema",
patterns:["^([-+]?([0-9]{4}|[1-9][0-9]{4,}))?$"]},gYearMonth:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^([12][0-9]{3})-(0[1-9]|1[012])$"]},integer:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:decimal",fractionDigits:"0"},nonPositiveInteger:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:integer",patterns:["^([\\-][0-9]+|0)$"]},nonNegativeInteger:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:integer",patterns:["^[+]?[0-9]+$"]},negativeInteger:{nsuri:"http://www.w3.org/2001/XMLSchema",
base:"xsd_:integer",patterns:["^[\\-]0*[1-9][0-9]*$"]},positiveInteger:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:integer",patterns:["^[+]?0*[1-9][0-9]*$"]},"byte":{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:integer",minInclusive:-128,maxInclusive:127},"short":{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:integer",minInclusive:-32768,maxInclusive:32767},"int":{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:integer",minInclusive:-2147483648,maxInclusive:2147483647},"long":{nsuri:"http://www.w3.org/2001/XMLSchema",
base:"xsd_:integer",minInclusive:-9223372036854775E3,maxInclusive:9223372036854775E3},unsignedByte:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:nonNegativeInteger",maxInclusive:255},unsignedShort:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:nonNegativeInteger",maxInclusive:65535},unsignedInt:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:nonNegativeInteger",maxInclusive:4294967295},unsignedLong:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:nonNegativeInteger",maxInclusive:1.8446744073709552E19},
normalizedString:{nsuri:"http://www.w3.org/2001/XMLSchema",whiteSpace:"replace"},token:{nsuri:"http://www.w3.org/2001/XMLSchema",whiteSpace:"collapse"},language:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:token",patterns:["^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$"]},anyURI:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:token",patterns:["^(([^:\\/?#]+):)?(\\/\\/([^\\/\\?#]*))?([^\\?#]*)(\\?([^#]*))?(#([^\\:#\\[\\]\\@\\!\\$\\&\\\\'(\\)\\*\\+\\,\\;\\=]*))?$"]},Name:{nsuri:"http://www.w3.org/2001/XMLSchema",
base:"xsd_:token",patterns:["^["+TypeDefs.ctes.i+":]["+TypeDefs.ctes.c+":]*$"]},NCName:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:token",patterns:["^["+TypeDefs.ctes.i+"]["+TypeDefs.ctes.c+"]*$"]},QName:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:token",patterns:["^(([a-zA-Z][0-9a-zA-Z+\\-\\.]*:)?/{0,2}[0-9a-zA-Z;/?:@&=+$\\.\\>> -_!~*'()%]+)?(>> #[0-9a-zA-Z;/?:@&=+$\\.\\-_!~*'()%]+)?:["+TypeDefs.ctes.i+"]["+TypeDefs.ctes.c+"]*$"]},ID:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:NCName"},
IDREF:{nsuri:"http://www.w3.org/2001/XMLSchema",base:"xsd_:NCName"},IDREFS:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^["+TypeDefs.ctes.i+"]["+TypeDefs.ctes.c+"]*( +["+TypeDefs.ctes.i+"]["+TypeDefs.ctes.c+"]*)*$"]},NMTOKEN:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^["+TypeDefs.ctes.c+"]+$"]},NMTOKENS:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^["+TypeDefs.ctes.c+"]+( +["+TypeDefs.ctes.c+"]+)*$"]},base64Binary:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^[a-zA-Z0-9+/]+$"]},
hexBinary:{nsuri:"http://www.w3.org/2001/XMLSchema",patterns:["^[0-9A-Fa-f]+$"],format:function(a){return a.toUpperCase()},parse:function(a){return a.toUpperCase()}}};
TypeDefs.XForms={string:{nsuri:"http://www.w3.org/2002/xforms",whiteSpace:"preserve"},"boolean":{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(true|false|0|1)?$"],"class":"boolean"},decimal:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^([\\-+]?([0-9]+(\\.[0-9]*)?|\\.[0-9]+))?$"],"class":"number",format:function(a){return I8N.formatNumber(a,this.fractionDigits)},parse:function(a){return I8N.parseNumber(a)}},"float":{nsuri:"http://www.w3.org/2002/xforms",patterns:["^((([-+]?([0-9]+(\\.[0-9]*)?)|(\\.[0-9]+))([eE][-+]?[0-9]+)?|-?INF|NaN))?$"],
"class":"number"},"double":{nsuri:"http://www.w3.org/2002/xforms",patterns:["^((([-+]?([0-9]+(\\.[0-9]*)?)|(\\.[0-9]+))([eE][-+]?[0-9]+)?|-?INF|NaN))?$"],"class":"number"},dateTime:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(([12][0-9]{3})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\\.[0-9]+)?(Z|[+-]([01][0-9]|2[0-3]):[0-5][0-9])?)?$"],"class":"datetime",displayLength:20,format:function(a){return I8N.format(I8N.parse(a,"yyyy-MM-ddThh:mm:ss"),null,!0)},
parse:function(a){return I8N.format(I8N.parse(a),"yyyy-MM-ddThh:mm:ss",!0)}},date:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(([12][0-9]{3})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])(Z|[+-]([01][0-9]|2[0-3]):[0-5][0-9])?)?$"],"class":"date",displayLength:10,format:function(a){return I8N.formatDate(I8N.parse(a,"yyyy-MM-dd"),null,!0)},parse:function(a){return I8N.format(I8N.parseDate(a),"yyyy-MM-dd",!0)}},time:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\\.[0-9]+)?(Z|[+-]([01][0-9]|2[0-3]):[0-5][0-9])?)?$"],
displayLength:8},duration:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(-?P(?!$)([0-9]+Y)?([0-9]+M)?([0-9]+D)?(T(?!$)([0-9]+H)?([0-9]+M)?([0-9]+(\\.[0-9]+)?S)?)?)?$"]},dayTimeDuration:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^([-]?P([0-9]+D(T([0-9]+(H([0-9]+(M([0-9]+(.[0-9]*)?S|.[0-9]+S)?|(.[0-9]*)?S)|(.[0-9]*)?S)?|M([0-9]+(.[0-9]*)?S|.[0-9]+S)?|(.[0-9]*)?S)|.[0-9]+S))?|T([0-9]+(H([0-9]+(M([0-9]+(.[0-9]*)?S|.[0-9]+S)?|(.[0-9]*)?S)|(.[0-9]*)?S)?|M([0-9]+(.[0-9]*)?S|.[0-9]+S)?|(.[0-9]*)?S)|.[0-9]+S)))?$"]},
yearMonthDuration:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^([-]?P[0-9]+(Y([0-9]+M)?|M))?$"]},gDay:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(---(0[1-9]|[12][0-9]|3[01]))?$"]},gMonth:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(--(0[1-9]|1[012]))?$"]},gMonthDay:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(--(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01]))?$"]},gYear:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^([-+]?([0-9]{4}|[1-9][0-9]{4,}))?$"]},gYearMonth:{nsuri:"http://www.w3.org/2002/xforms",
patterns:["^(([12][0-9]{3})-(0[1-9]|1[012]))?$"]},integer:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:decimal",fractionDigits:"0"},nonPositiveInteger:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:integer",patterns:["^(([\\-][0-9]+|0))?$"]},nonNegativeInteger:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:integer",patterns:["^([+]?[0-9]+)?$"]},negativeInteger:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:integer",patterns:["^([\\-][0-9]+)?$"]},positiveInteger:{nsuri:"http://www.w3.org/2002/xforms",
base:"xforms:integer",patterns:["^[+]?0*[1-9][0-9]*$"]},"byte":{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:integer",minInclusive:-128,maxInclusive:127},"short":{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:integer",minInclusive:-32768,maxInclusive:32767},"int":{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:integer",minInclusive:-2147483648,maxInclusive:2147483647},"long":{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:integer",minInclusive:-9223372036854775E3,maxInclusive:9223372036854775E3},
unsignedByte:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:nonNegativeInteger",maxInclusive:255},unsignedShort:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:nonNegativeInteger",maxInclusive:65535},unsignedInt:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:nonNegativeInteger",maxInclusive:4294967295},unsignedLong:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:nonNegativeInteger",maxInclusive:1.8446744073709552E19},normalizedString:{nsuri:"http://www.w3.org/2002/xforms",whiteSpace:"replace"},
token:{nsuri:"http://www.w3.org/2002/xforms",whiteSpace:"collapse"},language:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:token",patterns:["^([a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*)?$"]},anyURI:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:token",patterns:["^((([a-zA-Z][0-9a-zA-Z+\\-\\.]*:)?/{0,2}[0-9a-zA-Z;/?:@&=+$\\.\\>> -_!~*'()%]+)?(>> #[0-9a-zA-Z;/?:@&=+$\\.\\-_!~*'()%]+)?)?$"]},Name:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:token",patterns:["^(["+TypeDefs.ctes.i+":]["+TypeDefs.ctes.c+
":]*)?$"]},NCName:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:token",patterns:["^(["+TypeDefs.ctes.i+"]["+TypeDefs.ctes.c+"]*)?$"]},QName:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:token",patterns:["^((([a-zA-Z][0-9a-zA-Z+\\-\\.]*:)?/{0,2}[0-9a-zA-Z;/?:@&=+$\\.\\>> -_!~*'()%]+)?(>> #[0-9a-zA-Z;/?:@&=+$\\.\\-_!~*'()%]+)?:["+TypeDefs.ctes.i+"]["+TypeDefs.ctes.c+"]*)?$"]},ID:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:NCName"},IDREF:{nsuri:"http://www.w3.org/2002/xforms",base:"xforms:NCName"},
IDREFS:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(["+TypeDefs.ctes.i+"]["+TypeDefs.ctes.c+"]+( +["+TypeDefs.ctes.i+"]["+TypeDefs.ctes.c+"]*)*)?$"]},NMTOKEN:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^["+TypeDefs.ctes.c+"]*$"]},NMTOKENS:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^(["+TypeDefs.ctes.c+"]+( +["+TypeDefs.ctes.c+"]+)*)?$"]},base64Binary:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^[a-zA-Z0-9+/]*$"]},hexBinary:{nsuri:"http://www.w3.org/2002/xforms",patterns:["^[0-9A-Fa-f]*$"],
format:function(a){return a.toUpperCase()},parse:function(a){return a.toUpperCase()}},email:{nsuri:"http://www.w3.org/2002/xforms",base:"xsd_:string",whiteSpace:"collapse",patterns:["^([A-Za-z0-9!#-'*+-/=?^_`{-~]+(.[A-Za-z0-9!#-'*+-/=?^_`{-~]+)*@[A-Za-z0-9!#-'*+-/=?^_`{-~]+(.[A-Za-z0-9!#-'*+-/=?^_`{-~]+)*)?$"]},"card-number":{nsuri:"http://www.w3.org/2002/xforms",base:"xsd_:string",patterns:["^[0-9]*$"]},url:{nsuri:"http://www.w3.org/2002/xforms",base:"xsd_:string",whiteSpace:"collapse",patterns:["^(ht|f)tp(s?)://([a-z0-9]*:[a-z0-9]*@)?([a-z0-9.]*\\.[a-z]{2,7})$"]},
amount:{nsuri:"http://www.w3.org/2002/xforms",base:"xsd_:decimal",format:function(a){return I8N.formatNumber(a,2)}}};
TypeDefs.XSLTForms={decimal:{nsuri:"http://www.agencexml.com/xsltforms",patterns:["^[-+]?\\(*[-+]?([0-9]+(\\.[0-9]*)?|\\.[0-9]+)(([+-/]|\\*)\\(*([0-9]+(\\.[0-9]*)?|\\.[0-9]+)\\)*)*$"],"class":"number",eval:"xsd:decimal"},"float":{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:float"},"double":{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:double"},integer:{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:integer"},
nonPositiveInteger:{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:nonPositiveInteger"},nonNegativeInteger:{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:nonNegativeInteger"},negativeInteger:{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:negativeInteger"},positiveInteger:{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:positiveInteger"},"byte":{nsuri:"http://www.agencexml.com/xsltforms",
base:"xsltforms:decimal",eval:"xsd:byte"},"short":{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:short"},"int":{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:int"},"long":{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:long"},unsignedByte:{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:unsignedByte"},unsignedShort:{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",
eval:"xsd:unsignedShort"},unsignedInt:{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:unsignedInt"},unsignedLong:{nsuri:"http://www.agencexml.com/xsltforms",base:"xsltforms:decimal",eval:"xsd:unsignedLong"}};TypeDefs.initAll();
function Listener(a,b,f,g){f=f||"default";if(f!="default"&&f!="capture")xforms.error(xforms.defaultModel,"xforms-compute-exception","Unknown event-phase("+f+") for event("+b+")"+(a?" on element("+a.id+")":"")+"!");else{this.observer=a;this.name=b;this.evtName=document.addEventListener?b:"errorupdate";this.phase=f;this.handler=g;assert(a);if(!a.listeners)a.listeners=[];a.listeners.push(this);this.callback=function(h){if(!document.addEventListener){h=h||window.event;h.target=h.srcElement;h.currentTarget=
a;if(h.trueName&&h.trueName!=b)return;if(h.phase){if(h.phase!=f)return}else if(f=="capture")return;if(f=="capture")h.cancelBubble=!0;h.preventDefault=function(){this.returnValue=!1};h.stopPropagation=function(){this.stopped=this.cancelBubble=!0}}var i=!0;h.currentTarget&&h.type=="DOMActivate"&&h.target.nodeName=="BUTTON"&&!Core.isFF2&&(i=!1);h.eventPhase==3&&!h.target.xfElement&&!Core.isFF2&&(i=!1);h.eventPhase==3&&h.target.xfElement&&h.target==h.currentTarget&&!Core.isFF2&&(i=!1);if(i){if(h.target!=
null&&h.target.nodeType==3)h.target=h.target.parentNode;g.call(h.target,h)}if(!document.addEventListener)try{h.preventDefault=null,h.stopPropagation=null}catch(j){}};this.attach()}}Listener.destructs=[];Listener.prototype.attach=function(){XSLTFormsEvent.attach(this.observer,this.evtName,this.callback,this.phase=="capture");this.evtName=="xforms-model-destruct"&&Listener.destructs.push({observer:this.observer,callback:this.callback})};
Listener.prototype.detach=function(){XSLTFormsEvent.detach(this.observer,this.evtName,this.callback,this.phase=="capture")};Listener.prototype.clone=function(a){new Listener(a,this.name,this.phase,this.handler)};XMLEvents={REGISTRY:[],EventContexts:[],define:function(a,b,f,g){XMLEvents.REGISTRY[a]={bubbles:b,cancelable:f,defaultAction:g?g:function(){}}},makeEventContext:function(a,b,f,g,h){a||(a={});a.type=b;a.targetid=f;a.bubbles=g;a.cancelable=h;return a}};
XMLEvents.dispatchList=function(a,b){for(var f=0,g=a.length;f<g;f++)XMLEvents.dispatch(a[f],b)};
XMLEvents.dispatch=function(a,b,f,g,h,i,j){a=a.element||a;assert(a!=null&&typeof a.nodeName!="undefined");DebugConsole.write("Dispatching event "+b+" on <"+a.nodeName+(a.className?' class="'+a.className+'"':"")+(a.id?' id="'+a.id+'"':"")+"/>");f=XMLEvents.REGISTRY[b];if(f!=null)g=f.bubbles,h=f.cancelable,i=f.defaultAction;i||(i=function(){});j=XMLEvents.makeEventContext(j,b,a.id,g,h);XMLEvents.EventContexts.push(j);try{if(a.dispatchEvent){var k=document.createEvent("Event");k.initEvent(b,g,h);var l=
a.dispatchEvent(k);(l&&!k.stopped||!h)&&i.call(a.xfElement,k)}else{for(var j=null,f=[],q=a.parentNode;q!=null;q=q.parentNode)f.unshift(q);for(var q=0,n=f.length;q<n;q++)if(k=document.createEventObject(),k.trueName=b,k.phase="capture",f[q].fireEvent("onerrorupdate",k),k.stopped)return;k=document.createEventObject();k.trueName=b;k.phase="capture";k.target=a;a.fireEvent("onerrorupdate",k);g||(j=new Listener(a,b,"default",function(a){a.cancelBubble=!0}));k=document.createEventObject();k.trueName=b;k.phase=
"default";k.target=a;l=a.fireEvent("onerrorupdate",k);try{(l&&!k.stopped||!h)&&i.call(a.xfElement,k),g||j.detach()}catch(m){alert("XSLTForms Exception\n--------------------------\n\nError initializing :\n\n"+(typeof m.stack=="undefined"?"":m.stack)+"\n\n"+(m.name?m.name+(m.message?"\n\n"+m.message:""):m))}}}catch(r){alert("XSLTForms Exception\n--------------------------\n\nError initializing :\n\n"+(typeof r.stack=="undefined"?"":r.stack)+"\n\n"+(r.name?r.name+(r.message?"\n\n"+r.message:""):r))}finally{if(XMLEvents.EventContexts[XMLEvents.EventContexts.length-
1].rheadsdoc)XMLEvents.EventContexts[XMLEvents.EventContexts.length-1].rheadsdoc=null;XMLEvents.EventContexts[XMLEvents.EventContexts.length-1]["response-body"]&&(XMLEvents.EventContexts[XMLEvents.EventContexts.length-1]["response-body"]=null);XMLEvents.EventContexts.pop()}};XMLEvents.define("xforms-model-construct",!0,!1,function(){this.construct()});XMLEvents.define("xforms-model-construct-done",!0,!1);XMLEvents.define("xforms-ready",!0,!1);XMLEvents.define("xforms-model-destruct",!0,!1);
XMLEvents.define("xforms-rebuild",!0,!0,function(){this.rebuild()});XMLEvents.define("xforms-recalculate",!0,!0,function(){this.recalculate()});XMLEvents.define("xforms-revalidate",!0,!0,function(){this.revalidate()});XMLEvents.define("xforms-reset",!0,!0,function(){this.reset()});XMLEvents.define("xforms-submit",!0,!0,function(){this.submit()});XMLEvents.define("xforms-submit-serialize",!0,!1);XMLEvents.define("xforms-refresh",!0,!0,function(){this.refresh()});
XMLEvents.define("xforms-focus",!0,!0,function(){this.focus()});XMLEvents.define("DOMActivate",!0,!0);XMLEvents.define("DOMFocusIn",!0,!1);XMLEvents.define("DOMFocusOut",!0,!1);XMLEvents.define("xforms-select",!0,!1);XMLEvents.define("xforms-deselect",!0,!1);XMLEvents.define("xforms-value-changed",!0,!1);XMLEvents.define("xforms-insert",!0,!1);XMLEvents.define("xforms-delete",!0,!1);XMLEvents.define("xforms-valid",!0,!1);XMLEvents.define("xforms-invalid",!0,!1);
XMLEvents.define("xforms-enabled",!0,!1);XMLEvents.define("xforms-disabled",!0,!1);XMLEvents.define("xforms-optional",!0,!1);XMLEvents.define("xforms-required",!0,!1);XMLEvents.define("xforms-readonly",!0,!1);XMLEvents.define("xforms-readwrite",!0,!1);XMLEvents.define("xforms-in-range",!0,!1);XMLEvents.define("xforms-out-of-range",!0,!1);XMLEvents.define("xforms-submit-done",!0,!1);XMLEvents.define("xforms-submit-error",!0,!1);XMLEvents.define("xforms-compute-exception",!0,!1);
XMLEvents.define("xforms-binding-exception",!0,!1);XMLEvents.define("ajx-start",!0,!0,function(a){a.target.xfElement.start()});XMLEvents.define("ajx-stop",!0,!0,function(a){a.target.xfElement.stop()});XMLEvents.define("ajx-time",!0,!0);XMLEvents.define("xforms-dialog-open",!0,!0,function(a){Dialog.show(a.target,null,!0)});XMLEvents.define("xforms-dialog-close",!0,!0,function(a){Dialog.hide(a.target,!0)});
var XPathAxis={ANCESTOR_OR_SELF:"ancestor-or-self",ANCESTOR:"ancestor",ATTRIBUTE:"attribute",CHILD:"child",DESCENDANT_OR_SELF:"descendant-or-self",DESCENDANT:"descendant",FOLLOWING_SIBLING:"following-sibling",FOLLOWING:"following",NAMESPACE:"namespace",PARENT:"parent",PRECEDING_SIBLING:"preceding-sibling",PRECEDING:"preceding",SELF:"self"},NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,
NOTATION:12};function ArrayExpr(a){this.exprs=a}ArrayExpr.prototype.evaluate=function(a){for(var b=[],f=0,g=this.exprs.length;f<g;f++)b[f]=this.exprs[f].evaluate(a);return b};function BinaryExpr(a,b,f){this.expr1=a;this.expr2=f;this.op=b.replace("&gt;",">").replace("&lt;","<")}
BinaryExpr.prototype.evaluate=function(a){var b=this.expr1.evaluate(a),a=this.expr2.evaluate(a),f,g;if((typeof b=="object"&&b.length>1||typeof a=="object"&&a.length>1)&&(this.op=="="||this.op=="!="||this.op=="<"||this.op=="<="||this.op==">"||this.op==">=")){for(var h=0,i=b.length;h<i;h++){f=numberValue([b[h]]);isNaN(f)&&(f=stringValue([b[h]]));for(var j=0,k=a.length;j<k;j++)switch(g=numberValue([a[j]]),isNaN(g)&&(g=stringValue([a[j]])),this.op){case "=":if(f==g)return!0;break;case "!=":if(f!=g)return!0;
break;case "<":if(f<g)return!0;break;case "<=":if(f<=g)return!0;break;case ">":if(f>g)return!0;break;case ">=":if(f>=g)return!0}}return!1}f=numberValue(b);g=numberValue(a);if(isNaN(f)||isNaN(g))f=stringValue(b),g=stringValue(a);h=0;switch(this.op){case "or":h=booleanValue(b)||booleanValue(a);break;case "and":h=booleanValue(b)&&booleanValue(a);break;case "+":h=f+g;break;case "-":h=f-g;break;case "*":h=f*g;break;case "mod":h=f%g;break;case "div":h=f/g;break;case "=":h=f==g;break;case "!=":h=f!=g;break;
case "<":h=f<g;break;case "<=":h=f<=g;break;case ">":h=f>g;break;case ">=":h=f>=g}return typeof h=="number"?Math.round(h*1E6)/1E6:h};
function ExprContext(a,b,f,g,h,i,j,k,l){this.node=a;this.current=i||a;if(b==null&&(i=a?Core.getMeta(a,"repeat"):null)){i=document.getElementById(i).xfElement;b=1;for(len=i.nodes.length;b<=len;b++)if(a==i.nodes[b-1])break}this.position=b||1;this.nodelist=f||[a];this.root=(this.parent=g)?g.root:a?a.ownerDocument:null;this.nsresolver=h;this.depsId=k;this.initDeps(j,l)}
ExprContext.prototype.clone=function(a,b,f){return new ExprContext(a||this.node,typeof b=="undefined"?this.position:b,f||this.nodelist,this,this.nsresolver,this.current,this.depsNodes,this.depsId,this.depsElements)};ExprContext.prototype.setNode=function(a,b){this.node=a;this.position=b};ExprContext.prototype.initDeps=function(a,b){this.depsNodes=a;this.depsElements=b};
ExprContext.prototype.addDepNode=function(a){var b=this.depsNodes;b&&!Core.getBoolMeta(a,"depfor_"+this.depsId)&&(Core.setTrueBoolMeta(a,"depfor_"+this.depsId),b.push(a))};ExprContext.prototype.addDepElement=function(a){var b=this.depsElements;b&&!inArray(a,b)&&b.push(a)};function TokenExpr(a){this.value=a}TokenExpr.prototype.evaluate=function(){return stringValue(this.value)};function UnaryMinusExpr(a){this.expr=a}UnaryMinusExpr.prototype.evaluate=function(a){return-numberValue(this.expr.evaluate(a))};
function CteExpr(a){this.value=a}CteExpr.prototype.evaluate=function(){return this.value};function FilterExpr(a,b){this.expr=a;this.predicate=b}FilterExpr.prototype.evaluate=function(a){for(var b=nodeSetValue(this.expr.evaluate(a)),f=0,g=this.predicate.length;f<g;++f)for(var h=b,b=[],i=0,j=h.length;i<j;++i){var k=h[i],l=a.clone(k,i,h);booleanValue(this.predicate[f].evaluate(l))&&b.push(k)}return b};
function FunctionCallExpr(a){this.name=a;this.func=XPathCoreFunctions[a];this.args=[];if(!this.func)throw{name:"Function "+a+"() not found"};for(var b=1,f=arguments.length;b<f;b++)this.args.push(arguments[b])}FunctionCallExpr.prototype.evaluate=function(a){for(var b=[],f=0,g=this.args.length;f<g;f++)b[f]=this.args[f].evaluate(a);return this.func.call(a,b)};function LocationExpr(a){this.absolute=a;this.steps=[];for(var b=1,f=arguments.length;b<f;b++)this.steps.push(arguments[b])}
LocationExpr.prototype.evaluate=function(a){var b=this.absolute?a.root:a.node,f=Core.getMeta(b.documentElement?b.documentElement:b.ownerDocument.documentElement,"model");f&&a.addDepElement(document.getElementById(f).xfElement);f=[];this.xPathStep(f,this.steps,0,b,a);return f};LocationExpr.prototype.xPathStep=function(a,b,f,g,h){for(var g=b[f].evaluate(h.clone(g)),i=0,j=g.length;i<j;++i){var k=g[i];f==b.length-1?(inArray(k,a)||a.push(k),h.addDepNode(k)):this.xPathStep(a,b,f+1,k,h)}};
function NodeTestAny(){}NodeTestAny.prototype.evaluate=function(a){return(a.localName||a.baseName).substr(0,10)!="xsltforms_"&&a.namespaceURI!="http://www.w3.org/2000/xmlns/"};function NodeTestName(a,b){this.prefix=a;this.name=b}
NodeTestName.prototype.evaluate=function(a,b){var f=this.prefix;if(this.name=="*")return f&&f!="*"?a.namespaceURI==b.lookupNamespaceURI(f):!0;var g=a.namespaceURI;return(a.localName||a.baseName)==this.name&&(f&&f!="*"?g==b.lookupNamespaceURI(f):f!="*"?g==null||g==""||g==b.lookupNamespaceURI(""):!0)};function NodeTestPI(a){this.target=a}NodeTestPI.prototype.evaluate=function(a){return a.nodeType==NodeType.PROCESSING_INSTRUCTION&&(!this.target||a.nodeName==this.target)};
function NodeTestType(a){this.type=a}NodeTestType.prototype.evaluate=function(a){return a.nodeType==this.type};function NSResolver(){this.map={};this.notfound=!1}NSResolver.prototype.registerAll=function(a){for(var b in a.map)this.map[b]=a.map[b]};NSResolver.prototype.register=function(a,b){this.map[a]=b;if(b=="notfound")this.notfound=!0};NSResolver.prototype.registerNotFound=function(a,b){if(this.map[a]=="notfound")for(p in this.map[a]=b,this.map)if(this.map[p]=="notfound")this.notfound=!0};
NSResolver.prototype.lookupNamespaceURI=function(a){return this.map[a]};function PathExpr(a,b){this.filter=a;this.rel=b}PathExpr.prototype.evaluate=function(a){for(var b=nodeSetValue(this.filter.evaluate(a)),f=[],g=0,h=b.length;g<h;g++)for(var i=a.clone(b[g],g,b),i=nodeSetValue(this.rel.evaluate(i)),j=0,k=i.length;j<k;j++)f.push(i[j]);return f};function PredicateExpr(a){this.expr=a}PredicateExpr.prototype.evaluate=function(a){var b=this.expr.evaluate(a);return typeof b=="number"?a.position==b:booleanValue(b)};
function StepExpr(a,b){this.axis=a;this.nodetest=b;this.predicates=[];for(var f=2,g=arguments.length;f<g;f++)this.predicates.push(arguments[f])}
StepExpr.prototype.evaluate=function(a){var b=a.node,f=[];switch(this.axis){case XPathAxis.ANCESTOR_OR_SELF:_push(a,f,b,this.nodetest);case XPathAxis.ANCESTOR:b.nodeType==NodeType.ATTRIBUTE&&(b=b.ownerElement?b.ownerElement:b.selectSingleNode(".."),_push(a,f,b,this.nodetest));for(b=b.parentNode;b.parentNode;b=b.parentNode)_push(a,f,b,this.nodetest);break;case XPathAxis.ATTRIBUTE:_pushList(a,f,b.attributes,this.nodetest);break;case XPathAxis.CHILD:_pushList(a,f,b.childNodes,this.nodetest);break;case XPathAxis.DESCENDANT_OR_SELF:_push(a,
f,b,this.nodetest);case XPathAxis.DESCENDANT:_pushDescendants(a,f,b,this.nodetest);break;case XPathAxis.FOLLOWING:for(b=b.nodeType==NodeType.ATTRIBUTE?b.ownerElement?b.ownerElement:b.selectSingleNode(".."):b;b.nodeType!=NodeType.DOCUMENT;){for(var g=b.nextSibling;g;g=g.nextSibling)_push(a,f,g,this.nodetest),_pushDescendants(a,f,g,this.nodetest);b=b.parentNode}break;case XPathAxis.FOLLOWING_SIBLING:for(b=b.nextSibling;b;b=b.nextSibling)_push(a,f,b,this.nodetest);break;case XPathAxis.NAMESPACE:alert("not implemented: axis namespace");
break;case XPathAxis.PARENT:b.parentNode?_push(a,f,b.parentNode,this.nodetest):b.nodeType==NodeType.ATTRIBUTE&&_push(a,f,b.ownerElement?b.ownerElement:b.selectSingleNode(".."),this.nodetest);break;case XPathAxis.PRECEDING:for(b=b.nodeType==NodeType.ATTRIBUTE?b.ownerElement?b.ownerElement:b.selectSingleNode(".."):b;b.nodeType!=NodeType.DOCUMENT;){for(g=b.previousSibling;g;g=g.previousSibling)_pushDescendantsRev(a,f,g,this.nodetest),_push(a,f,g,this.nodetest);b=b.parentNode}break;case XPathAxis.PRECEDING_SIBLING:for(g=
b.previousSibling;g;g=g.previousSibling)_push(a,f,g,this.nodetest);break;case XPathAxis.SELF:_push(a,f,b,this.nodetest);break;default:throw{name:"ERROR -- NO SUCH AXIS: "+this.axis};}b=0;for(g=this.predicates.length;b<g;b++){for(var h=this.predicates[b],i=[],j=0,k=f.length;j<k;j++){var l=f[j],q=a.clone(l,j+1,f);booleanValue(h.evaluate(q))&&i.push(l)}f=i}return f};function _push(a,b,f,g){g.evaluate(f,a.nsresolver)&&!inArray(f,b)&&(b[b.length]=f)}
function _pushList(a,b,f,g){for(var h=0,i=f?f.length:0;h<i;h++)_push(a,b,f[h],g)}function _pushDescendants(a,b,f,g){for(var h=f.firstChild;h;h=h.nextSibling)_push(a,b,h,g),arguments.callee(a,b,h,g)}function _pushDescendantsRev(a,b,f,g){for(var h=f.lastChild;h;h=h.previousSibling)_push(a,b,h,g),arguments.callee(a,b,h,g)}function UnionExpr(a,b){this.expr1=a;this.expr2=b}
UnionExpr.prototype.evaluate=function(a){for(var b=nodeSetValue(this.expr1.evaluate(a)),a=nodeSetValue(this.expr2.evaluate(a)),f=b.length,g=0,h=a.length;g<h;++g){for(var i=!1,j=0;j<f;++j)if(i=b[j]==a[g])break;i||b.push(a[g])}return b};function stringValue(a){return typeof a!="object"?""+a:a.length===0?"":xmlValue(a[0])}function booleanValue(a){return typeof a=="undefined"?!1:typeof a.length!="undefined"?a.length>0:!!a}var nbvalcount=0;
function numberValue(a){return typeof a=="boolean"?NaN:(a=typeof a=="object"?stringValue(a):a,a===""?NaN:a-0)}function nodeSetValue(a){if(typeof a!="object")throw{name:this,message:Error().stack};return a}
xmlValue=Core.isIE?function(a){var b=a.text;if(Schema.getType(Core.getType(a)||"xsd_:string").eval)try{b=b==""?0:eval(b)}catch(f){}return b}:function(a){var b=a.text!=void 0?a.text:a.textContent!=void 0?a.textContent:a.documentElement.text!=void 0?a.documentElement.text:a.documentElement.textContent;if(Schema.getType(Core.getType(a)||"xsd_:string").eval)try{b=b==""?0:eval(b)}catch(f){}return b};
function xmlResolveEntities(a){for(var a=stringSplit(a,"&"),b=a[0],f=1,g=a.length;f<g;++f){var h=a[f],i=h.indexOf(";");if(i==-1)b+=a[f];else{var j=h.substring(0,i);switch(j){case "lt":j="<";break;case "gt":j=">";break;case "amp":j="&";break;case "quot":j='"';break;case "apos":j="'";break;case "nbsp":j=String.fromCharCode(160);break;default:var k=Core.isXhtml?document.createElementNS("http://www.w3.org/1999/xhtml","span"):document.createElement("span");k.innerHTML="&"+j+"; ";j=k.childNodes[0].nodeValue.charAt(0)}b+=
j+h.substring(i+1)}}return b}function stringSplit(a,b){var f=a.indexOf(b);if(f==-1)return[a];var g=[];for(g.push(a.substr(0,f));f!=-1;){var h=a.indexOf(b,f+1);h!=-1?g.push(a.substr(f+1,h-f-1)):g.push(a.substr(f+1));f=h}return g}
function XPath(a,b,f){this.expression=a;if(typeof b=="string")alert("XSLTForms Exception\n--------------------------\n\nError parsing the following XPath expression :\n\n"+a+"\n\n"+b);else{this.compiled=b;this.compiled.isRoot=!0;this.nsresolver=new NSResolver;XPath.expressions[a]=this;if(f.length>0){a=0;for(b=f.length;a<b;a+=2)this.nsresolver.register(f[a],f[a+1])}else this.nsresolver.register("","http://www.w3.org/1999/xhtml");if(this.nsresolver.notfound)XPath.notfound=!0;this.evaltime=0}}
XPath.prototype.evaluate=function(a,b){var f=new Date;assert(a);if(a.node){if(!a.nsresolver)a.nsresolver=this.nsresolver}else a=new ExprContext(a,1,null,null,this.nsresolver,b);try{var g=this.compiled.evaluate(a);if(g instanceof Array&&g.length>1){for(var h=[],i=0,j=g.length;i<j;i++)h.push({count:Core.selectNodesLength("preceding::* | ancestor::*",g[i]),node:g[i]});h.sort(function(a,b){return a.count-b.count});i=0;for(j=h.length;i<j;i++)g[i]=h[i].node}this.evaltime+=new Date-f;return g}catch(k){return alert("XSLTForms Exception\n--------------------------\n\nError evaluating the following XPath expression :\n\n"+
this.expression+"\n\n"+k.name+"\n\n"+k.message),null}};XPath.expressions={};XPath.notfound=!1;XPath.get=function(a){return XPath.expressions[a]};XPath.create=function(a,b){if(XPath.get(a)!=null)delete b;else{for(var f=[],g=2,h=arguments.length;g<h;g+=2)f[g-2]=arguments[g],f[g-1]=arguments[g+1];new XPath(a,b,f)}};
XPath.registerNS=function(a,b){if(XPath.notfound)for(e in XPath.notfound=!1,XPath.expressions)if(XPath.expressions[e].nsresolver.registerNotFound(a,b),XPath.expressions[e].nsresolver.notfound)XPath.notfound=!0};function XPathFunction(a,b,f,g){this.evaluate=g;this.defaultTo=b;this.acceptContext=a;this.returnNodes=f}XPathFunction.DEFAULT_NONE=null;XPathFunction.DEFAULT_NODE=0;XPathFunction.DEFAULT_NODESET=1;XPathFunction.DEFAULT_STRING=2;
XPathFunction.prototype.call=function(a,b){if(b.length===0)switch(this.defaultTo){case XPathFunction.DEFAULT_NODE:a.node!=null&&(b=[a.node]);break;case XPathFunction.DEFAULT_NODESET:a.node!=null&&(b=[[a.node]]);break;case XPathFunction.DEFAULT_STRING:b=[XPathCoreFunctions.string.evaluate([a.node])]}this.acceptContext&&b.unshift(a);return this.evaluate.apply(null,b)};
MathConstants={PI:"3.14159265358979323846264338327950288419716939937510582",E:"2.71828182845904523536028747135266249775724709369995958",SQRT2:"1.41421356237309504880168872420969807856967187537694807",LN2:"0.693147180559945309417232121458176568075500134360255254",LN10:"2.30258509299404568401799145468436420760110148862877298",LOG2E:"1.44269504088896340735992468100189213742664595415298594",SQRT1_2:"0.707106781186547524400844362104849039284835937688474038"};
XPathCoreFunctions={"http://www.w3.org/2005/xpath-functions last":new XPathFunction(!0,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.lastInvalidArgumentsNumber;return a.nodelist.length}),"http://www.w3.org/2005/xpath-functions position":new XPathFunction(!0,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.positionInvalidArgumentsNumber;return a.position}),"http://www.w3.org/2002/xforms context":new XPathFunction(!0,
XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.positionInvalidArgumentsNumber;return[a.current]}),"http://www.w3.org/2005/xpath-functions count":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.countInvalidArgumentsNumber;if(typeof a!="object")throw XPathCoreFunctionsExceptions.countInvalidArgumentType;return a.length}),"http://www.w3.org/2005/xpath-functions id":new XPathFunction(!0,
XPathFunction.DEFAULT_NODE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.idInvalidArgumentsNumber;if(typeof b!="object"&&typeof b!="string")throw XPathCoreFunctionsExceptions.idInvalidArgumentType;var f=[];if(typeof b.length!="undefined")for(var g=0,h=b.length;g<h;++g)for(var i=XPathCoreFunctions["http://www.w3.org/2005/xpath-functions id"].evaluate(a,b[g]),j=0,k=i.length;j<k;j++)f.push(i[j]);else if(a.node!=null)for(j in g=stringValue(b).split(/\s+/),g)f.add(a.node.ownerDocument.getElementById(g[j]));
return f}),"http://www.w3.org/2005/xpath-functions local-name":new XPathFunction(!1,XPathFunction.DEFAULT_NODESET,!1,function(a){if(arguments.length>1)throw XPathCoreFunctionsExceptions.localNameInvalidArgumentsNumber;if(arguments.length==1&&typeof a!="object")throw XPathCoreFunctionsExceptions.localNameInvalidArgumentType;if(arguments.length==0)throw XPathCoreFunctionsExceptions.localNameNoContext;return a.length===0?"":a[0].nodeName.replace(/^.*:/,"")}),"http://www.w3.org/2005/xpath-functions namespace-uri":new XPathFunction(!1,
XPathFunction.DEFAULT_NODESET,!1,function(a){if(arguments.length>1)throw XPathCoreFunctionsExceptions.namespaceUriInvalidArgumentsNumber;if(arguments.length==1&&typeof a!="object")throw XPathCoreFunctionsExceptions.namespaceUriInvalidArgumentType;return a.length===0?"":a[0].namespaceURI||""}),"http://www.w3.org/2005/xpath-functions name":new XPathFunction(!1,XPathFunction.DEFAULT_NODESET,!1,function(a){if(arguments.length>1)throw XPathCoreFunctionsExceptions.nameInvalidArgumentsNumber;if(arguments.length==
1&&typeof a!="object")throw XPathCoreFunctionsExceptions.nameInvalidArgumentType;return a.length===0?"":a[0].nodeName}),"http://www.w3.org/2005/xpath-functions string":new XPathFunction(!1,XPathFunction.DEFAULT_NODESET,!1,function(a){if(arguments.length>1)throw XPathCoreFunctionsExceptions.stringInvalidArgumentsNumber;return stringValue(a)}),"http://www.w3.org/2005/xpath-functions concat":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(){if(arguments.length<2)throw XPathCoreFunctionsExceptions.concatInvalidArgumentsNumber;
for(var a="",b=0,f=arguments.length;b<f;++b)a+=stringValue(arguments[b]);return a}),"http://www.w3.org/2005/xpath-functions starts-with":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.startsWithInvalidArgumentsNumber;return stringValue(a).indexOf(stringValue(b))===0}),"http://www.w3.org/2005/xpath-functions contains":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.containsInvalidArgumentsNumber;
return stringValue(a).indexOf(stringValue(b))!=-1}),"http://www.w3.org/2005/xpath-functions substring-before":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.substringBeforeInvalidArgumentsNumber;a=stringValue(a);return a.substring(0,a.indexOf(stringValue(b)))}),"http://www.w3.org/2005/xpath-functions substring-after":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.substringAfterInvalidArgumentsNumber;
var a=stringValue(a),b=stringValue(b),f=a.indexOf(b);return f==-1?"":a.substring(f+b.length)}),"http://www.w3.org/2005/xpath-functions substring":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b,f){if(arguments.length!=2&&arguments.length!=3)throw XPathCoreFunctionsExceptions.substringInvalidArgumentsNumber;a=stringValue(a);b=Math.round(numberValue(b));if(isNaN(b))return"";if(f!=null){f=Math.round(numberValue(f));if(b<=0)return a.substr(0,b+f-1);return a.substr(b-1,f)}return a.substr(Math.max(b-
1,0))}),"http://www.w3.org/2005/xpath-functions compare":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.compareInvalidArgumentsNumber;a=stringValue(a);b=stringValue(b);return a==b?0:a>b?1:-1}),"http://www.w3.org/2005/xpath-functions string-length":new XPathFunction(!1,XPathFunction.DEFAULT_STRING,!1,function(a){if(arguments.length>1)throw XPathCoreFunctionsExceptions.stringLengthInvalidArgumentsNumber;return stringValue(a).length}),
"http://www.w3.org/2005/xpath-functions normalize-space":new XPathFunction(!1,XPathFunction.DEFAULT_STRING,!1,function(a){if(arguments.length>1)throw XPathCoreFunctionsExceptions.normalizeSpaceLengthInvalidArgumentsNumber;return stringValue(a).replace(/^\s+|\s+$/g,"").replace(/\s+/," ")}),"http://www.w3.org/2005/xpath-functions translate":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b,f){if(arguments.length!=3)throw XPathCoreFunctionsExceptions.translateInvalidArgumentsNumber;for(var a=
stringValue(a),b=stringValue(b),f=stringValue(f),g="",h=0,i=a.length;h<i;++h){var j=b.indexOf(a.charAt(h));g+=j==-1?a.charAt(h):f.charAt(j)}return g}),"http://www.w3.org/2005/xpath-functions boolean":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.booleanInvalidArgumentsNumber;return booleanValue(a)}),"http://www.w3.org/2005/xpath-functions not":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=
1)throw XPathCoreFunctionsExceptions.notInvalidArgumentsNumber;return!booleanValue(a)}),"http://www.w3.org/2005/xpath-functions true":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(){if(arguments.length!=0)throw XPathCoreFunctionsExceptions.trueInvalidArgumentsNumber;return!0}),"http://www.w3.org/2005/xpath-functions false":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(){if(arguments.length!=0)throw XPathCoreFunctionsExceptions.falseInvalidArgumentsNumber;return!1}),"http://www.w3.org/2005/xpath-functions lang":new XPathFunction(!0,
XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.langInvalidArgumentsNumber;for(var b=stringValue(b),f=a.node;f!=null;f=f.parentNode)if(typeof f.attributes!="undefined"){var g=f.attributes.getNamedItemNS(XML.Namespaces.XML,"lang");if(g!=null)return g=g.value.toLowerCase(),b=b.toLowerCase(),g.indexOf(b)===0&&(b.length==g.length||b.charAt(g.length)=="-")}return!1}),"http://www.w3.org/2005/xpath-functions number":new XPathFunction(!1,XPathFunction.DEFAULT_NODESET,
!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.numberInvalidArgumentsNumber;return numberValue(a)}),"http://www.w3.org/2005/xpath-functions sum":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.sumInvalidArgumentsNumber;if(typeof a!="object")throw XPathCoreFunctionsExceptions.sumInvalidArgumentType;for(var b=0,f=0,g=a.length;f<g;++f)b+=numberValue(xmlValue(a[f]));return b}),"http://www.w3.org/2005/xpath-functions floor":new XPathFunction(!1,
XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.floorInvalidArgumentsNumber;return Math.floor(numberValue(a))}),"http://www.w3.org/2005/xpath-functions ceiling":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.ceilingInvalidArgumentsNumber;return Math.ceil(numberValue(a))}),"http://www.w3.org/2005/xpath-functions round":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=
1)throw XPathCoreFunctionsExceptions.roundInvalidArgumentsNumber;return Math.round(numberValue(a))}),"http://www.w3.org/2002/xforms power":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.powerInvalidArgumentsNumber;return Math.pow(numberValue(a),numberValue(b))}),"http://www.w3.org/2002/xforms random":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(){if(arguments.length>1)throw XPathCoreFunctionsExceptions.randomInvalidArgumentsNumber;
return Math.random()}),"http://www.w3.org/2002/xforms boolean-from-string":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.booleanFromStringInvalidArgumentsNumber;a=stringValue(a);switch(a.toLowerCase()){case "true":case "1":return!0;case "false":case "0":return!1;default:return!1}}),"http://www.w3.org/2002/xforms if":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!0,function(a,b,f){if(arguments.length!=3)throw XPathCoreFunctionsExceptions.ifInvalidArgumentsNumber;
return booleanValue(a)?b:f}),"http://www.w3.org/2002/xforms choose":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!0,function(a,b,f){if(arguments.length!=3)throw XPathCoreFunctionsExceptions.chooseInvalidArgumentsNumber;return booleanValue(a)?b:f}),"http://www.w3.org/2005/xpath-functions avg":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.avgInvalidArgumentsNumber;if(typeof a!="object")throw XPathCoreFunctionsExceptions.avgInvalidArgumentType;
var b=XPathCoreFunctions["http://www.w3.org/2005/xpath-functions sum"].evaluate(a),f=XPathCoreFunctions["http://www.w3.org/2005/xpath-functions count"].evaluate(a);return b/f}),"http://www.w3.org/2005/xpath-functions min":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.minInvalidArgumentsNumber;if(typeof a!="object")throw XPathCoreFunctionsExceptions.minInvalidArgumentType;if(a.length===0)return Number.NaN;for(var b=numberValue(xmlValue(a[0])),
f=1,g=a.length;f<g;++f){var h=numberValue(xmlValue(a[f]));if(isNaN(h))return Number.NaN;h<b&&(b=h)}return b}),"http://www.w3.org/2005/xpath-functions max":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.maxInvalidArgumentsNumber;if(typeof a!="object")throw XPathCoreFunctionsExceptions.maxInvalidArgumentType;if(a.length===0)return Number.NaN;for(var b=numberValue(xmlValue(a[0])),f=1,g=a.length;f<g;++f){var h=numberValue(xmlValue(a[f]));
if(isNaN(h))return Number.NaN;h>b&&(b=h)}return b}),"http://www.w3.org/2002/xforms count-non-empty":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.countNonEmptyInvalidArgumentsNumber;if(typeof a!="object")throw XPathCoreFunctionsExceptions.countNonEmptyInvalidArgumentType;for(var b=0,f=0,g=a.length;f<g;++f)xmlValue(a[f]).length>0&&b++;return b}),"http://www.w3.org/2002/xforms index":new XPathFunction(!0,XPathFunction.DEFAULT_NONE,
!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.indexInvalidArgumentsNumber;var f=IdManager.find(stringValue(b)).xfElement;a.addDepElement(f);return f.index}),"http://www.w3.org/2002/xforms nodeindex":new XPathFunction(!0,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.nodeIndexInvalidArgumentsNumber;var f=IdManager.find(stringValue(b)),g=f.node;a.addDepElement(f.xfElement);g&&(a.addDepNode(g),a.addDepElement(document.getElementById(Core.getMeta(g.documentElement?
g.documentElement:g.ownerDocument.documentElement,"model")).xfElement));return g?[g]:[]}),"http://www.w3.org/2002/xforms property":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.propertyInvalidArgumentsNumber;a=stringValue(a);switch(a){case "version":return"1.1";case "conformance-level":return"full"}return""}),"http://www.w3.org/2002/xforms instance":new XPathFunction(!0,XPathFunction.DEFAULT_NONE,!0,function(a,b){if(arguments.length>
2)throw XPathCoreFunctionsExceptions.instanceInvalidArgumentsNumber;var f=b?stringValue(b):"";if(f!=""){var g=document.getElementById(f);if(!g)throw{name:"instance "+f+" not found"};return[g.xfElement.doc.documentElement]}else return[a.node.ownerDocument.documentElement]}),"http://www.w3.org/2002/xforms now":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(){if(arguments.length!=0)throw XPathCoreFunctionsExceptions.nowInvalidArgumentsNumber;return I8N.format(new Date,"yyyy-MM-ddThh:mm:ssz",
!1)}),"http://www.w3.org/2002/xforms local-date":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(){if(arguments.length!=0)throw XPathCoreFunctionsExceptions.localDateInvalidArgumentsNumber;return I8N.format(new Date,"yyyy-MM-ddz",!0)}),"http://www.w3.org/2002/xforms local-dateTime":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(){if(arguments.length!=0)throw XPathCoreFunctionsExceptions.localDateTimeInvalidArgumentsNumber;return I8N.format(new Date,"yyyy-MM-ddThh:mm:ssz",
!0)}),"http://www.w3.org/2002/xforms days-from-date":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.daysFromDateInvalidArgumentsNumber;a=stringValue(a);if(!Schema.getType("xsd_:date").validate(a)&&!Schema.getType("xsd_:dateTime").validate(a))return"NaN";p=/^([12][0-9]{3})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])/;c=p.exec(a);d=new Date(Date.UTC(c[1],c[2]-1,c[3]));return Math.floor(d.getTime()/864E5+1.0E-6)}),"http://www.w3.org/2002/xforms days-to-date":new XPathFunction(!1,
XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.daysToDateInvalidArgumentsNumber;a=numberValue(a);if(isNaN(a))return"";d=new Date;d.setTime(Math.floor(a+1.0E-6)*864E5);return I8N.format(d,"yyyy-MM-dd",!1)}),"http://www.w3.org/2002/xforms seconds-from-dateTime":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.secondsFromDateTimeInvalidArgumentsNumber;a=stringValue(a);if(!Schema.getType("xsd_:dateTime").validate(a))return"NaN";
p=/^([12][0-9]{3})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])(\.[0-9]+)?(Z|[+-])?([01][0-9]|2[0-3])?:?([0-5][0-9])?/;c=p.exec(a);d=new Date(Date.UTC(c[1],c[2]-1,c[3],c[4],c[5],c[6]));c[8]&&c[8]!="Z"&&d.setUTCMinutes(d.getUTCMinutes()+(c[8]=="+"?1:-1)*(c[9]*60+c[10]));return Math.floor(d.getTime()/1E3+1.0E-6)+(c[7]?c[7]:0)}),"http://www.w3.org/2002/xforms seconds-to-dateTime":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=
1)throw XPathCoreFunctionsExceptions.secondsToDateTimeInvalidArgumentsNumber;a=numberValue(a);if(isNaN(a))return"";d=new Date;d.setTime(Math.floor(a+1.0E-6)*1E3);return I8N.format(d,"yyyy-MM-ddThh:mm:ssz",!1)}),"http://www.w3.org/2002/xforms current":new XPathFunction(!0,XPathFunction.DEFAULT_NONE,!0,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.currentInvalidArgumentsNumber;a.addDepNode(a.node);a.addDepElement(document.getElementById(Core.getMeta(a.node.documentElement?a.node.documentElement:
a.node.ownerDocument.documentElement,"model")).xfElement);return[a.current]}),"http://www.w3.org/2002/xforms is-valid":new XPathFunction(!1,XPathFunction.DEFAULT_NODESET,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.isValidInvalidArgumentsNumber;if(typeof a!="object")throw XPathCoreFunctionsExceptions.isValidInvalidArgumentType;for(var b=!0,f=0,g=a.length;b&&f<g;f++)b=b&&validate_(a[f]);return b}),"http://www.w3.org/2002/xforms is-card-number":new XPathFunction(!1,XPathFunction.DEFAULT_NODESET,
!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.isCardNumberInvalidArgumentsNumber;for(var a=stringValue(a).trim(),b=0,f=Array(a.length),g=0,h=a.length;g<h;g++)if(f[g]=a.charAt(g)-0,f[g]<0||f[g]>9)return!1;for(g=f.length-2;g>=0;g-=2)f[g]*=2,f[g]>9&&(f[g]-=9);g=0;for(h=f.length;g<h;g++)b+=f[g];return b%10==0}),"http://www.w3.org/2002/xforms digest":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b,f){if(arguments.length!=2&&arguments.length!=3)throw XPathCoreFunctionsExceptions.digestInvalidArgumentsNumber;
a=stringValue(a);b=stringValue(b);f=f?stringValue(f):"base64";switch(b){case "SHA-1":for(var g=a.length,h=g*8,i=[],j=1732584193,k=4023233417,l=2562383102,q=271733878,n=3285377520,m,r,v,x,A,C=[],u=0;u<g;u++)C[u>>2]|=(a.charCodeAt(u)&255)<<(3-u%4<<3);C[h>>5]|=128<<24-h%32;C[(h+65>>9<<4)+15]=h;for(var g=C.length,z=function(a,b){return a<<b|a>>>32-b},s=function(a,b){var f=(a&65535)+(b&65535);return((a>>>16)+(b>>>16)+(f>>>16)&65535)<<16|f&65535},u=0;u<g;u+=16){m=j;r=k;h=l;v=q;x=n;for(var t=0;t<20;t++)A=
s(s(s(s(z(m,5),r&h^~r&v),x),1518500249),i[t]=t<16?C[t+u]:z(i[t-3]^i[t-8]^i[t-14]^i[t-16],1)),x=v,v=h,h=z(r,30),r=m,m=A;for(t=20;t<40;t++)A=s(s(s(s(z(m,5),r^h^v),x),1859775393),i[t]=z(i[t-3]^i[t-8]^i[t-14]^i[t-16],1)),x=v,v=h,h=z(r,30),r=m,m=A;for(t=40;t<60;t++)A=s(s(s(s(z(m,5),r&h^r&v^h&v),x),2400959708),i[t]=z(i[t-3]^i[t-8]^i[t-14]^i[t-16],1)),x=v,v=h,h=z(r,30),r=m,m=A;for(t=60;t<80;t++)A=s(s(s(s(z(m,5),r^h^v),x),3395469782),i[t]=z(i[t-3]^i[t-8]^i[t-14]^i[t-16],1)),x=v,v=h,h=z(r,30),r=m,m=A;j=s(m,
j);k=s(r,k);l=s(h,l);q=s(v,q);n=s(x,n)}var g=function(a){var b=a>>>16;a&=65535;return(b>=4096?"":b>=256?"0":b>=16?"00":"000")+b.toString(16)+(a>=4096?"":a>=256?"0":a>=16?"00":"000")+a.toString(16)},B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=function(a){return B.charAt(a>>>24)+B.charAt(a>>>18&63)+B.charAt(a>>>12&63)+B.charAt(a>>>6&63)+B.charAt(a&63)};switch(f){case "hex":return g(j)+g(k)+g(l)+g(q)+g(n);case "base64":return u(j>>>2)+u((j&3)<<28|k>>>4)+u((k&15)<<26|l>>>6)+
u((l&63)<<24|q>>>8)+u((q&255)<<22|n>>>10)+(B.charAt((n&1023)<<2>>>6&63)+B.charAt((n&1023)<<2&63))+"="}break;case "BASE64":B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";a=a.replace(/\r\n/g,"\n");g=a.length;j="";for(u=0;u<g;u++)h=a.charCodeAt(u),j+=h<128?a.charAt(u):h>127&&h<2048?String.fromCharCode(h>>6|192,h&63|128):String.fromCharCode(h>>12|224,h>>6&63|128,h&63|128);g=j.length;k="";for(u=0;u<g;u+=3)l=j.charCodeAt(u),q=u+1<g?j.charCodeAt(u+1):0,n=u+2<g?j.charCodeAt(u+2):0,k+=
B.charAt(l>>2)+B.charAt((l&3)<<4|q>>4)+(u+1<g?B.charAt((q&15)<<2|n>>6):"=")+(u+2<g?B.charAt(n&63):"=");return k}return"unsupported"}),"http://www.w3.org/2005/xpath-functions upper-case":new XPathFunction(!1,XPathFunction.DEFAULT_NODESET,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.upperCaseInvalidArgumentsNumber;a=stringValue(a);return a.toUpperCase()}),"http://www.w3.org/2005/xpath-functions lower-case":new XPathFunction(!1,XPathFunction.DEFAULT_NODESET,!1,function(a){if(arguments.length!=
1)throw XPathCoreFunctionsExceptions.lowerCaseInvalidArgumentsNumber;a=stringValue(a);return a.toLowerCase()}),"http://www.w3.org/2005/xpath-functions distinct-values":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.distinctValuesInvalidArgumentsNumber;for(var b=[],f={},g=0,h=a.length;g<h;++g){var i=xmlValue(a[g]);f[i]||(b.push(a[g]),f[i]=!0)}return b}),"http://www.w3.org/2002/xforms transform":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,
!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.transformInvalidArgumentsNumber;b=stringValue(b);return Core.transformText(Core.saveXML(a[0]),b,!1)}),"http://www.w3.org/2002/xforms serialize":new XPathFunction(!1,XPathFunction.DEFAULT_NODE,!1,function(a){if(arguments.length>1)throw XPathCoreFunctionsExceptions.serializeInvalidArgumentsNumber;if(arguments.length==1&&typeof a!="object")throw XPathCoreFunctionsExceptions.serializeInvalidArgumentType;if(arguments.length==0)throw XPathCoreFunctionsExceptions.serializeNoContext;
return Core.saveXML(a[0])}),"http://www.w3.org/2002/xforms event":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.eventInvalidArgumentsNumber;var b=XMLEvents.EventContexts[XMLEvents.EventContexts.length-1];return b?b[a]:null}),"http://www.w3.org/2005/xpath-functions is-non-empty-array":new XPathFunction(!1,XPathFunction.DEFAULT_NODESET,!1,function(a){if(arguments.length>1)throw XPathCoreFunctionsExceptions.isNonEmptyArrayInvalidArgumentsNumber;
if(typeof a[0]!="object")throw XPathCoreFunctionsExceptions.isNonEmptyArrayInvalidArgumentType;return a[0].getAttribute("exsi:maxOccurs")&&a[0].getAttribute("xsi:nil")!="true"}),"http://exslt.org/math abs":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;return Math.abs(numberValue(a))}),"http://exslt.org/math acos":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=
1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;return Math.acos(numberValue(a))}),"http://exslt.org/math asin":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;return Math.asin(numberValue(a))}),"http://exslt.org/math atan":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;return Math.atan(numberValue(a))}),
"http://exslt.org/math atan2":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.math2InvalidArgumentsNumber;return Math.atan2(numberValue(a),numberValue(b))}),"http://exslt.org/math constant":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.math2InvalidArgumentsNumber;var f=MathConstants[stringValue(a)]||"0";return parseFloat(f.substr(0,numberValue(b)+
2))}),"http://exslt.org/math cos":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;return Math.cos(numberValue(a))}),"http://exslt.org/math exp":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;return Math.exp(numberValue(a))}),"http://exslt.org/math log":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,
!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;return Math.log(numberValue(a))}),"http://exslt.org/math power":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=2)throw XPathCoreFunctionsExceptions.math2InvalidArgumentsNumber;return Math.pow(numberValue(a),numberValue(b))}),"http://exslt.org/math sin":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;
return Math.sin(numberValue(a))}),"http://exslt.org/math sqrt":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;return Math.sqrt(numberValue(a))}),"http://exslt.org/math tan":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.math1InvalidArgumentsNumber;return Math.tan(numberValue(a))}),"http://www.w3.org/2005/xpath-functions alert":new XPathFunction(!1,
XPathFunction.DEFAULT_NONE,!1,function(a){if(arguments.length!=1)throw XPathCoreFunctionsExceptions.alertInvalidArgumentsNumber;alert(stringValue(a));return a}),"http://www.w3.org/2005/xpath-functions string-join":new XPathFunction(!1,XPathFunction.DEFAULT_NONE,!1,function(a,b){if(arguments.length!=1&&arguments.length!=2)throw XPathCoreFunctionsExceptions.stringJoinInvalidArgumentsNumber;if(typeof a!="object")throw XPathCoreFunctionsExceptions.stringJoinInvalidArgumentType;for(var f=[],b=b||"",g=
0,h=a.length;g<h;g++)f.push(xmlValue(a[g]));return f.join(b)})};
XPathCoreFunctionsExceptions={lastInvalidArgumentsNumber:{name:"last() : Invalid number of arguments",message:"last() function has no argument"},positionInvalidArgumentsNumber:{name:"position() : Invalid number of arguments",message:"position() function has no argument"},countInvalidArgumentsNumber:{name:"count() : Invalid number of arguments",message:"count() function must have one argument exactly"},countInvalidArgumentType:{name:"count() : Invalid type of argument",message:"count() function must have a nodeset argument"},
idInvalidArgumentsNumber:{name:"id() : Invalid number of arguments",message:"id() function must have one argument exactly"},idInvalidArgumentType:{name:"id() : Invalid type of argument",message:"id() function must have a nodeset or string argument"},localNameInvalidArgumentsNumber:{name:"local-name() : Invalid number of arguments",message:"local-name() function must have one argument at most"},localNameInvalidArgumentType:{name:"local-name() : Invalid type of argument",message:"local-name() function must have a nodeset argument"},
localNameNoContext:{name:"local-name() : no context node",message:"local-name() function must have a nodeset argument"},namespaceUriInvalidArgumentsNumber:{name:"namespace-uri() : Invalid number of arguments",message:"namespace-uri() function must have one argument at most"},namespaceUriInvalidArgumentType:{name:"namespace-uri() : Invalid type of argument",message:"namespace-uri() function must have a nodeset argument"},nameInvalidArgumentsNumber:{name:"name() : Invalid number of arguments",message:"name() function must have one argument at most"},
nameInvalidArgumentType:{name:"name() : Invalid type of argument",message:"name() function must have a nodeset argument"},stringInvalidArgumentsNumber:{name:"string() : Invalid number of arguments",message:"string() function must have one argument at most"},concatInvalidArgumentsNumber:{name:"concat() : Invalid number of arguments",message:"concat() function must have at least two arguments"},startsWithInvalidArgumentsNumber:{name:"starts-with() : Invalid number of arguments",message:"starts-with() function must have two arguments exactly"},
containsInvalidArgumentsNumber:{name:"contains() : Invalid number of arguments",message:"contains() function must have two arguments exactly"},substringBeforeInvalidArgumentsNumber:{name:"substring-before() : Invalid number of arguments",message:"substring-before() function must have two arguments exactly"},substringAfterInvalidArgumentsNumber:{name:"substring-after() : Invalid number of arguments",message:"substring-after() function must have two arguments exactly"},substringInvalidArgumentsNumber:{name:"substring() : Invalid number of arguments",
message:"substring() function must have two or three arguments"},compareInvalidArgumentsNumber:{name:"compare() : Invalid number of arguments",message:"compare() function must have two arguments exactly"},stringLengthInvalidArgumentsNumber:{name:"string-length() : Invalid number of arguments",message:"string-length() function must have one argument at most"},normalizeSpaceInvalidArgumentsNumber:{name:"normalize-space() : Invalid number of arguments",message:"normalize-space() function must have one argument at most"},
translateInvalidArgumentsNumber:{name:"translate() : Invalid number of arguments",message:"translate() function must have three argument exactly"},booleanInvalidArgumentsNumber:{name:"boolean() : Invalid number of arguments",message:"boolean() function must have one argument exactly"},notInvalidArgumentsNumber:{name:"not() : Invalid number of arguments",message:"not() function must have one argument exactly"},trueInvalidArgumentsNumber:{name:"true() : Invalid number of arguments",message:"true() function must have no argument"},
falseInvalidArgumentsNumber:{name:"false() : Invalid number of arguments",message:"false() function must have no argument"},langInvalidArgumentsNumber:{name:"lang() : Invalid number of arguments",message:"lang() function must have one argument exactly"},numberInvalidArgumentsNumber:{name:"number() : Invalid number of arguments",message:"number() function must have one argument exactly"},sumInvalidArgumentsNumber:{name:"sum() : Invalid number of arguments",message:"sum() function must have one argument exactly"},
sumInvalidArgumentType:{name:"sum() : Invalid type of argument",message:"sum() function must have a nodeset argument"},floorInvalidArgumentsNumber:{name:"floor() : Invalid number of arguments",message:"floor() function must have one argument exactly"},ceilingInvalidArgumentsNumber:{name:"ceiling() : Invalid number of arguments",message:"ceiling() function must have one argument exactly"},roundInvalidArgumentsNumber:{name:"round() : Invalid number of arguments",message:"round() function must have one argument exactly"},
powerInvalidArgumentsNumber:{name:"power() : Invalid number of arguments",message:"power() function must have one argument exactly"},randomInvalidArgumentsNumber:{name:"random() : Invalid number of arguments",message:"random() function must have no argument"},booleanFromStringInvalidArgumentsNumber:{name:"boolean-from-string() : Invalid number of arguments",message:"boolean-from-string() function must have one argument exactly"},ifInvalidArgumentsNumber:{name:"if() : Invalid number of arguments",
message:"if() function must have three argument exactly"},chooseInvalidArgumentsNumber:{name:"choose() : Invalid number of arguments",message:"choose() function must have three argument exactly"},avgInvalidArgumentsNumber:{name:"avg() : Invalid number of arguments",message:"avg() function must have one argument exactly"},avgInvalidArgumentType:{name:"avg() : Invalid type of argument",message:"avg() function must have a nodeset argument"},minInvalidArgumentsNumber:{name:"min() : Invalid number of arguments",
message:"min() function must have one argument exactly"},minInvalidArgumentType:{name:"min() : Invalid type of argument",message:"min() function must have a nodeset argument"},maxInvalidArgumentsNumber:{name:"max() : Invalid number of arguments",message:"max() function must have one argument exactly"},maxInvalidArgumentType:{name:"max() : Invalid type of argument",message:"max() function must have a nodeset argument"},serializeInvalidArgumentType:{name:"serialize() : Invalid type of argument",message:"serialize() function must have a nodeset argument"},
countNonEmptyInvalidArgumentsNumber:{name:"count-non-empty() : Invalid number of arguments",message:"count-non-empty() function must have one argument exactly"},countNonEmptyInvalidArgumentType:{name:"count-non-empty() : Invalid type of argument",message:"count-non-empty() function must have a nodeset argument"},indexInvalidArgumentsNumber:{name:"index() : Invalid number of arguments",message:"index() function must have one argument exactly"},nodeIndexInvalidArgumentsNumber:{name:"nodeIndex() : Invalid number of arguments",
message:"nodeIndex() function must have one argument exactly"},propertyInvalidArgumentsNumber:{name:"property() : Invalid number of arguments",message:"property() function must have one argument exactly"},propertyInvalidArgument:{name:"property() : Invalid argument",message:"Invalid property name"},instanceInvalidArgumentsNumber:{name:"instance() : Invalid number of arguments",message:"instance() function must have zero or one argument"},nowInvalidArgumentsNumber:{name:"now() : Invalid number of arguments",
message:"now() function must have no argument"},localDateInvalidArgumentsNumber:{name:"local-date() : Invalid number of arguments",message:"local-date() function must have no argument"},localDateTimeInvalidArgumentsNumber:{name:"local-dateTime() : Invalid number of arguments",message:"local-dateTime() function must have no argument"},daysFromDateInvalidArgumentsNumber:{name:"days-from-date() : Invalid number of arguments",message:"days-from-date() function must have one argument exactly"},daysToDateInvalidArgumentsNumber:{name:"days-to-date() : Invalid number of arguments",
message:"days-to-date() function must have one argument exactly"},secondsToDateTimeInvalidArgumentsNumber:{name:"seconds-to-dateTime() : Invalid number of arguments",message:"seconds-to-dateTime() function must have one argument exactly"},secondsFromDateTimeInvalidArgumentsNumber:{name:"seconds-from-dateTime() : Invalid number of arguments",message:"seconds-from-dateTime() function must have one argument exactly"},currentInvalidArgumentsNumber:{name:"current() : Invalid number of arguments",message:"current() function must have no argument"},
isValidInvalidArgumentsNumber:{name:"is-valid() : Invalid number of arguments",message:"is-valid() function must have one argument exactly"},isValidInvalidArgumentType:{name:"is-valid() : Invalid type of argument",message:"is-valid() function must have a nodeset argument"},isNonEmptyArrayArgumentsNumber:{name:"is-non-empty-array() : Invalid number of arguments",message:"is-non-empty-array() function must have zero or one argument"},isNonEmptyArrayInvalidArgumentType:{name:"is-non-empty-array() : Invalid type of argument",
message:"is-non-empty-array() function must have a node argument"},isCardNumberInvalidArgumentsNumber:{name:"is-card-number() : Invalid number of arguments",message:"is-card-number() function must have one argument exactly"},upperCaseInvalidArgumentsNumber:{name:"upper-case() : Invalid number of arguments",message:"upper-case() function must have one argument exactly"},lowerCaseInvalidArgumentsNumber:{name:"lower-case() : Invalid number of arguments",message:"lower-case() function must have one argument exactly"},
distinctValuesInvalidArgumentsNumber:{name:"distinct-values() : Invalid number of arguments",message:"distinct-values() function must have one argument exactly"},transformInvalidArgumentsNumber:{name:"transform() : Invalid number of arguments",message:"transform() function must have two arguments exactly"},serializeNoContext:{name:"serialize() : no context node",message:"serialize() function must have a node argument"},serializeInvalidArgumentsNumber:{name:"serialize() : Invalid number of arguments",
message:"serialize() function must have one argument exactly"},eventInvalidArgumentsNumber:{name:"event() : Invalid number of arguments",message:"event() function must have one argument exactly"},alertInvalidArgumentsNumber:{name:"alert() : Invalid number of arguments",message:"alert() function must have one argument exactly"},stringJoinInvalidArgumentsNumber:{name:"string-join() : Invalid number of arguments",message:"string-join() function must have one or two arguments"},stringJoinInvalidArgumentType:{name:"string-join() : Invalid type of argument",
message:"string-join() function must have a nodeset argument"}};function validate_(a){if(Core.getBoolMeta(a,"notvalid"))return!1;for(var b=a.attributes||[],f=0,g=b.length;f<g;f++)if(b[f].nodeName.substr(0,10)!="xsltforms_"&&!this.validate_(b[f]))return!1;a=a.childNodes||[];f=0;for(g=a.length;f<g;f++)if(!this.validate_(a[f]))return!1;return!0}var MAX_DUMP_DEPTH=30;
function dumpObj(a,b,f,g){if(g>MAX_DUMP_DEPTH)return f+b+": <Maximum Depth Reached>\n";if(typeof a=="object"){var h=null,b=f+b+"\n";f+="\t";for(var i in a){try{h=a[i]}catch(j){h="<Unable to Evaluate>"}b+=typeof h=="object"?dumpObj(h,i,f,g+1):f+i+": "+h+"\n"}return b}else return a}
function var_dump(a,b,f,g){var h="",i,j,k="";g||(g=1);for(j=0;j<g;j++)k+="   ";if(typeof a!="object")return i=a,typeof a=="string"&&(b=="html"&&(i=i.replace(/&/g,"&amp;"),i=i.replace(/>/g,"&gt;"),i=i.replace(/</g,"&lt;")),i=i.replace(/\"/g,'"'),i='"'+i+'"'),typeof a=="function"&&b&&(i=(new String(i)).replace(/\n/g,"\n"+k),b=="html"&&(i=i.replace(/&/g,"&amp;"),i=i.replace(/>/g,"&gt;"),i=i.replace(/</g,"&lt;"))),typeof a=="undefined"&&(i="undefined"),b=="html"&&(typeof i!="string"&&(i=new String(i)),
i=i.replace(/ /g,"&nbsp;").replace(/\n/g,"<br>")),i;for(var l in a){if(f&&g>f)i="*RECURSION*";else try{i=var_dump(a[l],b,f,g+1)}catch(q){continue}j=var_dump(l,b,f,g+1);h+=j+":"+i+",";b&&(h+="\n"+k)}h=b?"{\n"+k+h.substr(0,h.length-(2+g*3))+"\n"+k.substr(0,k.length-3)+"}":"{"+h.substr(0,h.length-1)+"}";b=="html"&&(h=h.replace(/ /g,"&nbsp;").replace(/\n/g,"<br>"));return h};