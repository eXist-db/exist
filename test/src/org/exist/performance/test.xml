<?xml version="1.0" encoding="UTF-8"?>
<test xmlns="http://exist.sourceforge.net/NS/exist">
    <configuration>
        <connection id="con" user="admin" password="" base="xmldb:exist://embedded-eXist-server"/>
        <!--<connection id="con" user="admin" password="" base="xmldb:exist://localhost:8080/exist/xmlrpc/"/>-->
        <action name="sequence" class="org.exist.performance.ActionSequence"/>
        <action name="create-collection" class="org.exist.performance.actions.CreateCollection"/>
        <action name="remove-collection" class="org.exist.performance.actions.RemoveCollection"/>
        <action name="store-files" class="org.exist.performance.actions.StoreFromFile"/>
        <action name="store" class="org.exist.performance.actions.StoreInline"/>
        <action name="generate" class="org.exist.performance.actions.DataGenerator"/>
        <action name="xquery" class="org.exist.performance.actions.XQuery"/>
    </configuration>
    <group name="simple">
        <setup connection="con">
            <create-collection parent="/db" name="test"/>
            <create-collection parent="/db/test" name="shakespeare"/>
            <store-files dir="samples/shakespeare" includes="hamlet.xml" collection="/db/test/shakespeare"/>
            <create-collection parent="/db/system/config" name="db"/>
            <store collection="/db/system/config/db" name="collection.xconf">
                <collection xmlns="http://exist-db.org/collection-config/1.0">
                    <index>
                        <fulltext default="all" attributes="false">
                        </fulltext>
                        
                        <create path="//book/@id" type="xs:string"/>
                        <create path="//book/@n" type="xs:integer"/>
                        <create path="//section/@id" type="xs:string"/>
                    </index>
                </collection>
            </store>
            <generate count="1000" todir="test/benchmark/temp" prefix="book">
                <book xmlns="" id="{$filename}" n="{$count}">
                    <chapter>
                        <title>{pt:random-text(7)}</title>
                        
                        {
                        for $section in 1 to 8 return
                        <section id="sect{$section}">
                            <title>{pt:random-text(7)}</title>
                            {
                            for $para in 1 to 10 return
                            <para>{pt:random-text(40)}</para>
                            }
                        </section>
                        }
                    </chapter>
                </book>
            </generate>
        </setup>
        <thread name="thread1" connection="con">
            <store-files dir="test/benchmark/temp" includes="**/*.xml" collection="/db/test"/>
            <sequence repeat="20" description="query resources">
                <xquery collection="/db" query="//book[@id = 'book100.xml']"/>
                <xquery collection="/db" query="//book[@id &lt; 'book100.xml']"/>
                <xquery collection="/db" query="//book[@id &gt; 'book100.xml']"/>
                <xquery collection="/db" query="//book[@n = 100]"/>
                <xquery collection="/db" query="//book[@n &lt; 100]"/>
                <xquery collection="/db" query="//book[@n &gt; 100]"/>
                <xquery collection="/db" query="//chapter[title &amp;= 'k*']"/>
                <xquery collection="/db" query="//chapter[para &amp;= 'is']"/>
            </sequence>
        </thread>
        <tear-down connection="con">
            <remove-collection parent="/db" collection="test" description="remove /db/test"/>
        </tear-down>
    </group>
    <group name="ft-tests">
        <setup connection="con">
            <create-collection parent="/db/system/config" name="db"/>
            <store collection="/db/system/config/db" name="collection.xconf">
                <collection xmlns="http://exist-db.org/collection-config/1.0">
                    <index>
                        <fulltext default="all" attributes="false">
                            <create qname="p"/>
                            <create qname="head"/>
                        </fulltext>
                    </index>
                </collection>
            </store>
        </setup>
        <thread name="thread2" connection="con">
            <create-collection parent="/db" name="jgoethe"/>
            <store-files dir="test/benchmark/data/jgoethe" includes="*.xml" collection="/db/jgoethe"
            description="storing Goethe data"/>
            <sequence repeat="10">
                <xquery collection="/db/jgoethe" query="//(p|l|head|cell)[. &amp;= 'liebe']"/>
                <xquery collection="/db/jgoethe" query="//(p|l|head|cell)[. &amp;= 'liebe sinnlichkeit']"/>
                <xquery collection="/db/jgoethe" query="//(p|l|head|cell)[. &amp;= 'sinnlich*']"/>
                <xquery collection="/db/jgoethe" query="//(p|l|head|cell)[. &amp;= 'liebe sinnlich*']"/>
                <xquery collection="/db/jgoethe" query="//(p|l|head|cell)[. &amp;= 'schmerz* herz']"/>
                <xquery collection="/db/jgoethe" query="//(p|l|head|cell)[. &amp;= 'himmel hölle']"/>
                <xquery collection="/db/jgoethe" query="//(p|l|head|cell)[. |= 'liebe sinnlich*']"/>
                <xquery collection="/db/jgoethe" query="//(p|l|head|cell)[. |= 'himmel hölle']"/>
                <xquery collection="/db/jgoethe" query="//(p|l|head|cell)[match-all(., 'himme?l.*')]"/>
                
                <xquery collection="/db/jgoethe" query="/TEI.2//p[. &amp;= 'liebe']"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//((#exist:optimize#) { p[. &amp;= 'liebe'] })"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//p[. &amp;= 'liebe sinnlichkeit']"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//((#exist:optimize#) { p[. &amp;= 'liebe sinnlichkeit'] })"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//p[. &amp;= 'liebe sinnlich*']"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//((#exist:optimize#) { p[. &amp;= 'liebe sinnlich*'] })"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//p[. &amp;= 'schmerz* herz']"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//((#exist:optimize#) { p[. &amp;= 'schmerz* herz'] })"/>
                
                <xquery collection="/db/jgoethe" query="//div3[head &amp;= 'götz von berlichingen']"/>
                <xquery collection="/db/jgoethe" query="//*[head &amp;= 'götz von berlichingen']"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//div3[head &amp;= 'götz von berlichingen']"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//*[head &amp;= 'götz von berlichingen']"/>
                <xquery collection="/db/jgoethe" query="//div3[head &amp;= 'faust']//p[. &amp;= 'todt']"/>
                <xquery collection="/db/jgoethe" query="//*[head &amp;= 'faust']//p[. &amp;= 'todt']"/>
                <xquery collection="/db/jgoethe" query="//div3[head &amp;= 'faust']//p[. &amp;= 'todt']"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//div3[head &amp;= 'faust']//p[. &amp;= 'todt']"/>
                <xquery collection="/db/jgoethe" query="/TEI.2//*[head &amp;= 'faust']//p[. &amp;= 'todt']"/>
                <xquery collection="/db/jgoethe" query="//(div1|div2|div3|div4|div5)[head &amp;= 'faust']//p[. &amp;= 'todt']"/>
                <xquery collection="/db/jgoethe" query="//(div1|div2|div3|div4|div5)[head &amp;= 'faust']//p[. &amp;= 'tod*']"/>
            </sequence>
        </thread>
        <tear-down connection="con">
            <!--remove-collection parent="/db" collection="jgoethe" description="remove /db/jgoethe"/-->
        </tear-down>
    </group>
</test>